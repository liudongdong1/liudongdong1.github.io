# 存储阵列技术


> 存储阵列硬件系统又两部分组成：
>
> - 控制框：控制框用于处理各种存储业务，并管理[级联](https://so.csdn.net/so/search?q=级联&spm=1001.2101.3001.7020)在控制框下面的硬盘框。
> - 硬盘框：硬盘框主要用于容纳各种硬盘，为应用服务器提供充足的存储空间。硬盘框组成部件：系统插框、电源模块、风扇模块、级联模块、硬盘模块。

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409153259298.png)

- 高可靠性：器件冗余（对控）、硬盘坏道检测 / 修复、磁盘健康分析、多路径技术、BBU 掉电保护、RAID 重构、缓存镜像技术、磁盘保险箱技术、磁盘与拷贝技术、块照 / 克隆技术、LUN 拷贝、远程复制等。
- 可扩展性：Sacle-out、iSCSI、FC 技术、SAS 技术、PCI-e、FcOE.
- 高性能：块虚拟化技术、cache 回写、cache 预取技术、12GbSAS、16Gb FC。
- 高可用性：SmartTier 技术、SmartQoS 技术、Smart Thin 技术。

### 1. 多控技术

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409153549135.png)

### 2. 磁盘坏道检测技术

- **读写失败自动分析：**

1. 根据失败有多重原因。
2. 根据系统当前状态、硬盘状态、IO 失败信息等进行综合分析。

- **硬盘截止自动扫描：**

1. 直接使用硬盘的内建介质扫描功能
2. 避免了硬盘扫描后多后端带宽的占用
3. 将对系统性能的影响降到最低

### 3. 磁盘健康分析 DHA

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409153938309.png)

### 4. 多路径技术

#### .1. 镜像技术

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409154259060.png)

**读策略：**

- 智能预取：对主机读请求进行`连续性判断`。如果是连续的请求，则将当前读请求后面的一段数据从硬盘预取到 Cache 中，提高读 Cache 命中率。如果是随机读，则不预取，只从硬盘读取需要的部分。

- 固定预取：Cache 读取硬盘数据时，每次从硬盘中读取固定的长度（用户配置）。
- 可变预取：按照主机 I/O 请求中读取长度的倍数将数据预取到 Cache 中。

**写策略：**

- 透写：应用下发写数据请求时，既将数据写入 Cache，同时也将数据写入硬盘。
- 回写 / 镜像：应用下发写数据请求时，将数据写入本地 Cache，同时也将数据写入对端 Cache。
- 强制回写 / 镜像：当存储系统发生故障（例如高温故障或 BBU 供电不足）时，强制将数据写入本地 Cache，同时也将数据写到对端 Cache。
- 强制回写 / 不镜像：当存储系统发生故障（例如高温故障或 BBU 供电不足）时，强制将数据写入本地 Cache。

#### .2. 数据保险箱技术

- 用于保存 Cache 数据，避免`因系统意外断电时数据丢失`。`内置 BBU 电池可保证在系统意外断电时，对 Cache 和系统保险箱硬盘同时供电，让 Cache 中的数据写到数据保险箱中，实现 Cache 数据永久保存`。

#### .3. 磁盘预拷贝技术

1. 正常状态时，实时监控硬盘状态。
2. 当某个硬盘出现故障时：将该硬盘上的迁移数据到热备盘。
3. 迁移完成后，用新盘替换掉故障盘，数据会 Copy back 到新更换的硬盘上。

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409202035310.png)

#### .4. 快照技术

- 快照为一个数据对象产生完全可用的副本，它包含该数据对象在某一时间点的映像。
- 数据对象：对存储阵列来说就是可映射给主机的 LUN。

- 完全可用：可以正常读写。
- 时间点：数据具有一致性。

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409203311626.png)

#### .5. LUN 拷贝技术

- 定义：一种基于块的将源 LUN 的数据复制到目标 LUN 的技术。
- 应用：通过 LUN 拷贝，实现`分级存储、系统升级、异地备份`等应用需求。

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409202334742.png)

### 5. 高可用性存储技术

#### .1. SmartTier 技术

- 动态分级存储技术（SmartTier）：`自动将不同活跃度的数据和不同特点的存储介质动态匹配`，提高存储系统性能并降低用户成本。

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409202455786.png)

#### .2. SmartQoS 技术

- 是一种性能特性，通过`动态地分配存储系统的资源来满足某些应用程序的特定性能目标`。

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409202601159.png)

#### .3. Smart Thin

- 能够实现`按需分配存储空间`。在存储空间配额范围内，应用服务器用到多少空间，存储系统才给它分配多少空间，从而节省了宝贵的存储资源。
- 改进一：采用 SmartThin 技术的 LUN 空间在`创建时不真正分配具体空间，而在需要真正使用空间时，再分配具体空间。`
- 改进二：有了改进一的基础后，采用 SmartThin 技术的 LUN 空间可以在创建后动态调整大小。

![](https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220409202830898.png)

---

> 作者: liudongdong1  
> URL: https://liudongdong1.github.io/%E5%AD%98%E5%82%A8%E9%98%B5%E5%88%97%E6%8A%80%E6%9C%AF/  

