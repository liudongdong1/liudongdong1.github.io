<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>Crawl_record - DAY By DAY</title><meta name="author" content="LiuDongdong">
<meta name="author-link" content="https://liudongdong1.github.io/">
<meta name="description" content="1. HTMLParse 1.1. XML 方式 lxml是python的一个解析库，支持HTML和XML的解析，支持XPath解析方式，而且解析效率非常高 XPath，全称XML" /><meta name="keywords" content='Data' /><meta itemprop="name" content="Crawl_record">
<meta itemprop="description" content="1. HTMLParse 1.1. XML 方式 lxml是python的一个解析库，支持HTML和XML的解析，支持XPath解析方式，而且解析效率非常高 XPath，全称XML"><meta itemprop="datePublished" content="2020-11-29T21:59:57+00:00" />
<meta itemprop="dateModified" content="2023-09-29T00:26:49+08:00" />
<meta itemprop="wordCount" content="9683"><meta itemprop="image" content="https://liudongdong1.github.io/logo.png"/>
<meta itemprop="keywords" content="Data," /><meta property="og:title" content="Crawl_record" />
<meta property="og:description" content="1. HTMLParse 1.1. XML 方式 lxml是python的一个解析库，支持HTML和XML的解析，支持XPath解析方式，而且解析效率非常高 XPath，全称XML" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://liudongdong1.github.io/crawl_record/" /><meta property="og:image" content="https://liudongdong1.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-29T21:59:57+00:00" />
<meta property="article:modified_time" content="2023-09-29T00:26:49+08:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://liudongdong1.github.io/logo.png"/>

<meta name="twitter:title" content="Crawl_record"/>
<meta name="twitter:description" content="1. HTMLParse 1.1. XML 方式 lxml是python的一个解析库，支持HTML和XML的解析，支持XPath解析方式，而且解析效率非常高 XPath，全称XML"/>
<meta name="application-name" content="DAY By DAY">
<meta name="apple-mobile-web-app-title" content="DAY By DAY"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://liudongdong1.github.io/crawl_record/" /><link rel="prev" href="https://liudongdong1.github.io/objectdetection/" /><link rel="next" href="https://liudongdong1.github.io/typescript/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "Crawl_record",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/liudongdong1.github.io\/crawl_record\/"
    },"genre": "posts","keywords": "Data","wordcount":  9683 ,
    "url": "https:\/\/liudongdong1.github.io\/crawl_record\/","datePublished": "2020-11-29T21:59:57+00:00","dateModified": "2023-09-29T00:26:49+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
      "@type": "Organization",
      "name": "LiuDongdong","logo": "https:\/\/liudongdong1.github.io\/images\/person.png"},"author": {
        "@type": "Person",
        "name": "liudongdong1"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="auto" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper" data-github-corner="right">
    <div class="header-title">
      <a href="/" title="DAY By DAY"><img
    class="lazyload logo"
    src="/svg/loading.min.svg"
    data-src="/fixit.min.svg"
    data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x"
    data-sizes="auto"
    alt="DAY By DAY"
    title="DAY By DAY"/><span class="header-title-text"></span></a><span id="typeit-header-subtitle-desktop" class="typeit header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 所有文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/friends/"
                title="友情链接"
                
              ><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item language">
            <span role="button" aria-label="选择语言" title="选择语言">简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i>
            </span>
            <ul class="sub-menu"><li class="menu-item">没有更多翻译</li></ul>
          </li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容 ..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li>
      </ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="DAY By DAY"><img
    class="lazyload logo"
    src="/svg/loading.min.svg"
    data-src="/fixit.min.svg"
    data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x"
    data-sizes="auto"
    alt="/fixit.min.svg"
    title="/fixit.min.svg"/><span class="header-title-text"></span></a><span id="typeit-header-subtitle-mobile" class="typeit header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容 ..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 所有文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/friends/"
                  title="友情链接"
                  
                ><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li
              class="menu-item text-center"
            ><a
                  class="menu-link"
                  href="/"
                  title="GitHub"
                  
                ><i class='fa-brands fa-github fa-fw' aria-hidden='true'></i> </a></li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li><li class="menu-item language">
            <span role="button" aria-label="选择语言" title="选择语言">简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i>
            </span>
            <select class="language-select" onchange="location = this.value;"><option disabled>没有更多翻译</option></select>
          </li></ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container" data-page-style="normal"><aside class="toc" id="toc-auto"><h2 class="toc-title">目录 <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom" id="aside-sakana">
    

<div class="sakana-widget">
  <div class="sakana-item" id="takina-widget"></div>
  <div class="sakana-item" id="chisato-widget"></div>
</div>
<script>
  function initSakanaWidget() {
    const takina = SakanaWidget.getCharacter('takina')
    SakanaWidget.registerCharacter('takina-slow', takina);
    new SakanaWidget({
      character: 'takina-slow',
      controls: false,
      autoFit: true,
      stroke: {
        color: "#b4b4b4",
        width: 2
      }
    }).mount('#takina-widget');

    const chisato = SakanaWidget.getCharacter('chisato')
    SakanaWidget.registerCharacter('chisato-slow', chisato);
    new SakanaWidget({
      character: 'chisato-slow',
      controls: false,
      autoFit: true,
      stroke: {
        color: "#b4b4b4",
        width: 2
      }
    }).mount('#chisato-widget');
  }
</script>
<script async onload="initSakanaWidget()" src="https://cdn.jsdelivr.net/npm/sakana-widget@2.3.0/lib/sakana.min.js">
</script></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX">
        <span>Crawl_record</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      liudongdong1</span></span>
          <span class="post-category">收录于 <a href="/categories/"><i class="fa-regular fa-folder fa-fw"></i>&nbsp;Categories</a>&ensp;<a href="/categories/ai/"><i class="fa-regular fa-folder fa-fw"></i>&nbsp;AI</a></span></div>
      <div class="post-meta-line"><span title=2020-11-29&#32;21:59:57>
            <i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-11-29" >2020-11-29</time>
          </span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;约 9683 字&nbsp;
        <i class="fa-regular fa-clock fa-fw"></i>&nbsp;预计阅读 20 分钟&nbsp;<span id="busuanzi_container_page_pv" class="busuanzi_visitors comment-visitors" data-flag-title="Crawl_record">
            <i class="fa-regular fa-eye fa-fw"></i>&nbsp;<span id="busuanzi_value_page_pv">-</span>&nbsp;次阅读
          </span>&nbsp;</div>
    </div><div class="featured-image"><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/2.jpeg"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/2.jpeg, https://gitee.com/github-25970295/blogImage/raw/master/img/2.jpeg 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/2.jpeg 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/2.jpeg"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/2.jpeg"/></div><div class="details toc" id="toc-static" kept="true">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-htmlparse">1. HTMLParse</a></li>
        <li><a href="#2-html-渲染模式">2. HTML 渲染模式</a></li>
        <li><a href="#3-动态网页爬取">3. 动态网页爬取</a></li>
        <li><a href="#4-反爬虫">4. 反爬虫</a></li>
        <li><a href="#5-爬虫练习">5. 爬虫练习</a></li>
        <li><a href="#6-scraw-框架">6. Scraw 框架</a></li>
        <li><a href="#7-数据可视化">7. 数据可视化</a></li>
        <li><a href="#-学习链接">. 学习链接</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div
      class="content"
      id="content"
      
      
    ><h3 id="1-htmlparse">1. HTMLParse</h3>
<h4 id="11-xml-方式">1.1. XML 方式</h4>
<blockquote>
<p>lxml是python的一个解析库，支持HTML和XML的解析，支持XPath解析方式，而且解析效率非常高 XPath，全称XML Path Language，即XML路径语言，它是一门在XML文档中查找信息的语言，它最初是用来搜寻XML文档的，但是它同样适用于HTML文档的搜索 XPath的选择功能十分强大，它提供了非常简明的路径选择表达式，另外，它还提供了超过100个内建函数，用于字符串、数值、时间的匹配以及节点、序列的处理等，几乎所有我们想要定位的节点，都可以用XPath来选择</p>
</blockquote>
<h5 id="111-匹配规则">1.1.1. 匹配规则</h5>
<table>
<thead>
<tr>
<th style="text-align:left">表达式</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">nodename</td>
<td style="text-align:left">选取此节点的所有子节点</td>
</tr>
<tr>
<td style="text-align:left">/</td>
<td style="text-align:left">从当前节点选取直接子节点</td>
</tr>
<tr>
<td style="text-align:left">//</td>
<td style="text-align:left">从当前节点选取子孙节点</td>
</tr>
<tr>
<td style="text-align:left">.</td>
<td style="text-align:left">选取当前节点</td>
</tr>
<tr>
<td style="text-align:left">..</td>
<td style="text-align:left">选取当前节点的父节点</td>
</tr>
<tr>
<td style="text-align:left">@</td>
<td style="text-align:left">选取属性，[@id=&ldquo;main&rdquo;]，[@class=&ldquo;job-list&rdquo;]</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">通配符，选择所有元素节点与元素名</td>
</tr>
<tr>
<td style="text-align:left">@*</td>
<td style="text-align:left">选取所有属性</td>
</tr>
<tr>
<td style="text-align:left">[@attrib]</td>
<td style="text-align:left">选取具有给定属性的所有元素</td>
</tr>
<tr>
<td style="text-align:left">[@attrib=&lsquo;value&rsquo;]</td>
<td style="text-align:left">选取给定属性具有给定值的所有元素</td>
</tr>
<tr>
<td style="text-align:left">[tag]</td>
<td style="text-align:left">选取所有具有指定元素的直接子节点</td>
</tr>
<tr>
<td style="text-align:left">[tag=&lsquo;text&rsquo;]</td>
<td style="text-align:left">选取所有具有指定元素并且文本内容是text节点</td>
</tr>
</tbody>
</table>
<h5 id="112-文本html-解析输出">1.1.2. 文本html 解析输出</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#可以通过浏览器复制xml路径或取</span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>parse(<span style="color:#e6db74">&#39;test.html&#39;</span>,etree<span style="color:#f92672">.</span>HTMLParser()) <span style="color:#75715e">#指定解析器HTMLParser会根据文件修复HTML文件中缺失的如声明信息</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#-----  或者</span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(text) <span style="color:#75715e">#初始化生成一个XPath解析对象</span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>tostring(html,encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;utf-8&#39;</span>)   <span style="color:#75715e">#解析对象输出代码</span>
</span></span><span style="display:flex;"><span>print(type(html))
</span></span><span style="display:flex;"><span>print(type(result))
</span></span><span style="display:flex;"><span>print(result<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -------  属性匹配</span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(text,etree<span style="color:#f92672">.</span>HTMLParser())
</span></span><span style="display:flex;"><span><span style="color:#75715e">#选取class为item-1的li节点</span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[@class=&#34;item-1&#34;]&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -------  文本获取</span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[@class=&#34;item-1&#34;]/a/text()&#39;</span>) <span style="color:#75715e">#获取a节点下的内容</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#---------  属性获取</span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li/a/@href&#39;</span>)  <span style="color:#75715e">#获取a的href属性</span>
</span></span></code></pre></div><h5 id="113-属性多值匹配">1.1.3. 属性多值匹配</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>text1<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &lt;ul&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;aaa&#34; name=&#34;item&#34;&gt;&lt;a href=&#34;link1.html&#34;&gt;第一个&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;aaa&#34; name=&#34;fore&#34;&gt;&lt;a href=&#34;link2.html&#34;&gt;second item&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     &lt;/ul&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(text1,etree<span style="color:#f92672">.</span>HTMLParser())
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[@class=&#34;aaa&#34; and @name=&#34;fore&#34;]/a/text()&#39;</span>)
</span></span><span style="display:flex;"><span>result1<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[contains(@class,&#34;aaa&#34;) and @name=&#34;fore&#34;]/a/text()&#39;</span>)
</span></span><span style="display:flex;"><span>print(result)
</span></span><span style="display:flex;"><span>print(result1)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;second item&#39;</span>]
</span></span><span style="display:flex;"><span>[<span style="color:#e6db74">&#39;second item&#39;</span>]<span style="color:#960050;background-color:#1e0010">（</span><span style="color:#ae81ff">11</span><span style="color:#960050;background-color:#1e0010">）</span>XPath中的运算符
</span></span><span style="display:flex;"><span><span style="color:#75715e">#---------示例二</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>text1<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &lt;ul&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;aaa&#34; name=&#34;item&#34;&gt;&lt;a href=&#34;link1.html&#34;&gt;第一个&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;aaa&#34; name=&#34;item&#34;&gt;&lt;a href=&#34;link1.html&#34;&gt;第二个&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;aaa&#34; name=&#34;item&#34;&gt;&lt;a href=&#34;link1.html&#34;&gt;第三个&lt;/a&gt;&lt;/li&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &lt;li class=&#34;aaa&#34; name=&#34;item&#34;&gt;&lt;a href=&#34;link1.html&#34;&gt;第四个&lt;/a&gt;&lt;/li&gt; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     &lt;/ul&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>html<span style="color:#f92672">=</span>etree<span style="color:#f92672">.</span>HTML(text1,etree<span style="color:#f92672">.</span>HTMLParser())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[contains(@class,&#34;aaa&#34;)]/a/text()&#39;</span>) <span style="color:#75715e">#获取所有li节点下a节点的内容</span>
</span></span><span style="display:flex;"><span>result1<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[1][contains(@class,&#34;aaa&#34;)]/a/text()&#39;</span>) <span style="color:#75715e">#获取第一个</span>
</span></span><span style="display:flex;"><span>result2<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[last()][contains(@class,&#34;aaa&#34;)]/a/text()&#39;</span>) <span style="color:#75715e">#获取最后一个</span>
</span></span><span style="display:flex;"><span>result3<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[position()&gt;2 and position()&lt;4][contains(@class,&#34;aaa&#34;)]/a/text()&#39;</span>) <span style="color:#75715e">#获取第一个</span>
</span></span><span style="display:flex;"><span>result4<span style="color:#f92672">=</span>html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[last()-2][contains(@class,&#34;aaa&#34;)]/a/text()&#39;</span>) <span style="color:#75715e">#获取倒数第三个</span>
</span></span></code></pre></div><h5 id="114--运算符">1.1.4.  运算符</h5>
<table>
<thead>
<tr>
<th style="text-align:left">运算符</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">实例</th>
<th style="text-align:left">返回值</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">or</td>
<td style="text-align:left">或</td>
<td style="text-align:left">age=19 or age=20</td>
<td style="text-align:left">如果age等于19或者等于20则返回true反正返回false</td>
</tr>
<tr>
<td style="text-align:left">and</td>
<td style="text-align:left">与</td>
<td style="text-align:left">age&gt;19 and age&lt;21</td>
<td style="text-align:left">如果age等于20则返回true，否则返回false</td>
</tr>
<tr>
<td style="text-align:left">mod</td>
<td style="text-align:left">取余</td>
<td style="text-align:left">5 mod 2</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">|</td>
<td style="text-align:left">取两个节点的集合</td>
<td style="text-align:left">//book | //cd</td>
<td style="text-align:left">返回所有拥有book和cd元素的节点集合</td>
</tr>
<tr>
<td style="text-align:left">+</td>
<td style="text-align:left">加</td>
<td style="text-align:left">6+4</td>
<td style="text-align:left">10</td>
</tr>
<tr>
<td style="text-align:left">-</td>
<td style="text-align:left">减</td>
<td style="text-align:left">6-4</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">乘</td>
<td style="text-align:left">6*4</td>
<td style="text-align:left">24</td>
</tr>
<tr>
<td style="text-align:left">div</td>
<td style="text-align:left">除法</td>
<td style="text-align:left">8 div 4</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">=</td>
<td style="text-align:left">等于</td>
<td style="text-align:left">age=19</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">!=</td>
<td style="text-align:left">不等于</td>
<td style="text-align:left">age!=19</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">&lt;</td>
<td style="text-align:left">小于</td>
<td style="text-align:left">age&lt;19</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">&lt;=</td>
<td style="text-align:left">小于或等于</td>
<td style="text-align:left">age&lt;=19</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">&gt;</td>
<td style="text-align:left">大于</td>
<td style="text-align:left">age&gt;19</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">&gt;=</td>
<td style="text-align:left">大于或等于</td>
<td style="text-align:left">age&gt;=19</td>
<td style="text-align:left">true</td>
</tr>
</tbody>
</table>
<h4 id="12-json-方式">1.2. Json 方式</h4>
<ul>
<li>使用工具https://www.sojson.com/ 查看json 格式，找到索引的key</li>
<li>或者直接把json 文件用vscode打开，注意后缀是.json;</li>
</ul>
<blockquote>
<p>JSON 的全称是 JavaScript Object Notation，即 JavaScript 对象符号，它是一种轻量级、跨平台、跨语言的数据交换格式，其设计意图是把所有事情都用设计的字符串来表示，这样既方便在互联网上传递信息，也方便人进行阅读。</p>
</blockquote>
<ul>
<li>
<p>json.dumps(): 对数据进行编码。</p>
</li>
<li>
<p>json.loads(): 对数据进行解码。</p>
</li>
<li>
<p><strong>编码类型转换</strong></p>
<ul>
<li><strong>JSON 解码为 Python 类型转换对应表</strong></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">JSON</th>
<th style="text-align:left">Python</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">object</td>
<td style="text-align:left">dict</td>
</tr>
<tr>
<td style="text-align:left">array</td>
<td style="text-align:left">list</td>
</tr>
<tr>
<td style="text-align:left">string</td>
<td style="text-align:left">str</td>
</tr>
<tr>
<td style="text-align:left">number (int)</td>
<td style="text-align:left">int</td>
</tr>
<tr>
<td style="text-align:left">number (real)</td>
<td style="text-align:left">float</td>
</tr>
<tr>
<td style="text-align:left">true</td>
<td style="text-align:left">True</td>
</tr>
<tr>
<td style="text-align:left">false</td>
<td style="text-align:left">False</td>
</tr>
<tr>
<td style="text-align:left">null</td>
<td style="text-align:left">None</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Python 编码为 JSON 类型转换对应表</strong>：</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">Python</th>
<th style="text-align:left">JSON</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">dict</td>
<td style="text-align:left">object</td>
</tr>
<tr>
<td style="text-align:left">list, tuple</td>
<td style="text-align:left">array</td>
</tr>
<tr>
<td style="text-align:left">str</td>
<td style="text-align:left">string</td>
</tr>
<tr>
<td style="text-align:left">int, float, int- &amp; float-derived Enums</td>
<td style="text-align:left">number</td>
</tr>
<tr>
<td style="text-align:left">True</td>
<td style="text-align:left">true</td>
</tr>
<tr>
<td style="text-align:left">False</td>
<td style="text-align:left">false</td>
</tr>
<tr>
<td style="text-align:left">None</td>
<td style="text-align:left">null</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 创建字典类型Person</span>
</span></span><span style="display:flex;"><span>person <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;知秋小梦&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;gender&#39;</span>: <span style="color:#e6db74">&#39;male&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;age&#39;</span>: <span style="color:#ae81ff">18</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Python字典类型转换为JSON对象</span>
</span></span><span style="display:flex;"><span>json_person <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(person)
</span></span><span style="display:flex;"><span>print(json_person)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 写入 JSON 数据</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;data.json&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    json<span style="color:#f92672">.</span>dump(data, f)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 读取数据</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;data.json&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>load(f)
</span></span></code></pre></div><h4 id="13-正则表达式">1.3. 正则表达式</h4>
<p><a href="https://www.runoob.com/regexp/regexp-syntax.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.runoob.com/regexp/regexp-syntax.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<ul>
<li>
<p><strong>仅匹配精确短语</strong><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132849384.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132849384.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132849384.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132849384.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132849384.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132849384.png"/></p>
</li>
<li>
<p><strong>匹配列表中的字词或短语</strong><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132950911.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132950911.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132950911.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132950911.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132950911.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029132950911.png"/></p>
</li>
<li>
<p><strong>匹配包含不同拼写或特殊字符的字词</strong><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133113269.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133113269.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133113269.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133113269.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133113269.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133113269.png"/></p>
</li>
<li>
<p><strong>匹配某个特定网域的所有电子邮件地址</strong><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133313415.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133313415.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133313415.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029133313415.png 2x"
    data-sizes="auto"
    alt="image-20201029133313415"
    title="image-20201029133313415"/></p>
</li>
</ul>
<h4 id="14-存储">1.4. 存储</h4>
<h5 id="141-pandadataframehttpspbpythoncompandas-list-dicthtml">1.4.1. <a href="https://pbpython.com/pandas-list-dict.html"target="_blank" rel="external nofollow noopener noreferrer">panda.DataFrame<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></h5>
<ul>
<li>数据存储，加载，参考https://pbpython.com/pandas-list-dict.html</li>
</ul>
<blockquote>
<p>使用pandas的DataFrame to_csv方法实现csv文件输出，但是中文乱码，已验证的正确的方法是：</p>
<p>df.to_csv(&ldquo;cnn_predict_result.csv&rdquo;,<strong>encoding=&ldquo;utf_8_sig&rdquo;</strong>)</p>
<p>关于utf-8与<strong>utf_8_sig的区别：</strong></p>
<p>UTF-8以字节为编码单元，它的字节顺序在所有系统中都是一様的，没有字节序的问题，也因此它实际上并不需要BOM(“ByteOrder Mark”)。但是UTF-8 with BOM即utf-8-sig需要提供BOM。</p>
<p>1）程序输出中出现乱码的原因是因为python2中中文编码的问题，需要注意的是要将处理的中文文件的编码和python源文件的编码保持一致，这样不会出现中文乱码。可以参考这两篇文章<a href="http://blog.csdn.net/xw_classmate/article/details/51933904"target="_blank" rel="external nofollow noopener noreferrer">关于Python脚本开头两行的：#!/usr/bin/python和# -<em>- coding: utf-8 -</em>-的作用 – 指定<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>和<a href="http://blog.csdn.net/xw_classmate/article/details/51933851"target="_blank" rel="external nofollow noopener noreferrer">Python中用encoding声明的文件编码和文件的实际编码之间的关系<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
<p>2）在程序中能够正常输出中文，但是导出到文件后使用excel打开是出现中文乱码是因为excel能够正确识别用gb2312、<strong>gbk</strong>、gb18030或<strong>utf_8 with BOM</strong> 编码的中文，如果是<strong>utf_8 no BOM</strong>编码的中文文件，excel打开会乱码。</p>
</blockquote>
<pre tabindex="0"><code>  def parse_html(self, html):
        &#39;&#39;&#39;
            html: [{jobid},{job_href},{job_name},{jobwelf},{attribute_text},{providesalary_text},{company_name},{companysize_text},{companyind_text},{company_href},{degreefrom},{companytype_text},{workarea_text},{updatedate}]
            解析一页中html文件，获得如上文件个数数据
        &#39;&#39;&#39;
        items = []   #python 列表的使用
        for one in html:
            item={}
            item[&#39;jobid&#39;]=one[&#39;jobid&#39;]
            item[&#39;job_href&#39;]=one[&#39;job_href&#39;]
            item[&#39;job_name&#39;]=one[&#39;job_name&#39;]
            item[&#39;job_welf&#39;]=one[&#39;jobwelf&#39;]
            print(item[&#39;job_href&#39;])
            # 根据job介绍url地址 获取 职位要求，工作地点，公司信息
            a,b,c=self.get_jobdetail(item[&#39;job_href&#39;])
            item[&#39;job_info&#39;]=a
            item[&#39;job_work&#39;]=b
            item[&#39;company_info&#39;]=c
            item[&#39;attribute_text&#39;]=one[&#39;attribute_text&#39;]
            item[&#39;providesalary_text&#39;]=one[&#39;providesalary_text&#39;]
            item[&#39;company_name&#39;]=one[&#39;company_name&#39;]
            item[&#39;companysize_text&#39;]=one[&#39;companysize_text&#39;]
            item[&#39;companyind_text&#39;]=one[&#39;companyind_text&#39;]
            item[&#39;company_href&#39;]=one[&#39;company_href&#39;]
            item[&#39;degreefrom&#39;]=one[&#39;degreefrom&#39;]
            item[&#39;companytype_text&#39;]=one[&#39;companytype_text&#39;]
            item[&#39;workarea_text&#39;]=one[&#39;workarea_text&#39;]
            item[&#39;updatedate&#39;]=one[&#39;updatedate&#39;]
            items.append(item)
        print(&#34;parse_one_page finished: size=&#34;,len(html),&#34;开始存储&#34;)
        df=pd.DataFrame(items)
        df.to_csv(&#34;51job_data.csv&#34;,encoding=&#34;utf_8_sig&#34;,mode = &#39;a&#39;,columns=[&#39;jobid&#39;,&#39;job_href&#39;,&#39;job_name&#39;,&#39;job_welf&#39;,&#39;job_info&#39;,&#39;job_work&#39;,&#39;company_info&#39;,
            &#39;attribute_text&#39;,&#39;providesalary_text&#39;,&#39;company_name&#39;,&#39;companysize_text&#39;,&#39;companyind_text&#39;,&#39;company_href&#39;,
            &#39;degreefrom&#39;,&#39;companytype_text&#39;,&#39;workarea_text&#39;,&#39;updatedate&#39;])
</code></pre><h3 id="2-html-渲染模式">2. HTML 渲染模式</h3>
<h4 id="21--静态网页">2.1.  静态网页</h4>
<p>静态网页是指存放在服务器文件系统中实实在在的HTML文件。当用户在浏览器中输入页面的URL，然后回车，浏览器就会将对应的html文件下载、渲染并呈现在窗口中。早期的网站通常都是由静态页面制作的。</p>
<p><strong>[特点]</strong></p>
<ul>
<li>
<p>静态网页每个网页都有一个固定的URL，且网页URL以.htm、.html、.shtml等常见形式为后缀，而不含有“?”；（动态网页中的“？”对搜索引擎检索存在一定的问题，搜索引擎一般不可能从一个网站的数据库中访问全部网页，或者出于技术方面的考虑，搜索蜘蛛不去抓取网址中“？”后面的内容。）</p>
</li>
<li>
<p>网页内容一经发布到网站服务器上，无论是否有用户访问，每个静态网页的内容都是保存在网站服务器上的，也就是说，静态网页是实实在在保存在服务器上的文件，每个网页都是一个独立的文件；</p>
</li>
<li>
<p>静态网页的内容相对稳定，因此容易被搜索引擎检索；</p>
</li>
<li>
<p>静态网页没有数据库的支持，在网站制作和维护方面工作量较大，因此当网站信息量很大时完全依靠静态网页制作方式比较困难；</p>
</li>
<li>
<p>静态网页的交互性较差，在功能方面有较大的限制。</p>
</li>
<li>
<p>页面浏览速度迅速，过程无需连接数据库，开启页面速度快于动态页面。</p>
</li>
<li>
<p>减轻了服务器的负担，工作量减少，也就降低了数据库的成本。</p>
</li>
<li>
<p>没得网络服务器或应用服务器，比如直接从CD-ROM（激光唱片-只读存储器）或USB闪存驱动器读取内容，可以通过网络浏览器直接访问。</p>
</li>
<li>
<p>网站更安全，HTML页面不会受Asp相关漏洞的影响；而且可以减少攻击，防SQL注入。数据库出错时，不影响网站正常访问。</p>
</li>
</ul>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223624298.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223624298.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223624298.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223624298.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223624298.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223624298.png"/></p>
<blockquote>
<p>所谓的动态网页，是指跟静态网页相对的一种网页编程技术。静态网页，随着html代码生成，页面的内容和显示效果就不会发生变化了。而动态网页则不然，其显示的页面则是经过Javascript处理数据后生成的结果，可以发生改变。<strong>这些数据的来源有多种，可能是经过Javascript计算生成的，也可能是通过Ajax加载的。</strong></p>
<p>动态加载网页的方式，一来是可以实现web开发的前后端分离，减少服务器直接渲染页面的压力；<strong>二来是可以作为反爬虫的一种手段。</strong></p>
</blockquote>
<h4 id="22-动态网页">2.2. 动态网页</h4>
<p>​		动态网页是相对于静态网页而言的。当浏览器请求服务器的某个页面时，服务器根据当前时间、环境参数、数据库操作等动态的生成HTML页面，然后在发送给浏览器（后面的处理就跟静态网页一样了）。很明显，动态网页中的“动态”是指服务器端页面的动态生成，相反，“静态”则指页面是实实在在的、独立的文件。</p>
<ul>
<li>HTML+JavaScript(Node.js)</li>
<li>HTML+PHP</li>
<li>HTML+ASP.NET(或ASP)</li>
<li>HTML+JSP</li>
<li>HTML+CGI(早期的动态网页技术)</li>
</ul>
<p>[<strong>动态网页</strong>]</p>
<ul>
<li>
<p>动态网页一般以数据库技术为基础，可以大大降低网站维护的工作量；</p>
</li>
<li>
<p>采用动态网页技术的网站可以实现更多的功能，如用户注册、用户登录、在线调查、用户管理、订单管理等等；</p>
</li>
<li>
<p>动态网页实际上并不是独立存在于服务器上的网页文件，只有当用户请求时服务器才返回一个完整的网页；</p>
</li>
<li>
<p>动态网页地址中的“?”对搜索引擎检索存在一定的问题，搜索引擎一般不可能从一个网站的数据库中访问全部网页，或者出于技术方面的考虑，搜索蜘蛛不去抓取网址中“?”后面的内容，因此采用动态网页的网站在进行搜索引擎推广时需要做一定的技术处理才能适应搜索引擎的要求。</p>
</li>
</ul>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223654422.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223654422.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223654422.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223654422.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223654422.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201028223654422.png"/></p>
<h4 id="23-伪静态网页">2.3. 伪静态网页</h4>
<p>实时的显示一些信息。或者还想运用动态脚本解决一些问题。不能用静态的方式来展示网站内容。但是这就损失了对搜索引擎的友好面。展示出来的是以html一类的静态页面形式，但其实是用ASP一类的动态脚本来处理的。</p>
<ul>
<li><a href="https://www.jianshu.com/p/649d2a0ebde5"target="_blank" rel="external nofollow noopener noreferrer">https://www.jianshu.com/p/649d2a0ebde5<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
</ul>
<h3 id="3-动态网页爬取">3. 动态网页爬取</h3>
<blockquote>
<p>以 <a href="http://book.sina.com.cn/excerpt/"target="_blank" rel="external nofollow noopener noreferrer">新浪读书——书摘<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> 为例，介绍如何得到无法筛选出来的Ajax请求链接:在Chrome中打开网页，右键检查，会发现首页中书摘列表包含在一个id为subShowContent1_static的div中，而查看网页源代码会发现id为subShowContent1_static的div为空。</p>
</blockquote>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092325019.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092325019.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092325019.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092325019.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092325019.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092325019.png"/></p>
<p>并且点击更多书摘或下一页时，网页URL并没有发生变化。这与我们最前面所说的两种情况相同，说明这个网页就是使用 JS 动态加载数据的。</p>
<blockquote>
<p>F12打开调试工具，打开NetWork窗口，F5刷新，可以看到浏览器发送以及接收到的数据记录(我们可以点击上面的 XHR 或者 JS 对这些请求进行过滤)：</p>
</blockquote>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092647745.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092647745.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092647745.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092647745.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092647745.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029092647745.png"/></p>
<h4 id="步骤一-根据id进行查找">步骤一. 根据id进行查找</h4>
<blockquote>
<p>js 操作页面的数据一定要进行定位，最常用的方法就是使用 id 定位，因为 id 在整个页面中是唯一的，那么我们第一步就是在所有的 js 文件中找和 subShowContent1_static 这个 id 相关的文件，于是我在 network 页面使用 ctrl+f 进行全局搜索。</p>
</blockquote>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093044283.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093044283.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093044283.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093044283.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093044283.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093044283.png"/></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093403370.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093403370.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093403370.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093403370.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093403370.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029093403370.png"/></p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029095656616.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029095656616.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029095656616.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029095656616.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029095656616.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029095656616.png"/></p>
<h4 id="步骤二断点动态捕获">步骤二：断点动态捕获</h4>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100221196.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100221196.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100221196.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100221196.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100221196.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100221196.png"/></p>
<pre tabindex="0"><code>#设置断点后 F5 刷新
#根据断点信息构造 访问url
http://feed.mix.sina.com.cn/api/roll/get?callback=xxxxxxxx&amp;pageid=96&amp;lid=560&amp;num=20&amp;page=1
</code></pre><p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100755169.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100755169.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100755169.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100755169.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100755169.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029100755169.png"/></p>
<h3 id="4-反爬虫">4. 反爬虫</h3>
<p>1、<strong>Headers反爬虫</strong> ：Cookie、Referer、User-Agent</p>
<p>解决方案: 通过F12获取headers,传给requests.get()方法</p>
<p>2、<strong>IP限制</strong> ：网站根据IP地址访问频率进行反爬,短时间内进制IP访问</p>
<p>解决方案:</p>
<p>​    1、构造自己IP代理池,每次访问随机选择代理,经常更新代理池</p>
<p>​    2、购买开放代理或私密代理IP</p>
<p>​    3、降低爬取的速度</p>
<p>3、<strong>User-Agent限制</strong> ：类似于IP限制</p>
<p>解决方案: 构造自己的User-Agent池,每次访问随机选择</p>
<p>5、<strong>对查询参数或Form表单数据认证(salt、sign)</strong></p>
<p>解决方案: 找到JS文件,分析JS处理方法,用Python按同样方式处理</p>
<p>6、<strong>对响应内容做处理</strong></p>
<p>解决方案: 打印并查看响应内容,用xpath或正则做处理</p>
<h3 id="5-爬虫练习">5. 爬虫练习</h3>
<blockquote>
<p>查看网页编码：在窗口console标签下，键入 &ldquo;document.charset&rdquo;</p>
</blockquote>
<h4 id="51--伪链接静态网页">5.1.  伪链接静态网页</h4>
<blockquote>
<p>目标: 抓取最新中华人民共和国县以上行政区划代码</p>
<p>URL: <a href="http://www.mca.gov.cn/article/sj/xzqh/2019/"target="_blank" rel="external nofollow noopener noreferrer">http://www.mca.gov.cn/article/sj/xzqh/2019/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> - 民政数据 - 行政区划代码</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pymysql
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GovementSpider</span>(object):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://www.mca.gov.cn/article/sj/xzqh/2019/&#39;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;User-Agent&#39;</span>: <span style="color:#e6db74">&#39;Mozilla/5.0&#39;</span>}
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 创建2个对象</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>db <span style="color:#f92672">=</span> pymysql<span style="color:#f92672">.</span>connect(<span style="color:#e6db74">&#39;127.0.0.1&#39;</span>, <span style="color:#e6db74">&#39;root&#39;</span>, <span style="color:#e6db74">&#39;123456&#39;</span>, <span style="color:#e6db74">&#39;govdb&#39;</span>, charset<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;utf8&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>cursor <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>db<span style="color:#f92672">.</span>cursor()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 获取假链接</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_false_link</span>(self):
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>url, headers<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>headers)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 此处隐藏了真实的二级页面的url链接，真实的在假的响应网页中，通过js脚本生成，</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 假的链接在网页中可以访问，但是爬取到的内容却不是我们想要的</span>
</span></span><span style="display:flex;"><span>        parse_html <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>HTML(html)
</span></span><span style="display:flex;"><span>        a_list <span style="color:#f92672">=</span> parse_html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//a[@class=&#34;artitlelist&#34;]&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> a_list:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># get()方法:获取某个属性的值</span>
</span></span><span style="display:flex;"><span>            title <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;title&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> title<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#39;代码&#39;</span>):
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># 获取到第1个就停止即可，第1个永远是最新的链接</span>
</span></span><span style="display:flex;"><span>                false_link <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://www.mca.gov.cn&#39;</span> <span style="color:#f92672">+</span> a<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;href&#39;</span>)
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#34;二级“假”链接的网址为&#34;</span>, false_link)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 提取真链接</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>incr_spider(false_link)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 增量爬取函数</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">incr_spider</span>(self, false_link):   <span style="color:#75715e">#false_link: http://www.mca.gov.cn/article/sj/xzqh/2019/202002/20200200024708.shtml</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>cursor<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;select url from version where url=</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span>, [false_link])
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># fetchall: ((&#39;http://xxxx.html&#39;,),)</span>
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>cursor<span style="color:#f92672">.</span>fetchall()
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># not result:代表数据库version表中无数据</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> result:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>get_true_link(false_link)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># 可选操作: 数据库version表中只保留最新1条数据</span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>cursor<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;delete from version&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># 把爬取后的url插入到version表中</span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>cursor<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#39;insert into version values(</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#39;</span>, [false_link])
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>db<span style="color:#f92672">.</span>commit()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;数据已是最新,无须爬取&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 获取真链接</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_true_link</span>(self, false_link):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 先获取假链接的响应,然后根据响应获取真链接</span>
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>false_link, headers<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>headers)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 从二级页面的响应中提取真实的链接（此处为JS动态加载跳转的地址）</span>
</span></span><span style="display:flex;"><span>        re_bds <span style="color:#f92672">=</span> <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;window.location.href=&#34;(.*?)&#34;&#39;</span>
</span></span><span style="display:flex;"><span>        pattern <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>compile(re_bds, re<span style="color:#f92672">.</span>S)
</span></span><span style="display:flex;"><span>        true_link <span style="color:#f92672">=</span> pattern<span style="color:#f92672">.</span>findall(html)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>save_data(true_link)  <span style="color:#75715e"># 提取真链接的数据</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 用xpath直接提取数据</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">save_data</span>(self, true_link):
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>true_link, headers<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>headers)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 基准xpath,提取每个信息的节点列表对象</span>
</span></span><span style="display:flex;"><span>        parse_html <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>HTML(html)
</span></span><span style="display:flex;"><span>        tr_list <span style="color:#f92672">=</span> parse_html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//tr[@height=&#34;19&#34;]&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> tr <span style="color:#f92672">in</span> tr_list:
</span></span><span style="display:flex;"><span>            code <span style="color:#f92672">=</span> tr<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./td[2]/text()&#39;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>strip()  <span style="color:#75715e"># 行政区划代码</span>
</span></span><span style="display:flex;"><span>            name <span style="color:#f92672">=</span> tr<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./td[3]/text()&#39;</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>strip()  <span style="color:#75715e"># 单位名称</span>
</span></span><span style="display:flex;"><span>            print(name, code)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 主函数</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>get_false_link()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    spider <span style="color:#f92672">=</span> GovementSpider()
</span></span><span style="display:flex;"><span>    spider<span style="color:#f92672">.</span>main()
</span></span></code></pre></div><h4 id="52-动态数据爬取">5.2. 动态数据爬取</h4>
<p><strong>特点</strong></p>
<blockquote>
<ol>
<li>右键 -&gt; 查看网页源码中没有具体数据</li>
<li>滚动鼠标滑轮或其他动作时加载</li>
</ol>
</blockquote>
<p><strong>抓取</strong></p>
<blockquote>
<ol>
<li>F12打开控制台，选择XHR异步加载数据包，找到页面动作抓取网络数据包</li>
<li>通过XHR&ndash;&gt;Header&ndash;&gt;General&ndash;&gt;Request URL，获取json文件URL地址</li>
<li>通过XHR&ndash;&gt;Header&ndash;&gt;Query String Parameters(查询参数)</li>
</ol>
</blockquote>
<h5 id="任务一-豆瓣电影数据抓取案例"><strong>任务一： 豆瓣电影数据抓取案例</strong></h5>
<p>目标</p>
<ol>
<li>地址: 豆瓣电影 - 排行榜 - 剧情
<ul>
<li><a href="https://movie.douban.com/typerank?type_name=%e5%89%a7%e6%83%85&amp;type=11&amp;interval_id=100:90&amp;action="target="_blank" rel="external nofollow noopener noreferrer">https://movie.douban.com/typerank?<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
<li><a href="https://movie.douban.com/typerank?type_name=%e5%89%a7%e6%83%85&amp;type=11&amp;interval_id=100:90&amp;action="target="_blank" rel="external nofollow noopener noreferrer">type_name=%E5%89%A7%E6%83%85&amp;type=11&amp;interval_id=100:90&amp;action=<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
</ul>
</li>
<li>目标: 爬取电影名称、电影评分</li>
</ol>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112020668.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112020668.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112020668.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112020668.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112020668.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112020668.png"/></p>
<blockquote>
<p>通过源代码找不到的情况下，可以在network那刷新，然后重新搜索。</p>
</blockquote>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029111302563.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029111302563.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029111302563.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029111302563.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029111302563.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029111302563.png"/></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> fake_useragent <span style="color:#f92672">import</span> UserAgent
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DoubanSpider</span>(object):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>base_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://movie.douban.com/j/chart/top_list?&#39;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_html</span>(self, params):
</span></span><span style="display:flex;"><span>        headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;User-Agent&#39;</span>: UserAgent()<span style="color:#f92672">.</span>random}
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>base_url, params<span style="color:#f92672">=</span>params, headers<span style="color:#f92672">=</span>headers)
</span></span><span style="display:flex;"><span>        res<span style="color:#f92672">.</span>encoding <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;utf-8&#39;</span>
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> res<span style="color:#f92672">.</span>json()  <span style="color:#75715e"># 将json格式的字符串转为python数据类型</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>parse_html(html)  <span style="color:#75715e"># 直接调用解析函数</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse_html</span>(self, html):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># html: [{电影1信息},{电影2信息},{}]</span>
</span></span><span style="display:flex;"><span>        item <span style="color:#f92672">=</span> {}   <span style="color:#75715e">#python 列表的使用</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> one <span style="color:#f92672">in</span> html:
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#f92672">=</span> one[<span style="color:#e6db74">&#39;title&#39;</span>]  <span style="color:#75715e"># 电影名</span>
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;score&#39;</span>] <span style="color:#f92672">=</span> one[<span style="color:#e6db74">&#39;score&#39;</span>]  <span style="color:#75715e"># 评分</span>
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;time&#39;</span>] <span style="color:#f92672">=</span> one[<span style="color:#e6db74">&#39;release_date&#39;</span>]  <span style="color:#75715e"># 打印测试</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># 打印显示</span>
</span></span><span style="display:flex;"><span>            print(item)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 获取电影总数</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_total</span>(self, typ):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 异步动态加载的数据 都可以在XHR数据抓包</span>
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://movie.douban.com/j/chart/top_list_count?type=</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&amp;interval_id=100%3A90&#39;</span><span style="color:#f92672">.</span>format(typ)
</span></span><span style="display:flex;"><span>        ua <span style="color:#f92672">=</span> UserAgent()
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url, headers<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;User-Agent&#39;</span>: ua<span style="color:#f92672">.</span>random})<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>        total <span style="color:#f92672">=</span> html[<span style="color:#e6db74">&#39;total&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> total
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(self):
</span></span><span style="display:flex;"><span>        typ <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#39;请输入电影类型(剧情|喜剧|动作):&#39;</span>)
</span></span><span style="display:flex;"><span>        typ_dict <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;剧情&#39;</span>: <span style="color:#e6db74">&#39;11&#39;</span>, <span style="color:#e6db74">&#39;喜剧&#39;</span>: <span style="color:#e6db74">&#39;24&#39;</span>, <span style="color:#e6db74">&#39;动作&#39;</span>: <span style="color:#e6db74">&#39;5&#39;</span>}
</span></span><span style="display:flex;"><span>        typ <span style="color:#f92672">=</span> typ_dict[typ]
</span></span><span style="display:flex;"><span>        total <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>get_total(typ)  <span style="color:#75715e"># 获取该类型电影总数量</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> page <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, int(total), <span style="color:#ae81ff">20</span>):
</span></span><span style="display:flex;"><span>            params <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;type&#39;</span>: typ,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;interval_id&#39;</span>: <span style="color:#e6db74">&#39;100:90&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;action&#39;</span>: <span style="color:#e6db74">&#39;&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;start&#39;</span>: str(page),
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;limit&#39;</span>: <span style="color:#e6db74">&#39;20&#39;</span>}
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>get_html(params)
</span></span><span style="display:flex;"><span>            time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;爬取的电影的数量:&#39;</span>, self<span style="color:#f92672">.</span>i)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    spider <span style="color:#f92672">=</span> DoubanSpider()
</span></span><span style="display:flex;"><span>    spider<span style="color:#f92672">.</span>main()
</span></span></code></pre></div><h5 id="任务二腾讯招聘数据抓取ajax"><strong>任务二：腾讯招聘数据抓取(Ajax)</strong></h5>
<p>确定URL地址及目标</p>
<ul>
<li>URL: 百度搜索腾讯招聘 - 查看工作岗位https://careers.tencent.com/search.html</li>
<li>目标: 职位名称、工作职责、岗位要求</li>
</ul>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112427977.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112427977.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112427977.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112427977.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112427977.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029112427977.png"/></p>
<blockquote>
<p>确定所要数据所在页面： url 地址可以直接在header里面进行查看</p>
<p>职位名称：https://careers.tencent.com/tencentcareer/api/post/Query?timestamp=1603941718816&amp;countryId=&amp;cityId=&amp;bgIds=&amp;productId=&amp;categoryId=&amp;parentCategoryId=&amp;attrId=&amp;keyword=&amp;pageIndex=1&amp;pageSize=10&amp;language=zh-cn&amp;area=cn</p>
<p>工作职责、岗位要求： <a href="https://careers.tencent.com/jobdesc.html?postId=1290651460547125248"target="_blank" rel="external nofollow noopener noreferrer">https://careers.tencent.com/jobdesc.html?postId=1290651460547125248<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> useragents <span style="color:#f92672">import</span> ua_list
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TencentSpider</span>(object):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>one_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://careers.tencent.com/tencentcareer/api/post/Query?timestamp=1563912271089&amp;countryId=&amp;cityId=&amp;bgIds=&amp;productId=&amp;categoryId=&amp;parentCategoryId=&amp;attrId=&amp;keyword=&amp;pageIndex=</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&amp;pageSize=10&amp;language=zh-cn&amp;area=cn&#39;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>two_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://careers.tencent.com/tencentcareer/api/post/ByPostId?timestamp=1563912374645&amp;postId=</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&amp;language=zh-cn&#39;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>f <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;tencent.json&#39;</span>, <span style="color:#e6db74">&#39;a&#39;</span>)  <span style="color:#75715e"># 打开文件</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>item_list <span style="color:#f92672">=</span> []  <span style="color:#75715e"># 存放抓取的item字典数据</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 获取响应内容函数</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_page</span>(self, url):
</span></span><span style="display:flex;"><span>        headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;User-Agent&#39;</span>: random<span style="color:#f92672">.</span>choice(ua_list)}
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url, headers<span style="color:#f92672">=</span>headers)<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(html)  <span style="color:#75715e"># json格式字符串转为Python数据类型</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> html
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 主线函数: 获取所有数据</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse_page</span>(self, one_url):
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>get_page(one_url)
</span></span><span style="display:flex;"><span>        item <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> job <span style="color:#f92672">in</span> html[<span style="color:#e6db74">&#39;Data&#39;</span>][<span style="color:#e6db74">&#39;Posts&#39;</span>]:
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#f92672">=</span> job[<span style="color:#e6db74">&#39;RecruitPostName&#39;</span>]  <span style="color:#75715e"># 名称</span>
</span></span><span style="display:flex;"><span>            post_id <span style="color:#f92672">=</span> job[<span style="color:#e6db74">&#39;PostId&#39;</span>]  <span style="color:#75715e"># postId，拿postid为了拼接二级页面地址</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># 拼接二级地址,获取职责和要求</span>
</span></span><span style="display:flex;"><span>            two_url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>two_url<span style="color:#f92672">.</span>format(post_id)
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;duty&#39;</span>], item[<span style="color:#e6db74">&#39;require&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>parse_two_page(two_url)
</span></span><span style="display:flex;"><span>            print(item)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>item_list<span style="color:#f92672">.</span>append(item)  <span style="color:#75715e"># 添加到大列表中</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 解析二级页面函数</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse_two_page</span>(self, two_url):
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>get_page(two_url)
</span></span><span style="display:flex;"><span>        duty <span style="color:#f92672">=</span> html[<span style="color:#e6db74">&#39;Data&#39;</span>][<span style="color:#e6db74">&#39;Responsibility&#39;</span>]  <span style="color:#75715e"># 工作责任</span>
</span></span><span style="display:flex;"><span>        duty <span style="color:#f92672">=</span> duty<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)  <span style="color:#75715e"># 去掉换行</span>
</span></span><span style="display:flex;"><span>        require <span style="color:#f92672">=</span> html[<span style="color:#e6db74">&#39;Data&#39;</span>][<span style="color:#e6db74">&#39;Requirement&#39;</span>]  <span style="color:#75715e"># 工作要求</span>
</span></span><span style="display:flex;"><span>        require <span style="color:#f92672">=</span> require<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)  <span style="color:#75715e"># 去掉换行</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> duty, require
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 获取总页数</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_numbers</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>one_url<span style="color:#f92672">.</span>format(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>get_page(url)
</span></span><span style="display:flex;"><span>        numbers <span style="color:#f92672">=</span> int(html[<span style="color:#e6db74">&#39;Data&#39;</span>][<span style="color:#e6db74">&#39;Count&#39;</span>]) <span style="color:#f92672">//</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>  <span style="color:#75715e"># 每页有10个推荐</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> numbers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(self):
</span></span><span style="display:flex;"><span>        number <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>get_numbers()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> page <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>            one_url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>one_url<span style="color:#f92672">.</span>format(page)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>parse_page(one_url)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 保存到本地json文件:json.dump</span>
</span></span><span style="display:flex;"><span>        json<span style="color:#f92672">.</span>dump(self<span style="color:#f92672">.</span>item_list, self<span style="color:#f92672">.</span>f, ensure_ascii<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>f<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    spider <span style="color:#f92672">=</span> TencentSpider()
</span></span><span style="display:flex;"><span>    spider<span style="color:#f92672">.</span>main()
</span></span><span style="display:flex;"><span>    end <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;执行时间:</span><span style="color:#e6db74">%.2f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (end <span style="color:#f92672">-</span> start))
</span></span></code></pre></div><h5 id="任务三51job网站爬取">任务三：51job网站爬取</h5>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029205633909.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029205633909.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029205633909.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029205633909.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029205633909.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201029205633909.png"/></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> fake_useragent <span style="color:#f92672">import</span> UserAgent
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> urllib <span style="color:#f92672">import</span> parse
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> xlwt     
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">JobSpider</span>(object):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>base_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://movie.douban.com/j/chart/top_list?&#39;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>   <span style="color:#75715e">#记录计数器</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#self.wirte_sheet=self.init_xkwt()  </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">init_xkwt</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            初始化csv文件表头
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#新建表格空间</span>
</span></span><span style="display:flex;"><span>        excel1 <span style="color:#f92672">=</span> xlwt<span style="color:#f92672">.</span>Workbook()
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#新建一个sheet,设置单元格格式,cell_overwrite_ok=True防止对一个单元格重复操作引发的错误</span>
</span></span><span style="display:flex;"><span>        sheet1 <span style="color:#f92672">=</span> excel1<span style="color:#f92672">.</span>add_sheet(<span style="color:#e6db74">&#39;Job&#39;</span>, cell_overwrite_ok<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;jobid&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;job_href&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;job_name&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;jobwelf&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>, <span style="color:#e6db74">&#39;attribute_text&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>, <span style="color:#e6db74">&#39;providesalary_text&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#e6db74">&#39;company_name&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">7</span>, <span style="color:#e6db74">&#39;companysize_text&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>, <span style="color:#e6db74">&#39;companyind_text&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>, <span style="color:#e6db74">&#39;company_href&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>,<span style="color:#e6db74">&#39;degreefrom&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">11</span>,<span style="color:#e6db74">&#39;companytype_text&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">12</span>,<span style="color:#e6db74">&#39;workarea_text&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">13</span>,<span style="color:#e6db74">&#39;companytype_text&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>,<span style="color:#e6db74">&#39;updatedate&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">15</span>,<span style="color:#e6db74">&#39;job_info&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">16</span>,<span style="color:#e6db74">&#39;job_work&#39;</span>)
</span></span><span style="display:flex;"><span>        sheet1<span style="color:#f92672">.</span>write(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">17</span>,<span style="color:#e6db74">&#39;company_info&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sheet1
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#sheet1.write(number,0,number)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse_html</span>(self, html):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            html: [</span><span style="color:#e6db74">{jobid}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{job_href}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{job_name}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{jobwelf}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{attribute_text}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{providesalary_text}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{company_name}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{companysize_text}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{companyind_text}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{company_href}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{degreefrom}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{companytype_text}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{workarea_text}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{updatedate}</span><span style="color:#e6db74">]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            解析一页中html文件，获得如上文件个数数据
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>        items <span style="color:#f92672">=</span> []   <span style="color:#75715e">#python 列表的使用</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> one <span style="color:#f92672">in</span> html:
</span></span><span style="display:flex;"><span>            item<span style="color:#f92672">=</span>{}
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;jobid&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;jobid&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;job_href&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;job_href&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;job_name&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;job_name&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;job_welf&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;jobwelf&#39;</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">#print(item[&#39;job_href&#39;])</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># 根据job介绍url地址 获取 职位要求，工作地点，公司信息</span>
</span></span><span style="display:flex;"><span>            a,b,c<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>get_jobdetail(item[<span style="color:#e6db74">&#39;job_href&#39;</span>])
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;job_info&#39;</span>]<span style="color:#f92672">=</span>a
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;job_work&#39;</span>]<span style="color:#f92672">=</span>b
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;company_info&#39;</span>]<span style="color:#f92672">=</span>c
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;attribute_text&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;attribute_text&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;providesalary_text&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;providesalary_text&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;company_name&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;company_name&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;companysize_text&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;companysize_text&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;companyind_text&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;companyind_text&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;company_href&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;company_href&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;degreefrom&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;degreefrom&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;companytype_text&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;companytype_text&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;workarea_text&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;workarea_text&#39;</span>]
</span></span><span style="display:flex;"><span>            item[<span style="color:#e6db74">&#39;updatedate&#39;</span>]<span style="color:#f92672">=</span>one[<span style="color:#e6db74">&#39;updatedate&#39;</span>]
</span></span><span style="display:flex;"><span>            items<span style="color:#f92672">.</span>append(item)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;parse_one_page finished: size=&#34;</span>,len(html),<span style="color:#e6db74">&#34;开始存储&#34;</span>)
</span></span><span style="display:flex;"><span>        df<span style="color:#f92672">=</span>pd<span style="color:#f92672">.</span>DataFrame(items)
</span></span><span style="display:flex;"><span>        df<span style="color:#f92672">.</span>to_csv(<span style="color:#e6db74">&#34;51job_data.csv&#34;</span>,encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf_8_sig&#34;</span>,mode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;a&#39;</span>,columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;jobid&#39;</span>,<span style="color:#e6db74">&#39;job_href&#39;</span>,<span style="color:#e6db74">&#39;job_name&#39;</span>,<span style="color:#e6db74">&#39;job_welf&#39;</span>,<span style="color:#e6db74">&#39;job_info&#39;</span>,<span style="color:#e6db74">&#39;job_work&#39;</span>,<span style="color:#e6db74">&#39;company_info&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;attribute_text&#39;</span>,<span style="color:#e6db74">&#39;providesalary_text&#39;</span>,<span style="color:#e6db74">&#39;company_name&#39;</span>,<span style="color:#e6db74">&#39;companysize_text&#39;</span>,<span style="color:#e6db74">&#39;companyind_text&#39;</span>,<span style="color:#e6db74">&#39;company_href&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;degreefrom&#39;</span>,<span style="color:#e6db74">&#39;companytype_text&#39;</span>,<span style="color:#e6db74">&#39;workarea_text&#39;</span>,<span style="color:#e6db74">&#39;updatedate&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_html</span>(self, key,page):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            根据key，page获取对应的html文件中对应的有效数据
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#伪装爬取头部，以防止被网站禁止</span>
</span></span><span style="display:flex;"><span>        headers<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;Host&#39;</span>:<span style="color:#e6db74">&#39;search.51job.com&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;Upgrade-Insecure-Requests&#39;</span>:<span style="color:#e6db74">&#39;1&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;User-Agent&#39;</span>:<span style="color:#e6db74">&#39;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko)</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">                Chrome/63.0.3239.132 Safari/537.36&#39;</span>}
</span></span><span style="display:flex;"><span>        headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;User-Agent&#39;</span>: UserAgent()<span style="color:#f92672">.</span>random}
</span></span><span style="display:flex;"><span>        url<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;https://search.51job.com/list/050000</span><span style="color:#e6db74">%252c</span><span style="color:#e6db74">010000,000000,0100,00,9,99,</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,2,</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.html&#39;</span><span style="color:#f92672">.</span>format(key,page)
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url, headers<span style="color:#f92672">=</span>headers)<span style="color:#f92672">.</span>content<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;gbk&#39;</span>)
</span></span><span style="display:flex;"><span>        pattern<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;window.__SEARCH_RESULT__ =(.*?)&lt;/script&gt;&#39;</span>)
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">=</span>pattern<span style="color:#f92672">.</span>findall(html)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">=</span>json<span style="color:#f92672">.</span>loads(data)[<span style="color:#e6db74">&#34;engine_search_result&#34;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;长度&#34;,len(data))</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>parse_html(data)  <span style="color:#75715e"># 直接调用解析函数</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_jobdetail</span>(self,url):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            https://jobs.51job.com/beijing-hdq/126533792.html?s=01&amp;t=0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>        headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;User-Agent&#39;</span>: UserAgent()<span style="color:#f92672">.</span>random}
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url, headers<span style="color:#f92672">=</span>headers)<span style="color:#f92672">.</span>content<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;gbk&#39;</span>)
</span></span><span style="display:flex;"><span>        parse_html <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>HTML(html)
</span></span><span style="display:flex;"><span>        job_info<span style="color:#f92672">=</span>parse_html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;/html/body/div[3]/div[2]/div[3]/div[1]/div/p/text()&#39;</span>)  <span style="color:#75715e">#/html/body/div[3]/div[2]/div[3]/div[1]/div/p[1]</span>
</span></span><span style="display:flex;"><span>        job_work<span style="color:#f92672">=</span>parse_html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;/html/body/div[3]/div[2]/div[3]/div[2]/div/p/text()&#39;</span>)
</span></span><span style="display:flex;"><span>        company_info<span style="color:#f92672">=</span>parse_html<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;/html/body/div[3]/div[2]/div[3]/div[3]/div/text()&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(job_info,job_work,company_info)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> job_info,job_work,company_info
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 获取page 总数   #&#34;total_page&#34;:&#34;195&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_total</span>(self,key,page<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        url<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;https://search.51job.com/list/000000,000000,0100,00,9,99,</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,2,</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.html&#39;</span><span style="color:#f92672">.</span>format(key,page)
</span></span><span style="display:flex;"><span>        ua <span style="color:#f92672">=</span> UserAgent()
</span></span><span style="display:flex;"><span>        html <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url<span style="color:#f92672">=</span>url, headers<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;User-Agent&#39;</span>: ua<span style="color:#f92672">.</span>random})<span style="color:#f92672">.</span>content<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;gbk&#39;</span>)
</span></span><span style="display:flex;"><span>        pattern<span style="color:#f92672">=</span>re<span style="color:#f92672">.</span>compile(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;window.__SEARCH_RESULT__ =(.*?)&lt;/script&gt;&#39;</span>)
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">=</span>pattern<span style="color:#f92672">.</span>findall(html)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">=</span>json<span style="color:#f92672">.</span>loads(data)
</span></span><span style="display:flex;"><span>        total <span style="color:#f92672">=</span>data[<span style="color:#e6db74">&#39;total_page&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#34;url:&#34;,url,&#34;该职位总页数为：&#34;,total)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> total
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#key = input(&#39;请输入职业类型(数据挖掘|喜剧|动作):&#39;)</span>
</span></span><span style="display:flex;"><span>        key<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;数据挖掘&#39;</span>,<span style="color:#e6db74">&#39;人工智能&#39;</span>,<span style="color:#e6db74">&#39;语音识别&#39;</span>,<span style="color:#e6db74">&#39;物联网&#39;</span>,<span style="color:#e6db74">&#39;嵌入式&#39;</span>,<span style="color:#e6db74">&#39;java&#39;</span>,<span style="color:#e6db74">&#39;python&#39;</span>,<span style="color:#e6db74">&#39;c++&#39;</span>,<span style="color:#e6db74">&#39;android&#39;</span>,<span style="color:#e6db74">&#39;运维&#39;</span>,<span style="color:#e6db74">&#39;销售&#39;</span>,<span style="color:#e6db74">&#39;制造&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#key=parse.quote(parse.quote(key))</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> key:
</span></span><span style="display:flex;"><span>            key<span style="color:#f92672">=</span>parse<span style="color:#f92672">.</span>quote(parse<span style="color:#f92672">.</span>quote(item))
</span></span><span style="display:flex;"><span>            total <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>get_total(key)  <span style="color:#75715e"># 获取该类型电影总数量</span>
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;当前存储记录：&#34;</span>,self<span style="color:#f92672">.</span>i,<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74"> 即将爬取关键词：&#34;</span>,item,<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74"> 该关键词个数: &#34;</span>,total)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> page <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, int(total)):
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>get_html(key,page)
</span></span><span style="display:flex;"><span>                time<span style="color:#f92672">.</span>sleep(random<span style="color:#f92672">.</span>random()<span style="color:#f92672">*</span><span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(&#39;爬取的电影的数量:&#39;, self.i)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    spider <span style="color:#f92672">=</span> JobSpider()
</span></span><span style="display:flex;"><span>    spider<span style="color:#f92672">.</span>main()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#https://search.51job.com/list/050000,000000,0100,00,9,99,%25E6%2595%25B0%25E6%258D%25AE%25E6%258C%2596%25E6%258E%2598,2,1.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare=</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#https://search.51job.com/list/010000,000000,0100,00,9,99,%25E6%2595%25B0%25E6%258D%25AE%25E6%258C%2596%25E6%258E%2598,2,1.html?lang=c&amp;postchannel=0000&amp;workyear=99&amp;cotype=99&amp;degreefrom=99&amp;jobterm=99&amp;companysize=99&amp;ord_field=0&amp;dibiaoid=0&amp;line=&amp;welfare=</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#010000-330000: 代表不同的省份，其中000000： 代表全国  ；%25E6%2595%25B0%25E6%258D%25AE%25E6%258C%2596%25E6%258E%2598 对应关键词编码； ,2: 代表页数</span>
</span></span></code></pre></div><h5 id="任务五boss直聘爬虫">任务五：boss直聘爬虫</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># common imports</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pymongo
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> retrying <span style="color:#f92672">import</span> retry
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scrapy <span style="color:#f92672">import</span> Selector 
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> lxml <span style="color:#f92672">import</span> etree
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.request
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.parse
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> xlwt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ---------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 连接到MongoDB</span>
</span></span><span style="display:flex;"><span>MONGO_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;localhost&#39;</span>
</span></span><span style="display:flex;"><span>MONGO_DB <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Graduation_project&#39;</span>
</span></span><span style="display:flex;"><span>MONGO_COLLECTION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;shanghai_discovery&#39;</span>
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> pymongo<span style="color:#f92672">.</span>MongoClient(MONGO_URL, port<span style="color:#f92672">=</span><span style="color:#ae81ff">27017</span>)
</span></span><span style="display:flex;"><span>db <span style="color:#f92672">=</span> client[MONGO_DB]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 页面获取函数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_page</span>(page, keyword):
</span></span><span style="display:flex;"><span>    header <span style="color:#f92672">=</span> {    
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;user-agent&#39;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;正在爬取第&#39;</span>, page, <span style="color:#e6db74">&#39;页&#39;</span>)
</span></span><span style="display:flex;"><span>    url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://www.zhipin.com/c101020100/?query=</span><span style="color:#e6db74">{k}</span><span style="color:#e6db74">&amp;page=</span><span style="color:#e6db74">{page}</span><span style="color:#e6db74">&amp;ka=page-</span><span style="color:#e6db74">{page}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(page<span style="color:#f92672">=</span>page, k<span style="color:#f92672">=</span>keyword)
</span></span><span style="display:flex;"><span>    response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url, headers<span style="color:#f92672">=</span>header)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> response<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#34;utf-8&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># --------------</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@retry</span>(wait_fixed<span style="color:#f92672">=</span><span style="color:#ae81ff">8000</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">job_detail</span>(link):
</span></span><span style="display:flex;"><span>    header <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;User-Agent&#39;</span>: <span style="color:#e6db74">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) &#39;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#e6db74">&#39;Chrome/69.0.3497.12 Safari/537.36 &#39;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(link, headers<span style="color:#f92672">=</span>header)
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>HTML(response<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ---检验是否出现验证码</span>
</span></span><span style="display:flex;"><span>    tips <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;/html/head/title/text()&#39;</span>)
</span></span><span style="display:flex;"><span>    tips_title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;BOSS直聘验证码&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> tips[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> tips_title:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;检查是否弹出验证码&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 弹出验证码则引发IOError来进行循环</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">IOError</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># ----------------------</span>
</span></span><span style="display:flex;"><span>    job_desc <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//*[@id=&#34;main&#34;]/div[3]/div/div[2]/div[3]/div[@class=&#34;job-sec&#34;][1]/div/text()&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    jd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(job_desc)<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> jd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse_page</span>(html, keyword, page):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 观察数据结构可得</span>
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> etree<span style="color:#f92672">.</span>HTML(html)
</span></span><span style="display:flex;"><span>    items <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//*[@id=&#34;main&#34;]/div/div[2]/ul/li&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> items:
</span></span><span style="display:flex;"><span>        district <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[1]/p/text()[1]&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        job_links <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[1]/h3/a/@href&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        job_title <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[1]/h3/a/div[1]/text()&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        job_salary <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[1]/h3/a/span/text()&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        job_company <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[2]/div/h3/a/text()&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        job_experience <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[1]/p/text()[2]&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        job_degree <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[1]/p/text()[3]&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        fin_status <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[2]/div/p/text()[2]&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            company_scale <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[2]/div/p/text()[3]&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span>:
</span></span><span style="display:flex;"><span>            company_scale <span style="color:#f92672">=</span> item<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./div/div[2]/div/p/text()[2]&#39;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        job_link <span style="color:#f92672">=</span> host <span style="color:#f92672">+</span> job_links
</span></span><span style="display:flex;"><span>        print(job_link)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 获取职位描述</span>
</span></span><span style="display:flex;"><span>        detail <span style="color:#f92672">=</span> job_detail(job_link)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ---------------</span>
</span></span><span style="display:flex;"><span>        job <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Keyword&#39;</span>: keyword,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;地区&#39;</span>: district,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;职位名称&#39;</span>: job_title,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;职位薪资&#39;</span>: job_salary,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;公司名称&#39;</span>: job_company,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;工作经验&#39;</span>: job_experience,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;学历要求&#39;</span>: job_degree,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;公司规模&#39;</span>: company_scale,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;融资情况&#39;</span>: fin_status,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;职位描述&#39;</span>: detail,
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        print(job)
</span></span><span style="display:flex;"><span>        save_to_mongo(job)
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ---------------------------------------</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">save_to_mongo</span>(data):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 保存到MongoDB中</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> db[MONGO_COLLECTION]<span style="color:#f92672">.</span>insert(data):
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;存储到 MongoDB 成功&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;存储到 MongoDB 失败&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#  header 通过浏览器检查， 网络， 点击对应的name在headers 属性下面；  选择某一个属性后可以通过 鼠标右击copy 复制xpath 路径。</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#url = r&#39;https://list.jd.com/list.html?cat=670%2C671%2C2694&amp;ev=exbrand_%E5%BE%AE%E8%BD%AF%EF%BC%88Microsoft%EF%BC%89%5E1107_90246%5E244_116227%5E3753_76033%5E&amp;cid3=2694&#39;</span>
</span></span><span style="display:flex;"><span>    MAX_PAGE <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://www.zhipin.com&#39;</span>
</span></span><span style="display:flex;"><span>    keywords <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;数据分析&#39;</span>, <span style="color:#e6db74">&#39;数据挖掘&#39;</span>, <span style="color:#e6db74">&#39;商业分析&#39;</span>, <span style="color:#e6db74">&#39;机器学习&#39;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> keyword <span style="color:#f92672">in</span> keywords:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, MAX_PAGE <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            html <span style="color:#f92672">=</span> get_page(i, keyword)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># ------------ 解析数据 ---------------</span>
</span></span><span style="display:flex;"><span>            parse_page(html, keyword, i)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;-&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># -----------------</span>
</span></span><span style="display:flex;"><span>            timewait <span style="color:#f92672">=</span> random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">18</span>)
</span></span><span style="display:flex;"><span>            time<span style="color:#f92672">.</span>sleep(timewait)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;等待&#39;</span>, timewait, <span style="color:#e6db74">&#39;秒&#39;</span>)
</span></span></code></pre></div><h3 id="6-scraw-框架">6. Scraw 框架</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pip install scrapy
</span></span><span style="display:flex;"><span><span style="color:#75715e"># projectname为项目名称，可自定义</span>
</span></span><span style="display:flex;"><span>scrapy startproject projectname
</span></span><span style="display:flex;"><span><span style="color:#75715e">#文件结构</span>
</span></span><span style="display:flex;"><span>projectname<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span>    scrapy<span style="color:#f92672">.</span>cfg            <span style="color:#75715e"># 配置文件</span>
</span></span><span style="display:flex;"><span>    projectname<span style="color:#f92672">/</span>             <span style="color:#75715e"># 爬虫模块文件夹</span>
</span></span><span style="display:flex;"><span>        __init__<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>        items<span style="color:#f92672">.</span>py          <span style="color:#75715e"># items定义文件,设置数据存储模板，用于结构化数据，如：Django的Model</span>
</span></span><span style="display:flex;"><span>        middlewares<span style="color:#f92672">.</span>py    <span style="color:#75715e"># 中间件middlewares文件</span>
</span></span><span style="display:flex;"><span>        pipelines<span style="color:#f92672">.</span>py      <span style="color:#75715e"># 项目管道pipelines文件,数据处理行为，如：一般结构化的数据持久化</span>
</span></span><span style="display:flex;"><span>        settings<span style="color:#f92672">.</span>py       <span style="color:#75715e"># 设置settings文件</span>
</span></span><span style="display:flex;"><span>        spiders<span style="color:#f92672">/</span>          <span style="color:#75715e"># 爬虫文件夹 爬虫目录，如：创建文件，编写爬虫规则</span>
</span></span><span style="display:flex;"><span>            __init__<span style="color:#f92672">.</span>py
</span></span></code></pre></div><p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201030094148678.png"
    data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201030094148678.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201030094148678.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201030094148678.png 2x"
    data-sizes="auto"
    alt="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201030094148678.png"
    title="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20201030094148678.png"/></p>
<ol>
<li>The <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-engine"target="_blank" rel="external nofollow noopener noreferrer">Engine<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> gets the initial Requests to crawl from the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-spiders"target="_blank" rel="external nofollow noopener noreferrer">Spider<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>.</li>
<li>The <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-engine"target="_blank" rel="external nofollow noopener noreferrer">Engine<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> schedules the Requests in the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-scheduler"target="_blank" rel="external nofollow noopener noreferrer">Scheduler<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> and asks for the next Requests to crawl.</li>
<li>The <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-scheduler"target="_blank" rel="external nofollow noopener noreferrer">Scheduler<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> returns the next Requests to the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-engine"target="_blank" rel="external nofollow noopener noreferrer">Engine<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>.</li>
<li>The <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-engine"target="_blank" rel="external nofollow noopener noreferrer">Engine<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> sends the Requests to the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader"target="_blank" rel="external nofollow noopener noreferrer">Downloader<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>, passing through the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader-middleware"target="_blank" rel="external nofollow noopener noreferrer">Downloader Middlewares<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> (see <a href="https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#scrapy.downloadermiddlewares.DownloaderMiddleware.process_request"target="_blank" rel="external nofollow noopener noreferrer"><code>process_request()</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>).</li>
<li>Once the page finishes downloading the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader"target="_blank" rel="external nofollow noopener noreferrer">Downloader<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> generates a Response (with that page) and sends it to the Engine, passing through the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader-middleware"target="_blank" rel="external nofollow noopener noreferrer">Downloader Middlewares<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> (see <a href="https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#scrapy.downloadermiddlewares.DownloaderMiddleware.process_response"target="_blank" rel="external nofollow noopener noreferrer"><code>process_response()</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>).</li>
<li>The <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-engine"target="_blank" rel="external nofollow noopener noreferrer">Engine<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> receives the Response from the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-downloader"target="_blank" rel="external nofollow noopener noreferrer">Downloader<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> and sends it to the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-spiders"target="_blank" rel="external nofollow noopener noreferrer">Spider<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> for processing, passing through the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-spider-middleware"target="_blank" rel="external nofollow noopener noreferrer">Spider Middleware<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> (see <a href="https://doc.scrapy.org/en/latest/topics/spider-middleware.html#scrapy.spidermiddlewares.SpiderMiddleware.process_spider_input"target="_blank" rel="external nofollow noopener noreferrer"><code>process_spider_input()</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>).</li>
<li>The <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-spiders"target="_blank" rel="external nofollow noopener noreferrer">Spider<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> processes the Response and returns scraped items and new Requests (to follow) to the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-engine"target="_blank" rel="external nofollow noopener noreferrer">Engine<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>, passing through the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-spider-middleware"target="_blank" rel="external nofollow noopener noreferrer">Spider Middleware<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> (see <a href="https://doc.scrapy.org/en/latest/topics/spider-middleware.html#scrapy.spidermiddlewares.SpiderMiddleware.process_spider_output"target="_blank" rel="external nofollow noopener noreferrer"><code>process_spider_output()</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>).</li>
<li>The <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-engine"target="_blank" rel="external nofollow noopener noreferrer">Engine<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> sends processed items to <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-pipelines"target="_blank" rel="external nofollow noopener noreferrer">Item Pipelines<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>, then send processed Requests to the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-scheduler"target="_blank" rel="external nofollow noopener noreferrer">Scheduler<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> and asks for possible next Requests to crawl.</li>
<li>The process repeats (from step 1) until there are no more requests from the <a href="https://doc.scrapy.org/en/latest/topics/architecture.html#component-scheduler"target="_blank" rel="external nofollow noopener noreferrer">Scheduler<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>.</li>
</ol>
<p><strong>【几个特殊的类】</strong></p>
<ul>
<li>scrapy.Spider 类</li>
</ul>
<blockquote>
<p>the place where you define the custom behaviour for crawling and parsing pages for a particular site (or, in some cases, a group of sites).</p>
<ol>
<li>
<p>You start by generating the initial Requests to crawl the first URLs, and specify a callback function to be called with the response downloaded from those requests.</p>
<p>The first requests to perform are obtained by calling the <a href="https://doc.scrapy.org/en/latest/topics/spiders.html#scrapy.spiders.Spider.start_requests"target="_blank" rel="external nofollow noopener noreferrer"><code>start_requests()</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> method which (by default) generates <a href="https://doc.scrapy.org/en/latest/topics/request-response.html#scrapy.http.Request"target="_blank" rel="external nofollow noopener noreferrer"><code>Request</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> for the URLs specified in the <a href="https://doc.scrapy.org/en/latest/topics/spiders.html#scrapy.spiders.Spider.start_urls"target="_blank" rel="external nofollow noopener noreferrer"><code>start_urls</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> and the <a href="https://doc.scrapy.org/en/latest/topics/spiders.html#scrapy.spiders.Spider.parse"target="_blank" rel="external nofollow noopener noreferrer"><code>parse</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> method as callback function for the Requests.</p>
</li>
<li>
<p>In the callback function, you parse the response (web page) and return <a href="https://doc.scrapy.org/en/latest/topics/items.html#topics-items"target="_blank" rel="external nofollow noopener noreferrer">item objects<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>, <a href="https://doc.scrapy.org/en/latest/topics/request-response.html#scrapy.http.Request"target="_blank" rel="external nofollow noopener noreferrer"><code>Request</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> objects, or an iterable of these objects. Those Requests will also contain a callback (maybe the same) and will then be downloaded by Scrapy and then their response handled by the specified callback.</p>
</li>
<li>
<p>In callback functions, you parse the page contents, typically using <a href="https://doc.scrapy.org/en/latest/topics/selectors.html#topics-selectors"target="_blank" rel="external nofollow noopener noreferrer">Selectors<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> (but you can also use BeautifulSoup, lxml or whatever mechanism you prefer) and generate items with the parsed data.</p>
</li>
<li>
<p>Finally, the items returned from the spider will be typically persisted to a database (in some <a href="https://doc.scrapy.org/en/latest/topics/item-pipeline.html#topics-item-pipeline"target="_blank" rel="external nofollow noopener noreferrer">Item Pipeline<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>) or written to a file using <a href="https://doc.scrapy.org/en/latest/topics/feed-exports.html#topics-feed-exports"target="_blank" rel="external nofollow noopener noreferrer">Feed exports<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>.</p>
</li>
</ol>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> scrapy
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Spiders are classes that you define and that Scrapy uses to scrape information from a website (or a group of websites). They must subclass Spider and define the initial requests to make, optionally how to follow links in the pages, and how to parse the downloaded page content to extract data.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    start_requests(): must return an iterable of Requests (you can return a list of requests or write a generator function) which the Spider will begin to crawl from. Subsequent requests will be generated successively from these initial requests.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    parse(): a method that will be called to handle the response downloaded for each of the requests made. The response parameter is an instance of TextResponse that holds the page content and has further helpful methods to handle it.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    The parse() method usually parses the response, extracting the scraped data as dicts and also finding new URLs to follow and creating new requests (Request) from them.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 注意一定要继承 scrapy.Spider 类</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ToScrapeSpiderXPath</span>(scrapy<span style="color:#f92672">.</span>Spider):
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;toscrape-xpath&#39;</span>
</span></span><span style="display:flex;"><span>    start_urls <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;http://quotes.toscrape.com/&#39;</span>,
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse</span>(self, response):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> quote <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//div[@class=&#34;quote&#34;]&#39;</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">yield</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;text&#39;</span>: quote<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;./span[@class=&#34;text&#34;]/text()&#39;</span>)<span style="color:#f92672">.</span>extract_first(),
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;author&#39;</span>: quote<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;.//small[@class=&#34;author&#34;]/text()&#39;</span>)<span style="color:#f92672">.</span>extract_first(),
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;tags&#39;</span>: quote<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;.//div[@class=&#34;tags&#34;]/a[@class=&#34;tag&#34;]/text()&#39;</span>)<span style="color:#f92672">.</span>extract()
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        next_page_url <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>xpath(<span style="color:#e6db74">&#39;//li[@class=&#34;next&#34;]/a/@href&#39;</span>)<span style="color:#f92672">.</span>extract_first()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> next_page_url <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">yield</span> scrapy<span style="color:#f92672">.</span>Request(response<span style="color:#f92672">.</span>urljoin(next_page_url))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">QuotesSpider</span>(scrapy<span style="color:#f92672">.</span>Spider):
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;quotes&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">start_requests</span>(self):
</span></span><span style="display:flex;"><span>        urls <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;http://quotes.toscrape.com/page/1/&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;http://quotes.toscrape.com/page/2/&#39;</span>,
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> url <span style="color:#f92672">in</span> urls:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">yield</span> scrapy<span style="color:#f92672">.</span>Request(url<span style="color:#f92672">=</span>url, callback<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>parse)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse</span>(self, response):
</span></span><span style="display:flex;"><span>        page <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>url<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>        filename <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;quotes-</span><span style="color:#e6db74">{</span>page<span style="color:#e6db74">}</span><span style="color:#e6db74">.html&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> open(filename, <span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>            f<span style="color:#f92672">.</span>write(response<span style="color:#f92672">.</span>body)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>log(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Saved file </span><span style="color:#e6db74">{</span>filename<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AuthorSpider</span>(scrapy<span style="color:#f92672">.</span>Spider):
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;author&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    start_urls <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;http://quotes.toscrape.com/&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse</span>(self, response):
</span></span><span style="display:flex;"><span>        author_page_links <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>css(<span style="color:#e6db74">&#39;.author + a&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield from</span> response<span style="color:#f92672">.</span>follow_all(author_page_links, self<span style="color:#f92672">.</span>parse_author)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        pagination_links <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>css(<span style="color:#e6db74">&#39;li.next a&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield from</span> response<span style="color:#f92672">.</span>follow_all(pagination_links, self<span style="color:#f92672">.</span>parse)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse_author</span>(self, response):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">extract_with_css</span>(query):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> response<span style="color:#f92672">.</span>css(query)<span style="color:#f92672">.</span>get(default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;name&#39;</span>: extract_with_css(<span style="color:#e6db74">&#39;h3.author-title::text&#39;</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;birthdate&#39;</span>: extract_with_css(<span style="color:#e6db74">&#39;.author-born-date::text&#39;</span>),
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;bio&#39;</span>: extract_with_css(<span style="color:#e6db74">&#39;.author-description::text&#39;</span>),
</span></span><span style="display:flex;"><span>        }
</span></span></code></pre></div><ul>
<li><strong>Item</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#item 类型</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scrapy.item <span style="color:#f92672">import</span> Item, Field
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CustomItem</span>(Item):
</span></span><span style="display:flex;"><span>    one_field <span style="color:#f92672">=</span> Field()
</span></span><span style="display:flex;"><span>    another_field <span style="color:#f92672">=</span> Field()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># database 类型</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dataclasses <span style="color:#f92672">import</span> dataclass
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CustomItem</span>:
</span></span><span style="display:flex;"><span>    one_field: str
</span></span><span style="display:flex;"><span>    another_field: int
</span></span><span style="display:flex;"><span><span style="color:#75715e">#class 类型</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> scrapy
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Product</span>(scrapy<span style="color:#f92672">.</span>Item):
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> scrapy<span style="color:#f92672">.</span>Field()
</span></span><span style="display:flex;"><span>    price <span style="color:#f92672">=</span> scrapy<span style="color:#f92672">.</span>Field()
</span></span><span style="display:flex;"><span>    stock <span style="color:#f92672">=</span> scrapy<span style="color:#f92672">.</span>Field()
</span></span><span style="display:flex;"><span>    tags <span style="color:#f92672">=</span> scrapy<span style="color:#f92672">.</span>Field()
</span></span><span style="display:flex;"><span>    last_updated <span style="color:#f92672">=</span> scrapy<span style="color:#f92672">.</span>Field(serializer<span style="color:#f92672">=</span>str)
</span></span></code></pre></div><ul>
<li><strong>Item Loaders</strong></li>
</ul>
<blockquote>
<p>Item Loaders provide a convenient mechanism for populating scraped <a href="https://doc.scrapy.org/en/latest/topics/items.html#topics-items"target="_blank" rel="external nofollow noopener noreferrer">items<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>. Even though items can be populated directly, Item Loaders provide a much more convenient API for populating them from a scraping process, by automating some common tasks like parsing the raw extracted data before assigning it.</p>
<p>In other words, <a href="https://doc.scrapy.org/en/latest/topics/items.html#topics-items"target="_blank" rel="external nofollow noopener noreferrer">items<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> provide the <em>container</em> of scraped data, while Item Loaders provide the mechanism for <em>populating</em> that container.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> scrapy.loader <span style="color:#f92672">import</span> ItemLoader
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> myproject.items <span style="color:#f92672">import</span> Product
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse</span>(self, response):
</span></span><span style="display:flex;"><span>    l <span style="color:#f92672">=</span> ItemLoader(item<span style="color:#f92672">=</span>Product(), response<span style="color:#f92672">=</span>response)
</span></span><span style="display:flex;"><span>    l<span style="color:#f92672">.</span>add_xpath(<span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#e6db74">&#39;//div[@class=&#34;product_name&#34;]&#39;</span>)
</span></span><span style="display:flex;"><span>    l<span style="color:#f92672">.</span>add_xpath(<span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#e6db74">&#39;//div[@class=&#34;product_title&#34;]&#39;</span>)
</span></span><span style="display:flex;"><span>    l<span style="color:#f92672">.</span>add_xpath(<span style="color:#e6db74">&#39;price&#39;</span>, <span style="color:#e6db74">&#39;//p[@id=&#34;price&#34;]&#39;</span>)
</span></span><span style="display:flex;"><span>    l<span style="color:#f92672">.</span>add_css(<span style="color:#e6db74">&#39;stock&#39;</span>, <span style="color:#e6db74">&#39;p#stock]&#39;</span>)
</span></span><span style="display:flex;"><span>    l<span style="color:#f92672">.</span>add_value(<span style="color:#e6db74">&#39;last_updated&#39;</span>, <span style="color:#e6db74">&#39;today&#39;</span>) <span style="color:#75715e"># you can also use literal values</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> l<span style="color:#f92672">.</span>load_item()
</span></span><span style="display:flex;"><span><span style="color:#75715e">#when all data is collected, the ItemLoader.load_item() method is called which actually returns the item populated with the data previously extracted and collected with the add_xpath(), add_css(), and add_value() calls.</span>
</span></span></code></pre></div><ul>
<li><strong>Pipeline</strong></li>
</ul>
<blockquote>
<p>They receive an item and perform an action over it, also deciding if the item should continue through the pipeline or be dropped and no longer processed.Typical uses of item pipelines are:</p>
<ul>
<li>
<p>cleansing HTML data</p>
</li>
<li>
<p>validating scraped data (checking that the items contain certain fields)</p>
</li>
<li>
<p>checking for duplicates (and dropping them)</p>
</li>
<li>
<p>storing the scraped item in a database</p>
</li>
</ul>
<p><code>Process_item</code>(<em>self</em>, <em>item</em>, <em>spider</em>)</p>
<p>This method is called for every item pipeline component.</p>
<p>item is an <a href="https://doc.scrapy.org/en/latest/topics/items.html#item-types"target="_blank" rel="external nofollow noopener noreferrer">item object<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>, see <a href="https://doc.scrapy.org/en/latest/topics/items.html#supporting-item-types"target="_blank" rel="external nofollow noopener noreferrer">Supporting All Item Types<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>.</p>
<p><a href="https://doc.scrapy.org/en/latest/topics/item-pipeline.html#process_item"target="_blank" rel="external nofollow noopener noreferrer"><code>process_item()</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> must either: return an <a href="https://doc.scrapy.org/en/latest/topics/items.html#item-types"target="_blank" rel="external nofollow noopener noreferrer">item object<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>, return a <a href="https://twistedmatrix.com/documents/current/api/twisted.internet.defer.Deferred.html"target="_blank" rel="external nofollow noopener noreferrer"><code>Deferred</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> or raise a <a href="https://doc.scrapy.org/en/latest/topics/exceptions.html#scrapy.exceptions.DropItem"target="_blank" rel="external nofollow noopener noreferrer"><code>DropItem</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> exception.</p>
<p>Dropped items are no longer processed by further pipeline components.</p>
<ul>
<li>
<p>Parameters</p>
<p><strong>item</strong> (<a href="https://doc.scrapy.org/en/latest/topics/items.html#item-types"target="_blank" rel="external nofollow noopener noreferrer">item object<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>) – the scraped item<strong>spider</strong> (<a href="https://doc.scrapy.org/en/latest/topics/spiders.html#scrapy.spiders.Spider"target="_blank" rel="external nofollow noopener noreferrer"><code>Spider</code><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> object) – the spider which scraped the item</p>
</li>
<li>
<p>Activate the Pipeline</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ITEM_PIPELINES <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;myproject.pipelines.PricePipeline&#39;</span>: <span style="color:#ae81ff">300</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;myproject.pipelines.JsonWriterPipeline&#39;</span>: <span style="color:#ae81ff">800</span>,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#vaidation</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> itemadapter <span style="color:#f92672">import</span> ItemAdapter
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scrapy.exceptions <span style="color:#f92672">import</span> DropItem
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PricePipeline</span>:
</span></span><span style="display:flex;"><span>    vat_factor <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.15</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">process_item</span>(self, item, spider):
</span></span><span style="display:flex;"><span>        adapter <span style="color:#f92672">=</span> ItemAdapter(item)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> adapter<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;price&#39;</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> adapter<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;price_excludes_vat&#39;</span>):
</span></span><span style="display:flex;"><span>                adapter[<span style="color:#e6db74">&#39;price&#39;</span>] <span style="color:#f92672">=</span> adapter[<span style="color:#e6db74">&#39;price&#39;</span>] <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>vat_factor
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> item
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> DropItem(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Missing price in </span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#write to json</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> itemadapter <span style="color:#f92672">import</span> ItemAdapter
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">JsonWriterPipeline</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">open_spider</span>(self, spider):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>file <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;items.jl&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">close_spider</span>(self, spider):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>file<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">process_item</span>(self, item, spider):
</span></span><span style="display:flex;"><span>        line <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(ItemAdapter(item)<span style="color:#f92672">.</span>asdict()) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>file<span style="color:#f92672">.</span>write(line)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> item
</span></span><span style="display:flex;"><span><span style="color:#75715e">#write to Mongodb</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pymongo
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> itemadapter <span style="color:#f92672">import</span> ItemAdapter
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MongoPipeline</span>:
</span></span><span style="display:flex;"><span>    collection_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;scrapy_items&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, mongo_uri, mongo_db):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>mongo_uri <span style="color:#f92672">=</span> mongo_uri
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>mongo_db <span style="color:#f92672">=</span> mongo_db
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@classmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">from_crawler</span>(cls, crawler):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> cls(
</span></span><span style="display:flex;"><span>            mongo_uri<span style="color:#f92672">=</span>crawler<span style="color:#f92672">.</span>settings<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;MONGO_URI&#39;</span>),
</span></span><span style="display:flex;"><span>            mongo_db<span style="color:#f92672">=</span>crawler<span style="color:#f92672">.</span>settings<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;MONGO_DATABASE&#39;</span>, <span style="color:#e6db74">&#39;items&#39;</span>)
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">open_spider</span>(self, spider):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> pymongo<span style="color:#f92672">.</span>MongoClient(self<span style="color:#f92672">.</span>mongo_uri)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>db <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client[self<span style="color:#f92672">.</span>mongo_db]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">close_spider</span>(self, spider):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">process_item</span>(self, item, spider):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>db[self<span style="color:#f92672">.</span>collection_name]<span style="color:#f92672">.</span>insert_one(ItemAdapter(item)<span style="color:#f92672">.</span>asdict())
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> item
</span></span><span style="display:flex;"><span><span style="color:#75715e">#duplicate</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> itemadapter <span style="color:#f92672">import</span> ItemAdapter
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scrapy.exceptions <span style="color:#f92672">import</span> DropItem
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DuplicatesPipeline</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>ids_seen <span style="color:#f92672">=</span> set()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">process_item</span>(self, item, spider):
</span></span><span style="display:flex;"><span>        adapter <span style="color:#f92672">=</span> ItemAdapter(item)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> adapter[<span style="color:#e6db74">&#39;id&#39;</span>] <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>ids_seen:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> DropItem(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Duplicate item found: </span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">!r}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>ids_seen<span style="color:#f92672">.</span>add(adapter[<span style="color:#e6db74">&#39;id&#39;</span>])
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> item
</span></span></code></pre></div><h3 id="7-数据可视化">7. 数据可视化</h3>
<p>使用pyechart</p>
<ul>
<li><a href="https://www.cnblogs.com/-wenli/p/10646261.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.cnblogs.com/-wenli/p/10646261.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
<li><a href="https://juejin.im/post/6844903861245722631"target="_blank" rel="external nofollow noopener noreferrer">https://juejin.im/post/6844903861245722631<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
</ul>
<p>使用BI软件</p>
<p>使用Original2018 软件</p>
<h3 id="-学习链接">. 学习链接</h3>
<ul>
<li><a href="https://www.k0rz3n.com/2019/03/05/%E7%88%AC%E8%99%AB%E7%88%AC%E5%8F%96%E5%8A%A8%E6%80%81%E7%BD%91%E9%A1%B5%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F%E7%AE%80%E4%BB%8B/"target="_blank" rel="external nofollow noopener noreferrer">https://www.k0rz3n.com/2019/03/05/%E7%88%AC%E8%99%AB%E7%88%AC%E5%8F%96%E5%8A%A8%E6%80%81%E7%BD%91%E9%A1%B5%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F%E7%AE%80%E4%BB%8B/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
<li><a href="https://www.cnblogs.com/LXP-Never/p/11374795.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.cnblogs.com/LXP-Never/p/11374795.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
<li><a href="https://www.runoob.com/python3/python3-json.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.runoob.com/python3/python3-json.html<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
<li>crawl:https://doc.scrapy.org/en/latest/topics/architecture.html</li>
<li>后续学习：
<ul>
<li>Dataset 框架</li>
<li>分布式反爬虫机制</li>
<li>Datasetlab 平台： <a href="https://github.com/crawlab-team/crawlab"target="_blank" rel="external nofollow noopener noreferrer">https://github.com/crawlab-team/crawlab<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>； <a href="https://demo-pro.crawlab.cn/#/spiders/5f9ae48321225400243ed393"target="_blank" rel="external nofollow noopener noreferrer">https://demo-pro.crawlab.cn/#/spiders/5f9ae48321225400243ed393<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
</ul>
</li>
</ul>
</div>
<div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title=2023-09-29&#32;00:26:49>更新于 2023-09-29&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"><span><a href="/crawl_record/index.md" title="阅读原始文档" class="link-to-markdown">阅读原始文档</a></span><span><a href="https://liudongdong1.github.io/edit/master/content/posts%5c%e8%87%aa%e7%84%b6%e8%af%ad%e8%a8%80%5cCrawl_record.md" title="编辑此页"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">编辑此页</a></span></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://liudongdong1.github.io/crawl_record/" data-title="Crawl_record" data-hashtags="Data"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://liudongdong1.github.io/crawl_record/" data-hashtag="Data"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://liudongdong1.github.io/crawl_record/" data-title="Crawl_record" data-image="https://gitee.com/github-25970295/blogImage/raw/master/img/2.jpeg"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/data/">Data</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/objectdetection/" class="prev" rel="prev" title="ObjectDetection"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>ObjectDetection</a>
      <a href="/typescript/" class="next" rel="next" title="Typescript">Typescript<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.118.2">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.2.17-RC"><img class="fixit-icon" src="/fixit.min.svg" alt="FixIt logo" />&nbsp;FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2020 - 2023</span><span class="author" itemprop="copyrightHolder">
              <a href="https://liudongdong1.github.io/"target="_blank" rel="external nofollow noopener noreferrer">LiuDongdong</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class="site-time" title='网站运行中 ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden="true"></i>&nbsp;<span class="run-times">网站运行中 ...</span></span></div><div class="footer-line ibruce">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><a href="https://liudongdong1.github.io/" title="在 GitHub 上查看源代码"target="_blank" rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;--bg-progress: #0076ff;--bg-progress-dark: #fff;"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/algoliasearch/algoliasearch-lite.umd.min.js" defer></script><script src="/lib/lazysizes/lazysizes.min.js" async defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/lib/pangu/pangu.min.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"typeit-header-subtitle-desktop":"\u003cspan style='font-family: MMT,\"沐目体\";'\u003e吾日三省吾身\u003c/span\u003e","typeit-header-subtitle-mobile":"\u003cspan style='font-family: MMT,\"沐目体\";'\u003e吾日三省吾身\u003c/span\u003e"},"enablePWA":true,"enablePangu":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"2R1K9SKLQZ","algoliaIndex":"index.zh-cn","algoliaSearchKey":"4a226aa1c5c98d6859e4d1386adb2bc7","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"},"siteTime":"2020-12-18T16:15:22+08:00","typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"typeit-header-subtitle-desktop":["typeit-header-subtitle-desktop"],"typeit-header-subtitle-mobile":["typeit-header-subtitle-mobile"]},"duration":-1,"speed":100},"watermark":{"appendto":".wrapper\u003emain","colspacing":30,"content":"\u003cimg class=\"fixit-icon\" src=\"/fixit.min.svg\" alt=\"FixIt logo\" /\u003e FixIt 主题","enable":true,"fontfamily":"inherit","fontsize":0.85,"height":21,"opacity":0.0125,"rotate":15,"rowspacing":60,"width":150}};</script><script src="/js/theme.min.js" defer></script><script src="/js/custom.min.js" defer></script></body>
</html>
