<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Kubernetes-存储介绍 - DAY By DAY</title><meta name=author content="LiuDongdong"><meta name=author-link content="https://liudongdong1.github.io/"><meta name=description content="Docker插件机制-架构&评价 Docker volumn 插件 名称 描述 地址 Azure File Storage plugin Lets you mount Microsoft Azure File Storage shares to Docker containers as volumes using the SMB 3.0 protocol. Learn more. https://github.com/Azure/azurefile dockervolumedriver BeeGFS Volume Plugin An open source volume plugin to create persistent volumes in a"><meta name=keywords content="Storage"><meta itemprop=name content="Kubernetes-存储介绍"><meta itemprop=description content="Docker插件机制-架构&评价 Docker volumn 插件 名称 描述 地址 Azure File Storage plugin Lets you mount Microsoft Azure File Storage shares to Docker containers as volumes using the SMB 3.0 protocol. Learn more. https://github.com/Azure/azurefile dockervolumedriver BeeGFS Volume Plugin An open source volume plugin to create persistent volumes in a"><meta itemprop=dateModified content="2023-09-24T17:00:04+08:00"><meta itemprop=wordCount content="3401"><meta itemprop=image content="/logo.png"><meta itemprop=keywords content="Storage,"><meta property="og:title" content="Kubernetes-存储介绍"><meta property="og:description" content="Docker插件机制-架构&评价 Docker volumn 插件 名称 描述 地址 Azure File Storage plugin Lets you mount Microsoft Azure File Storage shares to Docker containers as volumes using the SMB 3.0 protocol. Learn more. https://github.com/Azure/azurefile dockervolumedriver BeeGFS Volume Plugin An open source volume plugin to create persistent volumes in a"><meta property="og:type" content="article"><meta property="og:url" content="liudongdong1.github.io/kubernetes_%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D/"><meta property="og:image" content="/logo.png"><meta property="article:section" content="posts"><meta property="article:modified_time" content="2023-09-24T17:00:04+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo.png"><meta name=twitter:title content="Kubernetes-存储介绍"><meta name=twitter:description content="Docker插件机制-架构&评价 Docker volumn 插件 名称 描述 地址 Azure File Storage plugin Lets you mount Microsoft Azure File Storage shares to Docker containers as volumes using the SMB 3.0 protocol. Learn more. https://github.com/Azure/azurefile dockervolumedriver BeeGFS Volume Plugin An open source volume plugin to create persistent volumes in a"><meta name=application-name content="DAY By DAY"><meta name=apple-mobile-web-app-title content="DAY By DAY"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=liudongdong1.github.io/kubernetes_%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D/><link rel=prev href=liudongdong1.github.io/kubernets%E4%BB%8B%E7%BB%8D/><link rel=next href=liudongdong1.github.io/kubernetes_%E5%AD%98%E5%82%A8nfs%E5%AE%9E%E8%B7%B5/><link rel=stylesheet href=/liudongdong1.github.io/css/style.min.css><link rel=stylesheet href=/liudongdong1.github.io/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/liudongdong1.github.io/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Kubernetes-存储介绍","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"liudongdong1.github.io\/kubernetes_%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D\/"},"genre":"posts","keywords":"Storage","wordcount":3401,"url":"liudongdong1.github.io\/kubernetes_%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D\/","dateModified":"2023-09-24T17:00:04+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"LiuDongdong","logo":"\/images\/person.png"},"author":{"@type":"Person","name":"liudongdong1"},"description":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=liudongdong1.github.io/ title="DAY By DAY"><img class="lazyload logo" src=/liudongdong1.github.io/svg/loading.min.svg data-src=/fixit.min.svg data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x" data-sizes=auto alt="DAY By DAY" title="DAY By DAY"><span class=header-title-text></span></a><span id=typeit-header-subtitle-desktop class="typeit header-subtitle"></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/friends/ title=友情链接><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item>没有更多翻译</li></ul></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=liudongdong1.github.io/ title="DAY By DAY"><img class="lazyload logo" src=/liudongdong1.github.io/svg/loading.min.svg data-src=/fixit.min.svg data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x" data-sizes=auto alt=/fixit.min.svg title=/fixit.min.svg><span class=header-title-text></span></a><span id=typeit-header-subtitle-mobile class="typeit header-subtitle"></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/friends/ title=友情链接><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item text-center"><a class=menu-link href=https://liudongdong1.github.io/ title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw' aria-hidden=true></i></a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option disabled>没有更多翻译</option></select></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container data-page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>目录 <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom id=aside-sakana><div class=sakana-widget><div class=sakana-item id=takina-widget></div><div class=sakana-item id=chisato-widget></div></div><script>function initSakanaWidget(){const e=SakanaWidget.getCharacter("takina");SakanaWidget.registerCharacter("takina-slow",e),new SakanaWidget({character:"takina-slow",controls:!1,autoFit:!0,stroke:{color:"#b4b4b4",width:2}}).mount("#takina-widget");const t=SakanaWidget.getCharacter("chisato");SakanaWidget.registerCharacter("chisato-slow",t),new SakanaWidget({character:"chisato-slow",controls:!1,autoFit:!0,stroke:{color:"#b4b4b4",width:2}}).mount("#chisato-widget")}</script><script async onload=initSakanaWidget() src=https://cdn.jsdelivr.net/npm/sakana-widget@2.3.0/lib/sakana.min.js></script></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Kubernetes-存储介绍</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
liudongdong1</span></span>
<span class=post-category>收录于 <a href=liudongdong1.github.io/categories/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;Categories</a>&ensp;<a href=liudongdong1.github.io/categories/storage/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;Storage</a></span></div><div class=post-meta-line><span title="0001-01-01 00:00:00"><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=0001-01-01>0001-01-01</time>
</span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;约 3401 字&nbsp;
<i class="fa-regular fa-clock fa-fw"></i>&nbsp;预计阅读 7 分钟&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=Kubernetes-存储介绍>
<i class="fa-regular fa-eye fa-fw"></i>&nbsp;<span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class=featured-image><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://cdn.pixabay.com/photo/2021/08/25/05/01/boat-6572384__340.jpg data-srcset="https://cdn.pixabay.com/photo/2021/08/25/05/01/boat-6572384__340.jpg, https://cdn.pixabay.com/photo/2021/08/25/05/01/boat-6572384__340.jpg 1.5x, https://cdn.pixabay.com/photo/2021/08/25/05/01/boat-6572384__340.jpg 2x" data-sizes=auto alt=https://cdn.pixabay.com/photo/2021/08/25/05/01/boat-6572384__340.jpg title=https://cdn.pixabay.com/photo/2021/08/25/05/01/boat-6572384__340.jpg></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#docker插件机制-架构评价>Docker插件机制-架构&评价</a><ul><li><a href=#docker-volumn-插件>Docker volumn 插件</a></li></ul></li><li><a href=#k8s-存储能力-volume概述>K8S 存储能力-Volume概述</a><ul><li><a href=#k8s-存储能力-in-tree-volume-plugins>K8S 存储能力： In-Tree Volume Plugins</a></li><li><a href=#k8s-存储能力-persistentvolume-->K8S 存储能力-PersistentVolume **</a></li><li><a href=#k8s-flexvolume存储扩展机制>K8S FlexVolume存储扩展机制</a></li><li><a href=#k8s-csi存储扩展机制>K8S CSI存储扩展机制</a></li><li><a href=#csi通用架构>CSI通用架构</a></li><li><a href=#rpc-接口集合>RPC 接口集合</a></li></ul></li><li><a href=#k8s-csi架构>K8S CSI架构</a></li></ul></nav></div></div><div class=content id=content><h2 id=docker插件机制-架构评价>Docker插件机制-架构&评价</h2><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220724085742161.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220724085742161.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220724085742161.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220724085742161.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220724085742161.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220724085742161.png></p><h3 id=docker-volumn-插件>Docker volumn 插件</h3><table><thead><tr><th>名称</th><th>描述</th><th>地址</th></tr></thead><tbody><tr><td>Azure File Storage plugin</td><td>Lets you mount Microsoft Azure File Storage shares to Docker containers as volumes using the SMB 3.0 protocol. Learn more.</td><td><a href=https://github.com/Azure/azurefile target=_blank rel="external nofollow noopener noreferrer">https://github.com/Azure/azurefile<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> dockervolumedriver</td></tr><tr><td>BeeGFS Volume Plugin</td><td>An open source volume plugin to create persistent volumes in a BeeGFS parallel file system.</td><td><a href=https://github.com/RedCoolBeans/ target=_blank rel="external nofollow noopener noreferrer">https://github.com/RedCoolBeans/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> docker-volume-beegfs</td></tr><tr><td>Blockbridge plugin</td><td>A volume plugin that provides access to an extensible set of container-based persistent storage options. It supports single and multi-host Docker environments with features that include tenant isolation, automated provisioning, encryption, secure deletion, snapshots and QoS.</td><td><a href=https://github.com/blockbridge/blo target=_blank rel="external nofollow noopener noreferrer">https://github.com/blockbridge/blo<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> ckbridge-docker-volume</td></tr><tr><td>Contiv Volume Plugin</td><td>An open source volume plugin that provides multi-tenant, persistent, distributed storage with intent based consumption. It has support for Ceph and NFS.</td><td><a href=https://github.com/rancher/convoy target=_blank rel="external nofollow noopener noreferrer">https://github.com/rancher/convoy<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></td></tr><tr><td>DigitalOcean Block Storage plugin</td><td>Integrates DigitalOcean’s block storage solution into the Docker ecosystem by automatically attaching a given block storage volume to a DigitalOcean droplet and making the contents of the volume available to Docker containers running on that droplet.</td><td><a href=https://github.com/omallo/docker target=_blank rel="external nofollow noopener noreferrer">https://github.com/omallo/docker<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> volume-plugin-dostorage</td></tr><tr><td>DRBD plugin</td><td>A volume plugin that provides highly available storage replicated by DRBD. Data written to the docker volume is replicated in a cluster of DRBD nodes.</td><td><a href=https://www.drbd.org/en/supporte target=_blank rel="external nofollow noopener noreferrer">https://www.drbd.org/en/supporte<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> d-projects/docker</td></tr><tr><td>Flocker plugin</td><td>A volume plugin that provides multi-host portable volumes for Docker, enabling you to run databases and other stateful containers and move them around across a cluster of machines.</td><td><a href=https://clusterhq.com/docker target=_blank rel="external nofollow noopener noreferrer">https://clusterhq.com/docker<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> plugin/</td></tr><tr><td>Fuxi Volume Plugin</td><td>A volume plugin that is developed as part of the OpenStack Kuryr project and implements the Docker volume plugin API by utilizing Cinder, the OpenStack block storage service.</td><td><a href=https://github.com/openstack/fuxi target=_blank rel="external nofollow noopener noreferrer">https://github.com/openstack/fuxi<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></td></tr><tr><td>gce-docker plugin</td><td>A volume plugin able to attach, format and mount Google Compute persistent-disks.</td><td><a href=https://github.com/mcuadros/gce target=_blank rel="external nofollow noopener noreferrer">https://github.com/mcuadros/gce<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> docker</td></tr><tr><td>GlusterFS plugin</td><td>A volume plugin that provides multi-host volumes management for Docker using GlusterFS.</td><td><a href=https://github.com/calavera/docker target=_blank rel="external nofollow noopener noreferrer">https://github.com/calavera/docker<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> -volume-glusterfs</td></tr></tbody></table><table><thead><tr><th>Horcrux Volume Plugin</th><th>A volume plugin that allows on-demand, version controlled access to your data. Horcrux is an open-source plugin, written in Go, and supports SCP, Minio and Amazon S3.</th><th><a href=https://github.com/muthu-r/horcrux target=_blank rel="external nofollow noopener noreferrer">https://github.com/muthu-r/horcrux<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></th></tr></thead><tbody><tr><td>HPE 3Par Volume Plugin</td><td>A volume plugin that supports HPE 3Par and StoreVirtual iSCSI storage arrays.</td><td><a href=https://github.com/hpe target=_blank rel="external nofollow noopener noreferrer">https://github.com/hpe<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> storage/python-hpedockerplugin/ -</td></tr><tr><td>Infinit volume plugin</td><td>A volume plugin that makes it easy to mount and manage Infinit volumes using Docker.</td><td><a href=https://infinit.sh/documentation/dock target=_blank rel="external nofollow noopener noreferrer">https://infinit.sh/documentation/dock<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> er/volume-plugin</td></tr><tr><td>IPFS Volume Plugin</td><td>An open source volume plugin that allows using an ipfs filesystem as a volume.</td><td><a href=http://github.com/vdemeester/docker target=_blank rel="external nofollow noopener noreferrer">http://github.com/vdemeester/docker<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> -volume-ipfs</td></tr><tr><td>Keywhiz plugin</td><td>A plugin that provides credentials and secret management using Keywhiz as a central repository.</td><td><a href=https://github.com/calavera/docker target=_blank rel="external nofollow noopener noreferrer">https://github.com/calavera/docker<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> volume-keywhiz</td></tr><tr><td>Local Persist Plugin</td><td>A volume plugin that extends the default local driver’s functionality by allowing you specify a mountpoint anywhere on the host, which enables the files to always persist, even if the volume is removed via docker volume rm.</td><td><a href=https://github.com/CWSpear/local target=_blank rel="external nofollow noopener noreferrer">https://github.com/CWSpear/local<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> persist</td></tr><tr><td>NetApp Plugin(nDVP)</td><td>A volume plugin that provides direct integration with the Docker ecosystem for the NetApp storage portfolio. The nDVP package supports the provisioning and management of storage resources from the storage platform to Docker hosts, with a robust framework for adding additional platforms in the future.</td><td><a href=https://github.com/NetApp/netappdv target=_blank rel="external nofollow noopener noreferrer">https://github.com/NetApp/netappdv<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> p</td></tr><tr><td>Netshare plugin</td><td>A volume plugin that provides volume management for NFS 3/4, AWS EFS and CIFS file systems.</td><td><a href=https://github.com/ContainX/docker target=_blank rel="external nofollow noopener noreferrer">https://github.com/ContainX/docker<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> volume-netshare</td></tr><tr><td>Nimble Storage Volume Plugin</td><td>A volume plug-in that integrates with Nimble Storage Unified Flash Fabric arrays. The plug-in abstracts array volume capabilities to the Docker administrator to allow self-provisioning of secure multi-tenant volumes and clones.</td><td><a href=https://connect.nimblestorage.com/co target=_blank rel="external nofollow noopener noreferrer">https://connect.nimblestorage.com/co<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> mmunity/app-integration/dockerOpenStorage Plugin</td></tr></tbody></table><table><thead><tr><th>OpenStorage Plugin</th><th>A cluster-aware volume plugin that provides volume management for file and block storage solutions. It implements a vendor neutral specification for implementing extensions such as CoS, encryption, and snapshots. It has example drivers based on FUSE, NFS, NBD and EBS to name a few.</th><th><a href=https://github.com/libopenstorage/ target=_blank rel="external nofollow noopener noreferrer">https://github.com/libopenstorage/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> openstorage</th></tr></thead><tbody><tr><td>Portworx Volume Plugin</td><td>A volume plugin that turns any server into a scale-out converged compute/storage node, providing container granular storage and highly available volumes across any node, using a shared-nothing storage backend that works with any docker scheduler.</td><td><a href=https://github.com/portworx/px target=_blank rel="external nofollow noopener noreferrer">https://github.com/portworx/px<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> dev</td></tr><tr><td>Quobyte Volume Plugin</td><td>A volume plugin that connects Docker to Quobyte’s data center file system, a general-purpose scalable and fault-tolerant storage platform.</td><td><a href=https://github.com/quobyte/docker target=_blank rel="external nofollow noopener noreferrer">https://github.com/quobyte/docker<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> -volume</td></tr><tr><td>REX-Ray plugin</td><td>A volume plugin which is written in Go and provides advanced storage functionality for many platforms including VirtualBox, EC2, Google Compute Engine, OpenStack, and EMC.</td><td><a href=https://github.com/emccode/rexray target=_blank rel="external nofollow noopener noreferrer">https://github.com/emccode/rexray<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></td></tr><tr><td>Virtuozzo Storage and Ploop plugin</td><td>A volume plugin with support for Virtuozzo Storage distributed cloud file system as well as ploop devices.</td><td><a href=https://github.com/virtuozzo/docke target=_blank rel="external nofollow noopener noreferrer">https://github.com/virtuozzo/docke<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> r-volume-ploop</td></tr><tr><td>VMware vSphere Storage Plugin</td><td>Docker Volume Driver for vSphere enables customers to address persistent storage requirements for Docker containers in vSphere environments.</td><td><a href=https://github.com/vmware/docker target=_blank rel="external nofollow noopener noreferrer">https://github.com/vmware/docker<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> volume-vsphere</td></tr></tbody></table><h2 id=k8s-存储能力-volume概述>K8S 存储能力-Volume概述</h2><ul><li>K8S中的<code>普通Volume</code>提供了在容器中挂卷的能力，它不是独立的K8S资源对象，<code>不能通过k8s去管理（创建、删除等）</code>，只能在创建Pod时去引用。</li><li>Pod需要设置<code>卷来源（ spec.volume ） 和挂载点（ spec.containers.volumeMounts ）</code> 两个信息后才可以使用相应的Volume。</li></ul><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMSAFuccAAGVhqcxzgU330.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMSAFuccAAGVhqcxzgU330.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMSAFuccAAGVhqcxzgU330.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMSAFuccAAGVhqcxzgU330.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMSAFuccAAGVhqcxzgU330.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMSAFuccAAGVhqcxzgU330.png></p><h3 id=k8s-存储能力-in-tree-volume-plugins>K8S 存储能力： In-Tree Volume Plugins</h3><blockquote><p>K8S的VolumePlugin提供了<code>插件化扩展存储的机制</code>，分为内置插件（In-Tree Plugins）和外置插件（Out-of-Tree） 两种</p></blockquote><table><thead><tr><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>awsElasticBlockStore</td><td>mounts an Amazon Web Services (AWS) EBS Volume (Elastic Block Store)</td></tr><tr><td>azureDisk</td><td>is used to mount a Microsoft Azure Data Disk into a Pod.</td></tr><tr><td>azureFile</td><td>is used to mount a Microsoft Azure File Volume (SMB 2.1 and 3.0) into a Pod.</td></tr><tr><td><code>cephfs</code></td><td>allows an existing CephFS volume to be mounted into your pod.</td></tr><tr><td>cinder</td><td>is used to mount OpenStack Block Storage into a pod.</td></tr><tr><td><code>configMap</code></td><td>The data stored in a ConfigMap object can be referenced in a volume of type configMap and then consumed by containerized applications running in a Pod.</td></tr><tr><td>downwardAPI</td><td>is used to make downward API data available to applications. It mounts a directory and writes the requested data in plain text files</td></tr><tr><td>emptyDir</td><td>is first created when a Pod is assigned to a Node, and exists as long as that Pod is running on that node. When a Pod is removed from a node for any reason, the data in the emptyDir is deleted forever.</td></tr><tr><td>fc (fibre channel)</td><td>allows an existing fibre channel volume to be mounted in a pod</td></tr><tr><td>flocker</td><td>allows a Flocker dataset to be mounted into a pod.</td></tr><tr><td>gcePersistentDisk</td><td>mounts a Google Compute Engine (GCE) Persistent Disk into your pod.</td></tr><tr><td>gitRepo</td><td>mounts an empty directory and clones a git repository into it for your pod to use.</td></tr><tr><td><code>glusterfs</code></td><td>allows a Glusterfs (an open source networked filesystem) volume to be mounted into your pod</td></tr><tr><td><code>hostPath</code></td><td>mounts a file or directory from the host node’s filesystem into your pod.</td></tr><tr><td><code>iscsi</code></td><td>allows an existing iSCSI (SCSI over IP) volume to be mounted into your pod</td></tr><tr><td><code>local</code></td><td>represents a mounted local storage device such as a disk, partition or directory. can only be used as a statically created PersistentVolume.</td></tr></tbody></table><table><thead><tr><th>名称</th><th>描述</th></tr></thead><tbody><tr><td><code>nfs</code></td><td>allows an existing NFS (Network File System) share to be mounted into your pod</td></tr><tr><td><code>persistentVolumeClaim</code></td><td>is used to mount a PersistentVolume into a pod.</td></tr><tr><td>projected</td><td>maps several existing volume sources into the same directory.</td></tr><tr><td><code>portworxVolume</code></td><td>can be dynamically created through Kubernetes or it can also be pre-provisioned and referenced inside a Kubernetes pod.</td></tr><tr><td>quobyte</td><td>allows an existing Quobyte volume to be mounted into your pod.</td></tr><tr><td>rbd</td><td>allows a Rados Block Device volume to be mounted into your pod.</td></tr><tr><td>scaleIO</td><td>ScaleIO is a software-based storage platform that can use existing hardware to create clusters of scalable shared block networked storage. The ScaleIO volume plugin allows deployed pods to access existing ScaleIO volumes</td></tr><tr><td>secret</td><td>is used to pass sensitive information, such as passwords, to pods</td></tr><tr><td>storageos</td><td>allows an existing StorageOS volume to be mounted into your pod. StorageOS provides block storage to containers, accessible via a file system.</td></tr><tr><td>vsphereVolume</td><td>used to mount a vSphere VMDK Volume into your Pod.</td></tr></tbody></table><h3 id=k8s-存储能力-persistentvolume-->K8S 存储能力-PersistentVolume **</h3><blockquote><p>Kubernetes通过Persistent Volume子系统API对管理员和用户提供了存储资源创建和使用的抽象</p><ul><li><code>FlexVolume: 此Volume Driver允许不同厂商去开发他们自己的驱动来挂载卷到计算节点</code></li><li>PersistentVolumeClaim： K8提供的资源抽象的Volume Driver，让用户不用关心具体的Volume的实现细节</li></ul></blockquote><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMWAPt5SAAHnN6RtcJw960.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMWAPt5SAAHnN6RtcJw960.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMWAPt5SAAHnN6RtcJw960.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMWAPt5SAAHnN6RtcJw960.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMWAPt5SAAHnN6RtcJw960.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMWAPt5SAAHnN6RtcJw960.png></p><h3 id=k8s-flexvolume存储扩展机制>K8S FlexVolume存储扩展机制</h3><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMeAcOhmAAIU1aMDRxU941.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMeAcOhmAAIU1aMDRxU941.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMeAcOhmAAIU1aMDRxU941.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMeAcOhmAAIU1aMDRxU941.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMeAcOhmAAIU1aMDRxU941.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMeAcOhmAAIU1aMDRxU941.png></p><h4 id=flex-volume-driver部署脚本和配置>Flex Volume Driver部署脚本和配置</h4><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMiAQ_4JAAK-YG1tcjA886.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMiAQ_4JAAK-YG1tcjA886.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMiAQ_4JAAK-YG1tcjA886.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMiAQ_4JAAK-YG1tcjA886.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMiAQ_4JAAK-YG1tcjA886.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMiAQ_4JAAK-YG1tcjA886.png></p><h4 id=flex-volume-cli-api>Flex Volume CLI API</h4><table><thead><tr><th>步骤</th><th>命令</th><th>描述</th></tr></thead><tbody><tr><td>Init</td><td>init</td><td>初始化驱动。在Kubelet和Controller-Manager初始化时被调用。若调用成功则需要返回一个展示对应驱动 所支持的FlexVolume能力的map，现在只包含一个必填字段attach，用于表明本驱动是否需要attach和 detach操作。为向后兼容该字段一般默认值设为true。</td></tr><tr><td>Attach</td><td>attach</td><td>将给定<code>规格的卷添加到给定的主机上</code>。若调用成功则返回存储设备添加到该主机的路径。 Kubelet和 Controller-Manager都需要调用该方法。</td></tr><tr><td>Detach</td><td>detach</td><td><code>卸载给定主机上的指定卷</code>。 Kubelet和Controller-Manager都需要调用该方法。</td></tr><tr><td>Wait for attach</td><td>waitforattach</td><td>等待卷被添加到远程节点。若调用成功则将返回设备路径。 Kubelet和Controller-Manager都需要调用该方 法。</td></tr><tr><td>Volume is Attached</td><td>isattached</td><td>检查卷是否已被添加到节点上。 Kubelet和Controller-Manager都需要调用该方法。</td></tr><tr><td>Mount device</td><td>mountdevice</td><td>将存储设备挂载到一个将被pod使用的全局路径上。 Kubelet需要调用该方法。</td></tr><tr><td>Unmount device</td><td>unmountdevice</td><td>将存储设备卸载。 This is called once all bind mounts have been unmounted. Kubelet需要调用该方法。</td></tr><tr><td>Mount</td><td>mount</td><td>将卷挂载到指定目录。 Kubelet需要调用该方法。</td></tr><tr><td>Unmount</td><td>unmount</td><td>将卷进行卸载。 Kubelet需要调用该方法。</td></tr></tbody></table><h3 id=k8s-csi存储扩展机制>K8S CSI存储扩展机制</h3><h4 id=相关术语>相关术语</h4><table><thead><tr><th>术语</th><th>含义</th></tr></thead><tbody><tr><td>CO</td><td><code>容器编排系统（Container Orchestrator），使用CSI gRPC服务来与插件通信</code></td></tr><tr><td>RPC</td><td>远程方法调用（Remote Procedure Call）</td></tr><tr><td>Plugin</td><td><code>插件实现，实现CSI服务的gRPC访问端点</code></td></tr><tr><td>SP</td><td><code>存储提供商（Storage Provider），负责提供CSI插件实现</code></td></tr><tr><td>Volume</td><td>卷， CO管理的容器可使用的存储单元</td></tr><tr><td>Block Volume</td><td>块设备卷</td></tr><tr><td>Mounted Volume</td><td>使用指定文件系统挂载到容器的卷，并显示为容器内的一个目录</td></tr><tr><td>Workload</td><td>工作负载，是CO任务调度的基本单元，可以是一个或一组容器</td></tr><tr><td>Node</td><td>用户运行工作负载的主机，从插件的角度通过节点 ID来进行唯一标识</td></tr><tr><td>In-Tree</td><td>内置的，存在于K8S核心代码仓库内的代码</td></tr><tr><td>Out-Of-Tree</td><td>外置的，存在于K8S核心代码仓库外的代码</td></tr><tr><td><code>CSI Volume Plugin</code></td><td>一个新的内置卷插件，<code>作为一个适配器来使得外置的第三方CSI卷驱动可以被K8S所使用</code></td></tr><tr><td><code>CSI Volume Driver</code></td><td>一个外置的<code>CSI兼容的卷插件驱动，可通过K8S卷插件被K8S所使用</code></td></tr></tbody></table><h4 id=优势>优势</h4><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMuAYLgxAAPBh01e6ho175.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMuAYLgxAAPBh01e6ho175.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMuAYLgxAAPBh01e6ho175.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMuAYLgxAAPBh01e6ho175.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMuAYLgxAAPBh01e6ho175.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YMuAYLgxAAPBh01e6ho175.png></p><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM6AYc2MAAOZ2lzpExk611.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM6AYc2MAAOZ2lzpExk611.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM6AYc2MAAOZ2lzpExk611.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM6AYc2MAAOZ2lzpExk611.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM6AYc2MAAOZ2lzpExk611.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM6AYc2MAAOZ2lzpExk611.png></p><h3 id=csi通用架构>CSI通用架构</h3><blockquote><p>CO通过gRPC与插件交互，每个SP必须实现以下两个plugin：
• Node Plugin： 需要<code>运行在使用Volume的Node上</code>，主要负责V<code>olume Mount/Unmount等操作</code>
• Controller Plugin：可以<code>运行在任何节点</code>上，主要负责<code>Volume Creation/Deletion、 Attach/Detach等操作</code></p></blockquote><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM-AZl2pAAGOv1eyoAM156.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM-AZl2pAAGOv1eyoAM156.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM-AZl2pAAGOv1eyoAM156.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM-AZl2pAAGOv1eyoAM156.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM-AZl2pAAGOv1eyoAM156.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YM-AZl2pAAGOv1eyoAM156.png></p><h4 id=co与plugin的交互过程>CO与Plugin的交互过程</h4><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNGAXx2hAAJgsrqp3tI355.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNGAXx2hAAJgsrqp3tI355.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNGAXx2hAAJgsrqp3tI355.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNGAXx2hAAJgsrqp3tI355.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNGAXx2hAAJgsrqp3tI355.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNGAXx2hAAJgsrqp3tI355.png></p><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNOAT6hLAAMXkmm6Yd4767.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNOAT6hLAAMXkmm6Yd4767.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNOAT6hLAAMXkmm6Yd4767.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNOAT6hLAAMXkmm6Yd4767.png 2x" data-sizes=auto alt=img title=img></p><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNWAV8XtAAKAk8WL-NM148.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNWAV8XtAAKAk8WL-NM148.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNWAV8XtAAKAk8WL-NM148.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNWAV8XtAAKAk8WL-NM148.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNWAV8XtAAKAk8WL-NM148.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNWAV8XtAAKAk8WL-NM148.png></p><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNaAa6uwAAJWvv4dhwk488.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNaAa6uwAAJWvv4dhwk488.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNaAa6uwAAJWvv4dhwk488.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNaAa6uwAAJWvv4dhwk488.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNaAa6uwAAJWvv4dhwk488.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNaAa6uwAAJWvv4dhwk488.png></p><h4 id=卷生命周期>卷生命周期</h4><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNeABj33AADssTtyNGc569.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNeABj33AADssTtyNGc569.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNeABj33AADssTtyNGc569.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YNeABj33AADssTtyNGc569.png 2x" data-sizes=auto alt=img title=img></p><h3 id=rpc-接口集合>RPC 接口集合</h3><ul><li>Identity Service： Node Plugin和Controller Plugin都需要实现的RPC集合，<ul><li>身份服务RPC允许CO查询插件的功能，健康状况和其他元数据。</li></ul></li><li>Controller Service： Controller Plugin需要实现的RPC集合<ul><li>控制服务RPC提供卷的<code>创建、删除、 Attach、 Detach、查询</code>等功能，以及<code>卷快照的创建、删除、查询</code>等功能</li></ul></li><li>Node Service： Node Plugin需要实现的RPC集合<ul><li>将卷mount 到制定全局路径，在NodePublishVolume之前，每个卷/节点执行一次</li><li>将卷从指定全局路径umount</li><li>将卷从制定的全局路径mount到目标路径，在NodePublishVolume之前，每个卷/节点执行一次</li><li>将卷从指定目标路径unmount</li></ul></li></ul><h2 id=k8s-csi架构>K8S CSI架构</h2><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YN-ADt2aAAP1iSVfOCM122.png data-srcset="https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YN-ADt2aAAP1iSVfOCM122.png, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YN-ADt2aAAP1iSVfOCM122.png 1.5x, https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YN-ADt2aAAP1iSVfOCM122.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YN-ADt2aAAP1iSVfOCM122.png title=https://gitee.com/github-25970295/blogimgv2022/raw/master/rBAADF80YN-ADt2aAAP1iSVfOCM122.png></p><p>为了部署一个容器化的第三方CSI volume driver，存储提供商需要执行如下操作：</p><ol><li>创建一个实现CSI规范描述的插件功能，并通过Unix套接字来暴露gPRC访问接口的”CSI volume driver” 容器；</li><li>结合使用K8S团队提供的帮助容器来部署CSI volume driver，具体需要创建如下两类K8S对象：<ol><li>StatefulSet：用于与K8S控制器进行交互，实例数1，包含3个容器（ CSI volume driver、 external-attacher 、 external provisioner ），需要挂载一个挂载点为/var/lib/csi/sockets/pluginproxy/的emptyDir volume</li><li>DaemonSet ：包含2个容器（ CSI volumedriver、 K8S CSI Helper），挂载3个hostpath volume</li></ol></li><li>集群管理员为存储系统在K8S集群中部署上述StatefulSet和DaemonSet</li></ol></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2023-09-24 17:00:04">更新于 2023-09-24&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=liudongdong1.github.io/kubernetes_%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span><span><a href=https://liudongdong1.github.io/edit/master/content/posts%5c%e5%ad%98%e5%82%a8%e8%ae%be%e8%ae%a1%5c%e8%99%9a%e6%8b%9f%e5%8c%96%e6%8a%80%e6%9c%af%5cKubernetes_%e5%ad%98%e5%82%a8%e4%bb%8b%e7%bb%8d.md title=编辑此页 target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>编辑此页</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=liudongdong1.github.io/kubernetes_%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D/ data-title=Kubernetes-存储介绍 data-hashtags=Storage><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=liudongdong1.github.io/kubernetes_%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D/ data-hashtag=Storage><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=liudongdong1.github.io/kubernetes_%E5%AD%98%E5%82%A8%E4%BB%8B%E7%BB%8D/ data-title=Kubernetes-存储介绍 data-image=https://cdn.pixabay.com/photo/2021/08/25/05/01/boat-6572384__340.jpg><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=liudongdong1.github.io/tags/storage/>Storage</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=liudongdong1.github.io/>主页</a></span></section></div><div class=post-nav><a href=liudongdong1.github.io/kubernets%E4%BB%8B%E7%BB%8D/ class=prev rel=prev title=Kubernetes-介绍><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Kubernetes-介绍</a>
<a href=liudongdong1.github.io/kubernetes_%E5%AD%98%E5%82%A8nfs%E5%AE%9E%E8%B7%B5/ class=next rel=next title=Kubernetes-存储NFS实践>Kubernetes-存储NFS实践<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line powered">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.118.2">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.17-RC"><img class=fixit-icon src=/liudongdong1.github.io/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2020 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=https://liudongdong1.github.io/ target=_blank rel="external nofollow noopener noreferrer">LiuDongdong</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class=site-time title='网站运行中 ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i>&nbsp;<span class=run-times>网站运行中 ...</span></span></div><div class="footer-line ibruce"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><a href=https://liudongdong1.github.io/ title="在 GitHub 上查看源代码" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#0076ff;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/liudongdong1.github.io/lib/katex/katex.min.css><link rel=stylesheet href=/liudongdong1.github.io/lib/cookieconsent/cookieconsent.min.css><script src=/liudongdong1.github.io/lib/autocomplete/autocomplete.min.js defer></script><script src=/liudongdong1.github.io/lib/algoliasearch/algoliasearch-lite.umd.min.js defer></script><script src=/liudongdong1.github.io/lib/lazysizes/lazysizes.min.js async defer></script><script src=/liudongdong1.github.io/lib/sharer/sharer.min.js async defer></script><script src=/liudongdong1.github.io/lib/typeit/index.umd.js defer></script><script src=/liudongdong1.github.io/lib/katex/katex.min.js defer></script><script src=/liudongdong1.github.io/lib/katex/auto-render.min.js defer></script><script src=/liudongdong1.github.io/lib/katex/copy-tex.min.js defer></script><script src=/liudongdong1.github.io/lib/katex/mhchem.min.js defer></script><script src=/liudongdong1.github.io/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/liudongdong1.github.io/lib/pangu/pangu.min.js defer></script><script src=/liudongdong1.github.io/lib/cell-watermark/watermark.min.js defer></script><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},data:{"typeit-header-subtitle-desktop":`<span style='font-family: MMT,"沐目体";'>吾日三省吾身</span>`,"typeit-header-subtitle-mobile":`<span style='font-family: MMT,"沐目体";'>吾日三省吾身</span>`},enablePWA:!0,enablePangu:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"2R1K9SKLQZ",algoliaIndex:"index.zh-cn",algoliaSearchKey:"4a226aa1c5c98d6859e4d1386adb2bc7",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"algolia"},siteTime:"2020-12-18T16:15:22+08:00",typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"typeit-header-subtitle-desktop":["typeit-header-subtitle-desktop"],"typeit-header-subtitle-mobile":["typeit-header-subtitle-mobile"]},duration:-1,speed:100},watermark:{appendto:".wrapper>main",colspacing:30,content:'<img class="fixit-icon" src="/fixit.min.svg" alt="FixIt logo" /> FixIt 主题',enable:!0,fontfamily:"inherit",fontsize:.85,height:21,opacity:.0125,rotate:15,rowspacing:60,width:150}}</script><script src=/liudongdong1.github.io/js/theme.min.js defer></script><script src=/liudongdong1.github.io/js/custom.min.js defer></script></body></html>