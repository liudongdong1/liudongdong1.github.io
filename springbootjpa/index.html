<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>springbootJPA - DAY By DAY</title><meta name=author content="LiuDongdong"><meta name=author-link content="https://liudongdong1.github.io/"><meta name=description content="SpringData：其实SpringData就是Spring提供了一个操作数据的框架。而SpringData JPA只是SpringData"><meta name=keywords content="Java,SpringBoot,database,Framework"><meta itemprop=name content="springbootJPA"><meta itemprop=description content="SpringData：其实SpringData就是Spring提供了一个操作数据的框架。而SpringData JPA只是SpringData"><meta itemprop=datePublished content="2021-06-10T21:31:56+00:00"><meta itemprop=dateModified content="2023-09-28T22:56:31+08:00"><meta itemprop=wordCount content="3149"><meta itemprop=image content="/logo.png"><meta itemprop=keywords content="Java,SpringBoot,database,Framework,"><meta property="og:title" content="springbootJPA"><meta property="og:description" content="SpringData：其实SpringData就是Spring提供了一个操作数据的框架。而SpringData JPA只是SpringData"><meta property="og:type" content="article"><meta property="og:url" content="liudongdong1.github.io/springbootjpa/"><meta property="og:image" content="/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-06-10T21:31:56+00:00"><meta property="article:modified_time" content="2023-09-28T22:56:31+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo.png"><meta name=twitter:title content="springbootJPA"><meta name=twitter:description content="SpringData：其实SpringData就是Spring提供了一个操作数据的框架。而SpringData JPA只是SpringData"><meta name=application-name content="DAY By DAY"><meta name=apple-mobile-web-app-title content="DAY By DAY"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=liudongdong1.github.io/springbootjpa/><link rel=prev href=liudongdong1.github.io/3dposerelative/><link rel=next href=liudongdong1.github.io/hutoollearning/><link rel=stylesheet href=/liudongdong1.github.io/css/style.min.css><link rel=stylesheet href=/liudongdong1.github.io/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/liudongdong1.github.io/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"springbootJPA","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"liudongdong1.github.io\/springbootjpa\/"},"genre":"posts","keywords":"Java, SpringBoot, database, Framework","wordcount":3149,"url":"liudongdong1.github.io\/springbootjpa\/","datePublished":"2021-06-10T21:31:56+00:00","dateModified":"2023-09-28T22:56:31+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"LiuDongdong","logo":"\/images\/person.png"},"author":{"@type":"Person","name":"liudongdong1"},"description":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=liudongdong1.github.io/ title="DAY By DAY"><img class="lazyload logo" src=/liudongdong1.github.io/svg/loading.min.svg data-src=/fixit.min.svg data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x" data-sizes=auto alt="DAY By DAY" title="DAY By DAY"><span class=header-title-text></span></a><span id=typeit-header-subtitle-desktop class="typeit header-subtitle"></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/friends/ title=友情链接><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item>没有更多翻译</li></ul></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=liudongdong1.github.io/ title="DAY By DAY"><img class="lazyload logo" src=/liudongdong1.github.io/svg/loading.min.svg data-src=/fixit.min.svg data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x" data-sizes=auto alt=/fixit.min.svg title=/fixit.min.svg><span class=header-title-text></span></a><span id=typeit-header-subtitle-mobile class="typeit header-subtitle"></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/friends/ title=友情链接><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item text-center"><a class=menu-link href=https://liudongdong1.github.io/ title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw' aria-hidden=true></i></a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option disabled>没有更多翻译</option></select></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container data-page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>目录 <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom id=aside-sakana><div class=sakana-widget><div class=sakana-item id=takina-widget></div><div class=sakana-item id=chisato-widget></div></div><script>function initSakanaWidget(){const e=SakanaWidget.getCharacter("takina");SakanaWidget.registerCharacter("takina-slow",e),new SakanaWidget({character:"takina-slow",controls:!1,autoFit:!0,stroke:{color:"#b4b4b4",width:2}}).mount("#takina-widget");const t=SakanaWidget.getCharacter("chisato");SakanaWidget.registerCharacter("chisato-slow",t),new SakanaWidget({character:"chisato-slow",controls:!1,autoFit:!0,stroke:{color:"#b4b4b4",width:2}}).mount("#chisato-widget")}</script><script async onload=initSakanaWidget() src=https://cdn.jsdelivr.net/npm/sakana-widget@2.3.0/lib/sakana.min.js></script></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>springbootJPA</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
liudongdong1</span></span>
<span class=post-category>收录于 <a href=liudongdong1.github.io/categories/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;Categories</a>&ensp;<a href=liudongdong1.github.io/categories/framework/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;Framework</a></span></div><div class=post-meta-line><span title="2021-06-10 21:31:56"><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-06-10>2021-06-10</time>
</span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;约 3149 字&nbsp;
<i class="fa-regular fa-clock fa-fw"></i>&nbsp;预计阅读 7 分钟&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title=springbootJPA>
<i class="fa-regular fa-eye fa-fw"></i>&nbsp;<span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class=featured-image><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://cdn.pixabay.com/photo/2021/05/01/09/59/city-6220689__340.jpg data-srcset="https://cdn.pixabay.com/photo/2021/05/01/09/59/city-6220689__340.jpg, https://cdn.pixabay.com/photo/2021/05/01/09/59/city-6220689__340.jpg 1.5x, https://cdn.pixabay.com/photo/2021/05/01/09/59/city-6220689__340.jpg 2x" data-sizes=auto alt=https://cdn.pixabay.com/photo/2021/05/01/09/59/city-6220689__340.jpg title=https://cdn.pixabay.com/photo/2021/05/01/09/59/city-6220689__340.jpg></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li></li></ul></li></ul></nav></div></div><div class=content id=content><blockquote><p>SpringData：其实SpringData就是Spring提供了一个<code>操作数据的框架</code>。而<code>SpringData JPA只是SpringData框架下的一个基于JPA标准操作数据的模块</code>。
SpringData JPA：基于<code>JPA的标准数据进行操作。简化操作持久层的代码。只需要编写接口就可以。</code></p><p>JPA是Spring Data下的子项目,JPA是Java Persistence API的简称，中文名为Java持久层API，是JDK 5.0注解或XML描述对象－关系表的映射关系，并将运行期的实体对象持久化到数据库中.</p></blockquote><h4 id=1-环境使用>1. 环境使用</h4><ul><li>导入jar包</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;groupId&gt;</span>org.springframework.boot<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/dependency&gt;</span>
</span></span></code></pre></div><ul><li>yml配置文件</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>spring</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>datasource</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>jdbc:mysql://localhost:3306/mytest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>com.alibaba.druid.pool.DruidDataSource</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>username</span>: <span style=color:#ae81ff>root</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>password</span>: <span style=color:#ae81ff>root</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>driver-class-name</span>: <span style=color:#ae81ff>com.mysql.jdbc.Driver //驱动</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>jpa</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>hibernate</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>ddl-auto</span>: <span style=color:#ae81ff>update //自动更新</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>show-sql</span>: <span style=color:#66d9ef>true</span>  <span style=color:#ae81ff>//日志中显示sql语句</span>
</span></span></code></pre></div><ul><li>application.properties</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#项目端口的常用配置</span>
</span></span><span style=display:flex><span>server<span style=color:#f92672>.</span>port<span style=color:#f92672>=</span><span style=color:#ae81ff>8081</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 数据库连接的配置</span>
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>datasource<span style=color:#f92672>.</span>url<span style=color:#f92672>=</span>jdbc:mysql:<span style=color:#f92672>///</span>jpa<span style=color:#960050;background-color:#1e0010>?</span>useSSL<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>datasource<span style=color:#f92672>.</span>username<span style=color:#f92672>=</span>root
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>datasource<span style=color:#f92672>.</span>password<span style=color:#f92672>=</span>zempty123
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>datasource<span style=color:#f92672>.</span>driver<span style=color:#f92672>-</span>class<span style=color:#f92672>-</span>name<span style=color:#f92672>=</span>com<span style=color:#f92672>.</span>mysql<span style=color:#f92672>.</span>cj<span style=color:#f92672>.</span>jdbc<span style=color:#f92672>.</span>Driver
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#数据库连接池的配置，hikari 连接池的配置</span>
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>datasource<span style=color:#f92672>.</span>hikari<span style=color:#f92672>.</span>idle<span style=color:#f92672>-</span>timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>30000</span>
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>datasource<span style=color:#f92672>.</span>hikari<span style=color:#f92672>.</span>connection<span style=color:#f92672>-</span>timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>10000</span>
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>datasource<span style=color:#f92672>.</span>hikari<span style=color:#f92672>.</span>maximum<span style=color:#f92672>-</span>pool<span style=color:#f92672>-</span>size<span style=color:#f92672>=</span><span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>datasource<span style=color:#f92672>.</span>hikari<span style=color:#f92672>.</span>minimum<span style=color:#f92672>-</span>idle<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>datasource<span style=color:#f92672>.</span>hikari<span style=color:#f92672>.</span>auto<span style=color:#f92672>-</span>commit<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#通过 jpa 自动生成数据库中的表</span>
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>jpa<span style=color:#f92672>.</span>hibernate<span style=color:#f92672>.</span>ddl<span style=color:#f92672>-</span>auto<span style=color:#f92672>=</span>update   <span style=color:#75715e>#这里 update操作注意</span>
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>jpa<span style=color:#f92672>.</span>show<span style=color:#f92672>-</span>sql<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>spring<span style=color:#f92672>.</span>jpa<span style=color:#f92672>.</span>properties<span style=color:#f92672>.</span>hibernate<span style=color:#f92672>.</span>dialect<span style=color:#f92672>=</span>org<span style=color:#f92672>.</span>hibernate<span style=color:#f92672>.</span>dialect<span style=color:#f92672>.</span>MySQL5InnoDBDialect
</span></span></code></pre></div><blockquote><p><code>jpa:hibernate:ddl-auto: update</code>是hibernate的配置属性，其主要作用是：<code>自动创建、更新、验证数据库表结构</code>。该参数的几种配置如下：
1.·create：<code>每次加载hibernate时都会删除上一次的生成的表，然后根据你的model类再重新来生成新表</code>，哪怕两次没有任何改变也要这样执行，这就是导致数据库表数据丢失的一个重要原因。
2.·create-drop：<code>每次加载hibernate时根据model类生成表，但是sessionFactory一关闭,表就自动删除。</code>
3.·update：最常用的属性，第一次加载hibernate时根据model类会自动建立起表的结构<code>（前提是先建立好数据库</code>），以后加载hibernate时根据model类自动更新表结构，即使表结构改变了但表中的行仍然存在不会删除以前的行。要注意的是当部署到服务器后，表结构是不会被马上建立起来的，是要等应用第一次运行起来后才会。
4.·validate：<code>每次加载hibernate时，验证创建数据库表结构，只会和数据库中的表进行比较，不会创建新表，但是会插入新值。</code></p><ul><li><strong>初次创建时会设为create,创建好后改为validate.</strong></li></ul></blockquote><h4 id=2-实体类>2. 实体类</h4><blockquote><p>具体参考annotation_JPA, annotation_Lombok进行使用</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Entity</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Getter</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Setter</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Table</span><span style=color:#f92672>(</span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;person&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Person</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Id</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@GeneratedValue</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Long id<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Column</span><span style=color:#f92672>(</span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;name&#34;</span><span style=color:#f92672>,</span> length <span style=color:#f92672>=</span> 20<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Column</span><span style=color:#f92672>(</span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;agee&#34;</span><span style=color:#f92672>,</span> length <span style=color:#f92672>=</span> 4<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> age<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=3-repository接口>3. Repository接口</h4><blockquote><p>这里主要负责数据库的增删查改操作</p></blockquote><h5 id=1-简单查询>.1. 简单查询</h5><ul><li>基本查询也分为两种，一种是<code>spring data默认已经实现</code>，一种是<code>根据查询的方法来自动解析成SQL</code>。若只是简单的对单表进行crud只需要继承JpaRepository接口,传递了两个参数<code>:1.实体类,2.实体类中主键类型</code></li><li>要的语法是<code>findXXBy</code>,<code>readAXXBy</code>,<code>queryXXBy</code>,<code>countXXBy</code>, <code>getXXBy</code>后面跟属性名称：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>package</span> com.yizhu.repository<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> com.yizhu <span style=color:#f92672>.</span><span style=color:#a6e22e>entity</span><span style=color:#f92672>.</span><span style=color:#a6e22e>User</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.data.jpa.repository.EntityGraph<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.data.jpa.repository.JpaRepository<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.data.jpa.repository.JpaSpecificationExecutor<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.data.jpa.repository.Query<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.data.repository.query.Param<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.List<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>UserRepository</span> <span style=color:#66d9ef>extends</span> JpaRepository<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>,</span> Long<span style=color:#f92672>&gt;{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 根据年龄查询用户信息
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param age
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findAllByAge</span><span style=color:#f92672>(</span>Integer age<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 查询所有用户信息
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span>value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;from User u&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findAll</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>     <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 根据年龄查询用户信息
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param age
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span>value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;select * from t_user u where u.user_age = ?1&#34;</span><span style=color:#f92672>,</span> nativeQuery <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findAllByAge</span><span style=color:#f92672>(</span>Integer age<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 根据用户性别和所属组织名称查询用户信息
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param userSex
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param orgName
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span>value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;select u from User u left join u.org o where u.userSex = :userSex and o.orgName = :orgName&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findUsersBySexAndOrg</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;userSex&#34;</span><span style=color:#f92672>)</span> Integer userSex<span style=color:#f92672>,</span> <span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;orgName&#34;</span><span style=color:#f92672>)</span> String orgName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 根据用户性别和所属组织名称查询用户信息
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param userSex
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param orgName
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findBySexAndOrg</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;sex&#34;</span><span style=color:#f92672>)</span> Integer sex<span style=color:#f92672>,</span> <span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;name&#34;</span><span style=color:#f92672>)</span> String name<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * 根据用户名模糊查询
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @return
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findAllByNameLike</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;name&#34;</span><span style=color:#f92672>)</span> String name<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><blockquote><p><strong>CrudRepository 中的save方法是相当于merge+save ，它会先判断记录是否存在，如果存在则更新，不存在则插入记录</strong></p></blockquote><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogpictureV2/raw/master/JpaRepository.png data-srcset="https://gitee.com/github-25970295/blogpictureV2/raw/master/JpaRepository.png, https://gitee.com/github-25970295/blogpictureV2/raw/master/JpaRepository.png 1.5x, https://gitee.com/github-25970295/blogpictureV2/raw/master/JpaRepository.png 2x" data-sizes=auto alt=JpaRepository title=JpaRepository></p><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogpictureV2/raw/master/image-20210619103608467.png data-srcset="https://gitee.com/github-25970295/blogpictureV2/raw/master/image-20210619103608467.png, https://gitee.com/github-25970295/blogpictureV2/raw/master/image-20210619103608467.png 1.5x, https://gitee.com/github-25970295/blogpictureV2/raw/master/image-20210619103608467.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogpictureV2/raw/master/image-20210619103608467.png title=https://gitee.com/github-25970295/blogpictureV2/raw/master/image-20210619103608467.png></p><h6 id=2-分页查询>.2. 分页查询</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>public void testPageQuery() throws <span style=color:#a6e22e>Exception</span> {
</span></span><span style=display:flex><span>	int page<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,size<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>	Sort sort <span style=color:#f92672>=</span> new Sort(Direction<span style=color:#f92672>.</span>DESC, <span style=color:#e6db74>&#34;id&#34;</span>);
</span></span><span style=display:flex><span>    Pageable pageable <span style=color:#f92672>=</span> new PageRequest(page, size, sort);
</span></span><span style=display:flex><span>    userRepository<span style=color:#f92672>.</span>findALL(pageable);
</span></span><span style=display:flex><span>    userRepository<span style=color:#f92672>.</span>findByUserName(<span style=color:#e6db74>&#34;testName&#34;</span>, pageable);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h6 id=3-query注解自定义查询sql>.3. <code>@Query</code>注解自定义查询sql</h6><blockquote><ol><li>JPQL 形式的 sql 语句，from 后面是以类名呈现的。</li><li>原生的 sql 语句，需要使用 nativeQuery = true 指定使用原生 sql</li></ol></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Modifying</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;update User u set u.userName = ?1 where u.id = ?2&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>modifyByIdAndUserId</span><span style=color:#f92672>(</span>String  userName<span style=color:#f92672>,</span> Long id<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Transactional</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Modifying</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;delete from User where id = ?1&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>deleteByUserId</span><span style=color:#f92672>(</span>Long id<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Transactional</span><span style=color:#f92672>(</span>timeout <span style=color:#f92672>=</span> 10<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;select u from User u where u.emailAddress = ?1&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>User <span style=color:#a6e22e>findByEmailAddress</span><span style=color:#f92672>(</span>String emailAddress<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span>value<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;select o from UserModel o where o.name like %:nn&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> List<span style=color:#f92672>&lt;</span>UserModel<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findByUuidOrAge</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;nn&#34;</span><span style=color:#f92672>)</span> String name<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//使用的 JPQL 的 sql 形式 from 后面是类名
</span></span></span><span style=display:flex><span><span style=color:#75715e>// ?1 代表是的是方法中的第一个参数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;select s from ClassRoom s where s.name =?1&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>ClassRoom<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findClassRoom1</span><span style=color:#f92672>(</span>String name<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//这是使用正常的 sql 语句去查询
</span></span></span><span style=display:flex><span><span style=color:#75715e>// :name 是通过 @Param 注解去确定的
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span>nativeQuery <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>,</span>value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;select * from class_room c where c.name =:name&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>ClassRoom<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findClassRoom2</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;name&#34;</span><span style=color:#f92672>)</span>String name<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;select t from Teacher t where t.subject = :subject&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Page<span style=color:#f92672>&lt;</span>Teacher<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getPage</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;subject&#34;</span><span style=color:#f92672>)</span> String subject<span style=color:#f92672>,</span> Pageable pageable<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//更新类的query语句
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Transactional</span><span style=color:#f92672>(</span>timeout <span style=color:#f92672>=</span> 10<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Modifying</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span>value<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;update UserModel o set o.name=:newName where o.name like %:nn&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>findByUuidOrAge</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;nn&#34;</span><span style=color:#f92672>)</span> String name<span style=color:#f92672>,</span><span style=color:#a6e22e>@Param</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;newName&#34;</span><span style=color:#f92672>)</span> String newName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//删除类语句
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Transactional</span><span style=color:#f92672>(</span>timeout <span style=color:#f92672>=</span> 10<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span>value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;delete from r_upa where user_id= ?1 and point_indecs_id in (?2)&#34;</span><span style=color:#f92672>,</span> nativeQuery <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Modifying</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>deleteByUserAndPointIndecs</span><span style=color:#f92672>(</span>Long uid<span style=color:#f92672>,</span> List<span style=color:#f92672>&lt;</span>Long<span style=color:#f92672>&gt;</span> hids<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//多表查询   一般新建临时类，用于存储查询结果，但不存储数据库
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;select h.city as city, h.name as name, avg(r.rating) as averageRating &#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>-</span> <span style=color:#e6db74>&#34;from Hotel h left outer join h.reviews r where h.city = ?1 group by h&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Page<span style=color:#f92672>&lt;</span>HotelSummary<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findByCity</span><span style=color:#f92672>(</span>City city<span style=color:#f92672>,</span> Pageable pageable<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;select h.name as name, avg(r.rating) as averageRating &#34;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>-</span> <span style=color:#e6db74>&#34;from Hotel h left outer join h.reviews r  group by h&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Page<span style=color:#f92672>&lt;</span>HotelSummary<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findByCity</span><span style=color:#f92672>(</span>Pageable pageable<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Page<span style=color:#f92672>&lt;</span>HotelSummary<span style=color:#f92672>&gt;</span> hotels <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>hotelRepository</span><span style=color:#f92672>.</span><span style=color:#a6e22e>findByCity</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> PageRequest<span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 10<span style=color:#f92672>,</span> Direction<span style=color:#f92672>.</span><span style=color:#a6e22e>ASC</span><span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;name&#34;</span><span style=color:#f92672>));</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span><span style=color:#f92672>(</span>HotelSummary summay<span style=color:#f92672>:</span>hotels<span style=color:#f92672>){</span>
</span></span><span style=display:flex><span>		System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Name&#34;</span> <span style=color:#f92672>+</span>summay<span style=color:#f92672>.</span><span style=color:#a6e22e>getName</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span></code></pre></div><blockquote><ul><li>直接可以使用delete(id),依据id来删除一条数据</li><li>也可以使用deleteByName(String name)时，需要添加@Transactional注解，才能使用</li><li>Spring Data JPA的deleteByXXXX，是先select，在整个Transaction完了之后才执行delete</li></ul></blockquote><h6 id=3-examples-查询>.3. Example 查询</h6><blockquote><p>按例查询（QBE）是一种用户界面友好的查询技术。 它允许动态创建查询，并且不需要编写包含字段名称的查询。 实际上，按示例查询不需要使用特定的数据库的查询语言来编写查询语句。</p><ol><li>Probe: 含有对应字段的实例对象。</li><li>ExampleMatcher：ExampleMatcher携带有关如何匹配特定字段的详细信息，相当于匹配条件。</li><li>Example：由Probe和ExampleMatcher组成，用于查询。</li></ol></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>//根据用户名精确查询
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>test7</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 根据用户名精确查询
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        User user <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        user<span style=color:#f92672>.</span><span style=color:#a6e22e>setUsername</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;张三&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        Example<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> example <span style=color:#f92672>=</span> Example<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>user<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userDao<span style=color:#f92672>.</span><span style=color:#a6e22e>findAll</span><span style=color:#f92672>(</span>example<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>User u <span style=color:#f92672>:</span> users<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>u<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//查询用户名为张开头的用户
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>test8</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 查询用户名为张开头的用户
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        User user <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        user<span style=color:#f92672>.</span><span style=color:#a6e22e>setUsername</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;张&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        ExampleMatcher matcher <span style=color:#f92672>=</span> ExampleMatcher<span style=color:#f92672>.</span><span style=color:#a6e22e>matching</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>.</span><span style=color:#a6e22e>withMatcher</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;username&#34;</span><span style=color:#f92672>,</span>GenericPropertyMatchers<span style=color:#f92672>.</span><span style=color:#a6e22e>startsWith</span><span style=color:#f92672>());</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//                .withMatcher()   还可以添加多个条件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        Example<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> example <span style=color:#f92672>=</span> Example<span style=color:#f92672>.</span><span style=color:#a6e22e>of</span><span style=color:#f92672>(</span>user<span style=color:#f92672>,</span>matcher<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userDao<span style=color:#f92672>.</span><span style=color:#a6e22e>findAll</span><span style=color:#f92672>(</span>example<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span>User u <span style=color:#f92672>:</span> users<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>u<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><ul><li><code>ExampleMatcher.matching()</code> :默认是返回满足全部条件的用户</li><li><code>ExampleMatcher.matchingAny()</code> :只要有一个条件满足即可</li><li><code>GenericPropertyMatchers.startsWith()</code> : 匹配开头 等价于 like 张%</li><li><code>GenericPropertyMatchers.contains()</code> : 匹配中间 等价于 like %张%</li><li><code>GenericPropertyMatchers.endsWith()</code> : 匹配结尾 等价于 like %张</li><li><code>GenericPropertyMatchers.ignoreCase(boolean b)</code> : 同时还能指定是否忽略大小写</li></ul><h5 id=4--复杂查询>.4. 复杂查询</h5><ul><li><strong>Specification</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>JpaSpecificationExecutor</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Optional<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findOne</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Nullable</span> Specification<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> var1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findAll</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Nullable</span> Specification<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> var1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    Page<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findAll</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Nullable</span> Specification<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> var1<span style=color:#f92672>,</span> Pageable var2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findAll</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Nullable</span> Specification<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> var1<span style=color:#f92672>,</span> Sort var2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>long</span> <span style=color:#a6e22e>count</span><span style=color:#f92672>(</span><span style=color:#a6e22e>@Nullable</span> Specification<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> var1<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TeacherRepositoty</span> <span style=color:#66d9ef>extends</span> JpaRepository<span style=color:#f92672>&lt;</span>Teacher<span style=color:#f92672>,</span>Integer<span style=color:#f92672>&gt;</span> <span style=color:#f92672>,</span> JpaSpecificationExecutor <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//Predicate toPredicate(Root&lt;T&gt; var1, CriteriaQuery&lt;?&gt; var2, CriteriaBuilder var3);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> <span style=color:#75715e>//实例化 Specification 类  @PathVariable(&#34;subject&#34;) String subject
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Specification specification <span style=color:#f92672>=</span> <span style=color:#f92672>((</span>root<span style=color:#f92672>,</span> criteriaQuery<span style=color:#f92672>,</span> criteriaBuilder<span style=color:#f92672>)</span> <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 构建查询条件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Predicate predicate <span style=color:#f92672>=</span> criteriaBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>equal</span><span style=color:#f92672>(</span>root<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;subject&#34;</span><span style=color:#f92672>),</span> subject<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 使用 and 连接上一个条件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    predicate <span style=color:#f92672>=</span> criteriaBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>and</span><span style=color:#f92672>(</span>predicate<span style=color:#f92672>,</span> criteriaBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>greaterThan</span><span style=color:#f92672>(</span>root<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;age&#34;</span><span style=color:#f92672>),</span> 21<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> predicate<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>});</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//使用查询
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>return</span> teacherRepositoty<span style=color:#f92672>.</span><span style=color:#a6e22e>findAll</span><span style=color:#f92672>(</span>specification<span style=color:#f92672>);</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>test10</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Specification<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> specification <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Specification<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>public</span> Predicate <span style=color:#a6e22e>toPredicate</span><span style=color:#f92672>(</span>Root<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> root<span style=color:#f92672>,</span> CriteriaQuery<span style=color:#f92672>&lt;?&gt;</span> criteriaQuery<span style=color:#f92672>,</span> CriteriaBuilder criteriaBuilder<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 获取比较的属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                Path<span style=color:#f92672>&lt;</span>Object<span style=color:#f92672>&gt;</span> username <span style=color:#f92672>=</span> root<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;username&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                Path<span style=color:#f92672>&lt;</span>Object<span style=color:#f92672>&gt;</span> password <span style=color:#f92672>=</span> root<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;password&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 构造查询条件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                Predicate p1 <span style=color:#f92672>=</span> criteriaBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>equal</span><span style=color:#f92672>(</span>username<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;张三&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                Predicate p2 <span style=color:#f92672>=</span> criteriaBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>equal</span><span style=color:#f92672>(</span>password<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;222&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 把条件组合到一起
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span> criteriaBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>and</span><span style=color:#f92672>(</span>p1<span style=color:#f92672>,</span>p2<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userDao<span style=color:#f92672>.</span><span style=color:#a6e22e>findAll</span><span style=color:#f92672>(</span>specification<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        users<span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>::</span>println<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//根据用户名进行模糊查询
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>test11</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        Specification<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> specification <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Specification<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>public</span> Predicate <span style=color:#a6e22e>toPredicate</span><span style=color:#f92672>(</span>Root<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> root<span style=color:#f92672>,</span> CriteriaQuery<span style=color:#f92672>&lt;?&gt;</span> criteriaQuery<span style=color:#f92672>,</span> CriteriaBuilder criteriaBuilder<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 获取比较的属性,并指定比较参数的类型String
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                Path<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> username <span style=color:#f92672>=</span> root<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;username&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 构造查询条件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                Predicate p1 <span style=color:#f92672>=</span> criteriaBuilder<span style=color:#f92672>.</span><span style=color:#a6e22e>like</span><span style=color:#f92672>(</span>username<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;张%&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 把条件组合到一起
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span> p1<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>};</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 根据id倒序排序
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        Sort sort <span style=color:#f92672>=</span> Sort<span style=color:#f92672>.</span><span style=color:#a6e22e>by</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;id&#34;</span><span style=color:#f92672>).</span><span style=color:#a6e22e>descending</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userDao<span style=color:#f92672>.</span><span style=color:#a6e22e>findAll</span><span style=color:#f92672>(</span>specification<span style=color:#f92672>,</span>sort<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        users<span style=color:#f92672>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f92672>(</span>System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>::</span>println<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    
</span></span></code></pre></div><blockquote><p>现在有这样的一条 sql 语句 ： <strong>select * from teacher where age > 20</strong></p><ol><li><code>Predicate</code> 是用来建立 <code>where 后的查寻条件的相当于上述sql语句的 age > 20。</code></li><li><code>Root 使用来定位具体的查询字段</code>，比如 <code>root.get(“age”) ,定位 age字段，</code></li><li><code>CriteriaBuilder</code>是用来构建一个字段的范围，相当于<code> > ,= ,&lt;，and …. 等等</code></li><li><code>CriteriaQuery </code>可以用来构建整个 sql 语句，可以<code>指定sql 语句中的 select 后的查询字段，也可以拼接 where ， groupby 和 having 等复杂语句。</code></li></ol></blockquote><ul><li><p>jpa + QueryDSL</p></li><li><p>Projection</p></li></ul><blockquote><p>有时候不需要返回所有字段的数据，我们只需要个别字段数据，这样使用 Projection 也是不错的选择,现在的需求是我只需要 Teacher 类对应的表 teacher 中的 name 和 age 的数据，其他数据不需要。 定义一个如下的接口：</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TeacherProjection</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    String <span style=color:#a6e22e>getName</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Integer <span style=color:#a6e22e>getAge</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Value</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;#{target.name +&#39; and age is&#39; + target.age}&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    String <span style=color:#a6e22e>getTotal</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TeacherRepositoty</span> <span style=color:#66d9ef>extends</span> JpaRepository<span style=color:#f92672>&lt;</span>Teacher<span style=color:#f92672>,</span>Integer<span style=color:#f92672>&gt;,</span> JpaSpecificationExecutor <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>// 返回 TeacherProjection 接口类型的数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>@Query</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;select t from Teacher t &#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>TeacherProjection<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>getTeacherNameAndAge</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><ul><li>测试案例</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@RunWith</span><span style=color:#f92672>(</span>SpringRunner<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@ContextConfiguration</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;file:src/main/webapp/WEB-INF/applicationContext.xml&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DaoTest</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>    CommonUserRepository commonUserRepository
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Test</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>testCrudRepository</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        User user <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User<span style=color:#f92672>(</span>username<span style=color:#f92672>:</span> <span style=color:#960050;background-color:#1e0010>&#39;</span>yitian<span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>,</span> nickname<span style=color:#f92672>:</span> <span style=color:#960050;background-color:#1e0010>&#39;</span>易天<span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>,</span> registerTime<span style=color:#f92672>:</span> LocalDateTime<span style=color:#f92672>.</span><span style=color:#a6e22e>now</span><span style=color:#f92672>())</span>
</span></span><span style=display:flex><span>        commonUserRepository<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>user<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=4-service>4. Service</h4><blockquote><p>这里主要负责复杂的业务处理</p></blockquote><h4 id=5--contoller>5. Contoller</h4><blockquote><p>这里主要负责url查询获取相应的结果</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@RestController</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@RequestMapping</span><span style=color:#f92672>(</span>value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;person&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PerconController</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> PersonRepository personRepository<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@PostMapping</span><span style=color:#f92672>(</span>path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;addPerson&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>addPerson</span><span style=color:#f92672>(</span>Person person<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        personRepository<span style=color:#f92672>.</span><span style=color:#a6e22e>save</span><span style=color:#f92672>(</span>person<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@DeleteMapping</span><span style=color:#f92672>(</span>path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;deletePerson&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>deletePerson</span><span style=color:#f92672>(</span>Long id<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        personRepository<span style=color:#f92672>.</span><span style=color:#a6e22e>delete</span><span style=color:#f92672>(</span>id<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h4 id=resouce>Resouce</h4><ul><li><a href=https://docs.spring.io/spring-data/data-jpa/docs/current/reference/html/#jpa.named-parameters target=_blank rel="external nofollow noopener noreferrer">https://docs.spring.io/spring-data/data-jpa/docs/current/reference/html/#jpa.named-parameters<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li><li><a href=https://blog.csdn.net/fly910905/article/details/78557110 target=_blank rel="external nofollow noopener noreferrer">https://blog.csdn.net/fly910905/article/details/78557110<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2023-09-28 22:56:31">更新于 2023-09-28&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=liudongdong1.github.io/springbootjpa/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span><span><a href=https://liudongdong1.github.io/edit/master/content/posts%5c%e6%a1%86%e6%9e%b6%e8%ae%be%e8%ae%a1%5cspringboot%5cspringbootJPA.md title=编辑此页 target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>编辑此页</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=liudongdong1.github.io/springbootjpa/ data-title=springbootJPA data-hashtags=Java,SpringBoot,database,Framework><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=liudongdong1.github.io/springbootjpa/ data-hashtag=Java><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=liudongdong1.github.io/springbootjpa/ data-title=springbootJPA data-image=https://cdn.pixabay.com/photo/2021/05/01/09/59/city-6220689__340.jpg><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=liudongdong1.github.io/tags/java/>Java</a>,&nbsp;<a href=liudongdong1.github.io/tags/springboot/>SpringBoot</a>,&nbsp;<a href=liudongdong1.github.io/tags/database/>Database</a>,&nbsp;<a href=liudongdong1.github.io/tags/framework/>Framework</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=liudongdong1.github.io/>主页</a></span></section></div><div class=post-nav><a href=liudongdong1.github.io/3dposerelative/ class=prev rel=prev title=3DPoseRelative><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>3DPoseRelative</a>
<a href=liudongdong1.github.io/hutoollearning/ class=next rel=next title=HutoolLearning>HutoolLearning<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line powered">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.118.2">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.17-RC"><img class=fixit-icon src=/liudongdong1.github.io/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2020 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=https://liudongdong1.github.io/ target=_blank rel="external nofollow noopener noreferrer">LiuDongdong</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class=site-time title='网站运行中 ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i>&nbsp;<span class=run-times>网站运行中 ...</span></span></div><div class="footer-line ibruce"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><a href=https://liudongdong1.github.io/ title="在 GitHub 上查看源代码" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#0076ff;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/liudongdong1.github.io/lib/katex/katex.min.css><link rel=stylesheet href=/liudongdong1.github.io/lib/cookieconsent/cookieconsent.min.css><script src=/liudongdong1.github.io/lib/autocomplete/autocomplete.min.js defer></script><script src=/liudongdong1.github.io/lib/algoliasearch/algoliasearch-lite.umd.min.js defer></script><script src=/liudongdong1.github.io/lib/lazysizes/lazysizes.min.js async defer></script><script src=/liudongdong1.github.io/lib/sharer/sharer.min.js async defer></script><script src=/liudongdong1.github.io/lib/typeit/index.umd.js defer></script><script src=/liudongdong1.github.io/lib/katex/katex.min.js defer></script><script src=/liudongdong1.github.io/lib/katex/auto-render.min.js defer></script><script src=/liudongdong1.github.io/lib/katex/copy-tex.min.js defer></script><script src=/liudongdong1.github.io/lib/katex/mhchem.min.js defer></script><script src=/liudongdong1.github.io/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/liudongdong1.github.io/lib/pangu/pangu.min.js defer></script><script src=/liudongdong1.github.io/lib/cell-watermark/watermark.min.js defer></script><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},data:{"typeit-header-subtitle-desktop":`<span style='font-family: MMT,"沐目体";'>吾日三省吾身</span>`,"typeit-header-subtitle-mobile":`<span style='font-family: MMT,"沐目体";'>吾日三省吾身</span>`},enablePWA:!0,enablePangu:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"2R1K9SKLQZ",algoliaIndex:"index.zh-cn",algoliaSearchKey:"4a226aa1c5c98d6859e4d1386adb2bc7",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"algolia"},siteTime:"2020-12-18T16:15:22+08:00",typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"typeit-header-subtitle-desktop":["typeit-header-subtitle-desktop"],"typeit-header-subtitle-mobile":["typeit-header-subtitle-mobile"]},duration:-1,speed:100},watermark:{appendto:".wrapper>main",colspacing:30,content:'<img class="fixit-icon" src="/fixit.min.svg" alt="FixIt logo" /> FixIt 主题',enable:!0,fontfamily:"inherit",fontsize:.85,height:21,opacity:.0125,rotate:15,rowspacing:60,width:150}}</script><script src=/liudongdong1.github.io/js/theme.min.js defer></script><script src=/liudongdong1.github.io/js/custom.min.js defer></script></body></html>