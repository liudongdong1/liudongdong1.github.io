<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>RPI Camera Monitor - DAY By DAY</title><meta name=author content="LiuDongdong"><meta name=author-link content="https://liudongdong1.github.io/"><meta name=description content="​ 由人盯着监视屏幕，人总有疲劳限度的。研究表明，监控操作人员盯着电视墙屏幕超过10分钟后将漏掉90%的视频信息。由于人工筛选数据的低效率和低"><meta name=keywords content="Software,AIOT"><meta itemprop=name content="RPI Camera Monitor"><meta itemprop=description content="​ 由人盯着监视屏幕，人总有疲劳限度的。研究表明，监控操作人员盯着电视墙屏幕超过10分钟后将漏掉90%的视频信息。由于人工筛选数据的低效率和低"><meta itemprop=datePublished content="2020-05-06T09:44:31+00:00"><meta itemprop=dateModified content="2023-09-29T00:16:36+08:00"><meta itemprop=wordCount content="7013"><meta itemprop=image content="/logo.png"><meta itemprop=keywords content="Software,AIOT,"><meta property="og:title" content="RPI Camera Monitor"><meta property="og:description" content="​ 由人盯着监视屏幕，人总有疲劳限度的。研究表明，监控操作人员盯着电视墙屏幕超过10分钟后将漏掉90%的视频信息。由于人工筛选数据的低效率和低"><meta property="og:type" content="article"><meta property="og:url" content="liudongdong1.github.io/rpi-camera-monitor/"><meta property="og:image" content="/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-05-06T09:44:31+00:00"><meta property="article:modified_time" content="2023-09-29T00:16:36+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo.png"><meta name=twitter:title content="RPI Camera Monitor"><meta name=twitter:description content="​ 由人盯着监视屏幕，人总有疲劳限度的。研究表明，监控操作人员盯着电视墙屏幕超过10分钟后将漏掉90%的视频信息。由于人工筛选数据的低效率和低"><meta name=application-name content="DAY By DAY"><meta name=apple-mobile-web-app-title content="DAY By DAY"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=liudongdong1.github.io/rpi-camera-monitor/><link rel=prev href=liudongdong1.github.io/css-learning-record/><link rel=next href=liudongdong1.github.io/raspberrypi4-installation/><link rel=stylesheet href=/liudongdong1.github.io/css/style.min.css><link rel=stylesheet href=/liudongdong1.github.io/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/liudongdong1.github.io/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"RPI Camera Monitor","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"liudongdong1.github.io\/rpi-camera-monitor\/"},"genre":"posts","keywords":"Software, AIOT","wordcount":7013,"url":"liudongdong1.github.io\/rpi-camera-monitor\/","datePublished":"2020-05-06T09:44:31+00:00","dateModified":"2023-09-29T00:16:36+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"LiuDongdong","logo":"\/images\/person.png"},"author":{"@type":"Person","name":"liudongdong1"},"description":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=liudongdong1.github.io/ title="DAY By DAY"><img class="lazyload logo" src=/liudongdong1.github.io/svg/loading.min.svg data-src=/fixit.min.svg data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x" data-sizes=auto alt="DAY By DAY" title="DAY By DAY"><span class=header-title-text></span></a><span id=typeit-header-subtitle-desktop class="typeit header-subtitle"></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/friends/ title=友情链接><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item>没有更多翻译</li></ul></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=liudongdong1.github.io/ title="DAY By DAY"><img class="lazyload logo" src=/liudongdong1.github.io/svg/loading.min.svg data-src=/fixit.min.svg data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x" data-sizes=auto alt=/fixit.min.svg title=/fixit.min.svg><span class=header-title-text></span></a><span id=typeit-header-subtitle-mobile class="typeit header-subtitle"></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/friends/ title=友情链接><i class="fa-solid fa-users fa-fw fa-sm" aria-hidden=true></i> 友链</a></li><li class=menu-item><a class=menu-link href=/liudongdong1.github.io/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item text-center"><a class=menu-link href=https://liudongdong1.github.io/ title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw' aria-hidden=true></i></a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option disabled>没有更多翻译</option></select></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container data-page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>目录 <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom id=aside-sakana><div class=sakana-widget><div class=sakana-item id=takina-widget></div><div class=sakana-item id=chisato-widget></div></div><script>function initSakanaWidget(){const e=SakanaWidget.getCharacter("takina");SakanaWidget.registerCharacter("takina-slow",e),new SakanaWidget({character:"takina-slow",controls:!1,autoFit:!0,stroke:{color:"#b4b4b4",width:2}}).mount("#takina-widget");const t=SakanaWidget.getCharacter("chisato");SakanaWidget.registerCharacter("chisato-slow",t),new SakanaWidget({character:"chisato-slow",controls:!1,autoFit:!0,stroke:{color:"#b4b4b4",width:2}}).mount("#chisato-widget")}</script><script async onload=initSakanaWidget() src=https://cdn.jsdelivr.net/npm/sakana-widget@2.3.0/lib/sakana.min.js></script></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>RPI Camera Monitor</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
liudongdong1</span></span>
<span class=post-category>收录于 <a href=liudongdong1.github.io/categories/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;Categories</a>&ensp;<a href=liudongdong1.github.io/categories/linux/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;Linux</a></span></div><div class=post-meta-line><span title="2020-05-06 09:44:31"><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-05-06>2020-05-06</time>
</span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;约 7013 字&nbsp;
<i class="fa-regular fa-clock fa-fw"></i>&nbsp;预计阅读 14 分钟&nbsp;<span id=busuanzi_container_page_pv class="busuanzi_visitors comment-visitors" data-flag-title="RPI Camera Monitor">
<i class="fa-regular fa-eye fa-fw"></i>&nbsp;<span id=busuanzi_value_page_pv>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class=featured-image><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogImage/raw/master/img/1.png data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/1.png, https://gitee.com/github-25970295/blogImage/raw/master/img/1.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/1.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogImage/raw/master/img/1.png title=https://gitee.com/github-25970295/blogImage/raw/master/img/1.png></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#0-准备工作>0. 准备工作</a></li><li><a href=#1-magic-mirrors>1. Magic Mirrors</a><ul><li><a href=#11-installation-manually>1.1 Installation Manually</a></li><li><a href=#12-alternative-installation>1.2 Alternative Installation</a></li><li><a href=#13-configuration>1.3 Configuration</a></li></ul></li><li><a href=#2-自美系统httpdocs16302com1318686><a href=http://docs.16302.com/1318686>2. 自美系统</a></a><ul><li><a href=#21-配网方法><strong>2.1. 配网方法</strong></a></li><li><a href=#22-唤醒词>2.2. 唤醒词</a></li><li><a href=#23-微信绑定>2.3. 微信绑定</a></li><li><a href=#24-系统内置插件>2.4. 系统内置插件</a></li><li><a href=#25-系统手动升级>2.5. 系统手动升级</a></li><li><a href=#26-驱动安装和升级>2.6. 驱动安装和升级</a></li><li><a href=#27-插件开发>2.7. 插件开发</a></li><li><a href=#28-代码阅读>2.8. 代码阅读</a></li></ul></li><li><a href=#3-home-assistant-系统>3. Home Assistant 系统</a><ul><li><a href=#31-home-assistant系统>3.1. Home Assistant系统</a></li><li><a href=#32-installation>3.2. Installation</a></li></ul></li><li><a href=#4-系统镜像>4. 系统镜像</a></li><li><a href=#5-工具>5. 工具</a></li><li><a href=#6-项目>6. 项目</a></li></ul></nav></div></div><div class=content id=content><blockquote><p>​ 由人盯着监视屏幕，人总有疲劳限度的。研究表明，监控操作人员盯着电视墙屏幕超过10分钟后将漏掉90%的视频信息。由于人工筛选数据的低效率和低可靠性，视频监控系统不能局限于被动地提供视频画面，要求集成智能算法，能够自动识别不同的物体，发现监控画面中的异常情况，实现不再要人去盯、用计算机代替人进行监控，即实现“自动监控”或“智能监控”。智能视频监控是基于机器视觉对视频信号进行处理、分析和理解，在不需要人工干预的情况下，通过对序列图像自动分析对监控场景中的变化进行定位、识别和跟踪，并在此基础上分析和判断目标的行为，能在异常情况发生时及时发出警报或提供有用信息，从而有效地协助安全监管人员处理危机，并最大限度地降低误报和漏报现象，成为应对突发事件的有力辅助工具。</p></blockquote><h2 id=0-准备工作>0. 准备工作</h2><ul><li>树莓派4b 单板2G 335</li><li>电源，外壳，HDMI线，散热片，16GTF卡，读卡器，小风扇，网线，引脚尺，扩展板+铜柱，按键，点阵，LED，排线，点阵转接板 60</li><li>显示屏： 7寸 ultra-thin TFT LCD color monitor 180</li><li>摄像头： 鱼眼广角夜视500w 视角130度 咸鱼 89</li></ul><h2 id=1-magic-mirrors>1. Magic Mirrors</h2><blockquote><p><strong>MagicMirror²</strong> is an open source modular smart mirror platform. With a growing list of installable modules, the <strong>MagicMirror²</strong> allows you to convert your hallway or bathroom mirror into your personal assistant</p></blockquote><h3 id=11-installation-manually>1.1 Installation Manually</h3><ol><li>Download and install the latest <em>Node.js</em> version:</li></ol><ul><li><code>curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -</code></li><li><code>sudo apt install -y nodejs</code></li></ul><ol start=2><li>Clone the repository and check out the master branch: <code>git clone https://github.com/MichMich/MagicMirror</code></li><li>Enter the repository: <code>cd MagicMirror/</code></li><li>Install the application: <code>npm install</code></li><li>Make a copy of the config sample file: <code>cp config/config.js.sample config/config.js</code></li><li>Start the application: <code>npm run start</code>
For <strong>Server Only</strong> use: <code>npm run server</code> .</li></ol><h3 id=12-alternative-installation>1.2 Alternative Installation</h3><ul><li><a href=https://github.com/bastilimbach/docker-MagicMirror target=_blank rel="external nofollow noopener noreferrer">Docker Image<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li><li><a href=https://github.com/guysoft/MagicMirrorOS target=_blank rel="external nofollow noopener noreferrer">MagicMirrorOs<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li></ul><h3 id=13-configuration>1.3 Configuration</h3><ul><li>check your configuration running <code>npm run config:check</code> in <code>/home/pi/MagicMirror</code></li></ul><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200507210040338.png data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200507210040338.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200507210040338.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200507210040338.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200507210040338.png title=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200507210040338.png></p><p>Model 官方模块包括： Alert， Calendar， Clock， Current Weather， Hello world， News Feed， Update Notification， Weather Module, Weather Forecast</p><p>FileStructure：</p><ul><li><strong>modulename/modulename.js</strong> - This is your core module script.</li><li><strong>modulename/node_helper.js</strong> - This is an optional helper that will be loaded by the node script. The node helper and module script can communicate with each other using an integrated socket system.</li><li><strong>modulename/public</strong> - Any files in this folder can be accessed via the browser on <code>/modulename/filename.ext</code>.</li><li><strong>modulename/anyfileorfolder</strong> Any other file or folder in the module folder can be used by the core module script. For example: <em>modulename/css/modulename.css</em> would be a good path for your additional module styles.</li></ul><h2 id=2-自美系统httpdocs16302com1318686><a href=http://docs.16302.com/1318686 target=_blank rel="external nofollow noopener noreferrer">2. 自美系统<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></h2><p>硬件清单：https://shop418091054.taobao.com/</p><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509141258351.png data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509141258351.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509141258351.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509141258351.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509141258351.png title=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509141258351.png></p><p>自美驱动板：</p><blockquote><p>​ 基于树莓派的智能魔镜：音频、人体感应、屏幕开关、镜前灯控件和控温风扇控件等模块而设计，采用WM8960低功耗立体声编解码器，通过I2C接口控制，I2S接口传输音频。板载两个3P标准可录立体有源硅麦接口，板载一个4P可接双通道喇叭。</p></blockquote><ul><li>供电电压：5V</li><li>逻辑电压：3.3V</li><li>音频编解码芯片：WM8960</li><li>控制接口：I2C</li><li>音频接口：I2S</li><li>DAC信噪比：98dB</li><li>ADC信噪比：94dB</li><li>扬声器驱动：1W per channel (8Ω BTL)</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#布置环境   一键安装全部环境</span>
</span></span><span style=display:flex><span>sudo curl -sSL http://a.16302.com/init | sh
</span></span><span style=display:flex><span><span style=color:#75715e>#系统安装</span>
</span></span><span style=display:flex><span>sudo curl -sSL http://a.16302.com/install | sudo python3
</span></span></code></pre></div><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143513833.png data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143513833.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143513833.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143513833.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143513833.png title=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143513833.png></p><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143703233.png data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143703233.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143703233.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143703233.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143703233.png title=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200509143703233.png></p><h3 id=21-配网方法><strong>2.1. 配网方法</strong></h3><ol><li>如下图所示，将触摸配网按钮插入“按键”插口，手指轻触按钮 （TOUCH） 指示位置5秒钟以上就即可进入配网模式（如果没有触摸按钮也可以使用一根导线将P31与3V3引脚连接5秒钟以上）
<img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=http://qiniucn.16302.com/a412177ed26ee314b6ecb5bf47271558 data-srcset="http://qiniucn.16302.com/a412177ed26ee314b6ecb5bf47271558, http://qiniucn.16302.com/a412177ed26ee314b6ecb5bf47271558 1.5x, http://qiniucn.16302.com/a412177ed26ee314b6ecb5bf47271558 2x" data-sizes=auto alt=http://qiniucn.16302.com/a412177ed26ee314b6ecb5bf47271558 title=http://qiniucn.16302.com/a412177ed26ee314b6ecb5bf47271558></li><li>语音提示开始配网，跳转出下面的页面，按提示操作
<img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=http://qiniucn.16302.com/4e93ee1e6121e1f86da343352002dfdf data-srcset="http://qiniucn.16302.com/4e93ee1e6121e1f86da343352002dfdf, http://qiniucn.16302.com/4e93ee1e6121e1f86da343352002dfdf 1.5x, http://qiniucn.16302.com/4e93ee1e6121e1f86da343352002dfdf 2x" data-sizes=auto alt=http://qiniucn.16302.com/4e93ee1e6121e1f86da343352002dfdf title=http://qiniucn.16302.com/4e93ee1e6121e1f86da343352002dfdf></li><li>打开手机微信扫一扫功能，扫描屏幕上二维码直接进入配网界面，如果没有显示器可在微信中搜索“自美系统”小程序，打开小程序在右下角“我”的选项里找到“设备配网”栏目，点击进入</li></ol><h3 id=22-唤醒词>2.2. 唤醒词</h3><ul><li>链接网址: <a href=https://snowboy.kitt.ai/ target=_blank rel="external nofollow noopener noreferrer">https://snowboy.kitt.ai/<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li><li>设备要求: 电脑上需要麦克风才能完成</li><li>使用文档：http://docs.16302.com/1144911</li></ul><h3 id=23-微信绑定>2.3. 微信绑定</h3><ul><li>扫描二维码，绑定设备</li></ul><h3 id=24-系统内置插件>2.4. 系统内置插件</h3><table><thead><tr><th>触发词</th><th>功能</th><th>对应插件</th><th>备注</th></tr></thead><tbody><tr><td>&ldquo;用户绑定&rdquo;,&ldquo;绑定用户&rdquo;,&ldquo;绑定设备&rdquo;,&ldquo;设备绑定&rdquo;,&ldquo;我是谁&rdquo;</td><td>通过微信绑定机器</td><td>user</td><td></td></tr><tr><td>&ldquo;IP地址&rdquo;, &ldquo;本机IP&rdquo;</td><td>播报ip地址</td><td>SayIp</td><td>基本参考格式</td></tr><tr><td>[&ldquo;播放本地歌曲&rdquo;, &ldquo;暂停歌曲&rdquo;, &ldquo;暂停播放&rdquo;, &ldquo;继续播放&rdquo;, &ldquo;歌曲继续&rdquo;,"\b播放\S{0,4}\d","\b切换\S{0,4}\d",</td><td>歌曲播放</td><td>Music</td><td>使用mplay开源软件</td></tr><tr><td>&ldquo;打开灯&rdquo;, &ldquo;关闭灯&rdquo;</td><td>开关操作</td><td>Light</td><td>设置一个引脚input/output</td></tr><tr><td>&ldquo;打开屏幕&rdquo;, &ldquo;打开显示&rdquo;, &ldquo;关闭屏幕&rdquo;, &ldquo;关闭显示&rdquo;,&ldquo;天气地址&rdquo;,&ldquo;修改位置&rdquo;,&ldquo;声音\S{2,}&rdquo;, &ldquo;音量\S{2,}&rdquo;<strong>修改位置为铜陵市</strong></td><td>设备操作</td><td>Device</td><td>调节音量和打开或关闭屏幕,修改天气地址</td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table><h3 id=25-系统手动升级>2.5. 系统手动升级</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo python3 /keyicx/update.py
</span></span><span style=display:flex><span><span style=color:#75715e># 若失败手动恢复升级</span>
</span></span><span style=display:flex><span>sudo curl -sSL http://a.16302.com/update | sudo python3
</span></span></code></pre></div><p><strong><code>开发者模式</code>（推荐使用）</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo curl -sSL http://a.16302.com/initdev | sh
</span></span></code></pre></div><p>自美智能系统桌面任务栏</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo mv /home/pi/.config/lxpanel/LXDE-pi/panels/panel /home/pi/.config/lxpanel/LXDE-pi/ 
</span></span><span style=display:flex><span>sudo reboot
</span></span></code></pre></div><p>启动正常模式</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>/keyicx/python/run.py
</span></span></code></pre></div><p>启动调试模式</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>/keyicx/python/run.py debug
</span></span></code></pre></div><p>停止关闭系统</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>/keyicx/python/run.py stop
</span></span></code></pre></div><h3 id=26-驱动安装和升级>2.6. 驱动安装和升级</h3><ol><li><p>一键镜像安装自美系统，会自动将本驱动板相应的驱动安装并已经调试到最佳状态，本教程可跳过。
一键镜像安装自美系统请<a href=http://docs.16302.com/1144905 target=_blank rel="external nofollow noopener noreferrer">点击这里<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p></li><li><p>在线手动安装驱动</p><blockquote><p>手动安装驱动，建议烧录树莓派官方系统，因为咱们基本上都是在这个系统进行开发测试+调试的，其他系统没有相应的测试过，不保证一定能安装成功。</p></blockquote></li></ol><p>第一步：首先将驱动板插到树莓派开发板上，启动树莓派；
第二步：启动树莓派系统，启动终端（或用SSH连接到树莓派设备）</p><pre tabindex=0><code>#打开I2C 接口
sudo raspi-config
#选择 5 Interfacing  Options  \→ P5 I2C \→ 是 启动 i2C 内核驱动
# 关闭树莓派默认音频驱动
sudo nano /boot/config.txt
#注：   dtparam=audio=on  将这行注释
sudo reboot
#  在线安装驱动
git clone https://github.com/waveshare/WM8960-Audio-HAT
# 这里需要等待一定的时间
cd WM8960-Audio-HAT
sudo ./install.sh
sudo reboot
#测试驱动安装
sudo dkms status
#wm8960-soundcard, 1.0, 4.19.58+, armv7l: installed
#wm8960-soundcard, 1.0, 4.19.58-v7+, armv7l: installed
#wm8960-soundcard, 1.0, 4.19.58-v7l+, armv7l: installed
#	检测声卡
root@raspberrypi:~ # aplay -l
**** List of PLAYBACK Hardware Devices ****
card 0: wm8960soundcard [wm8960-soundcard], device 0: bcm2835-i2s-wm8960-hifi wm8960-hifi-0 []
  Subdevices: 1/1
  Subdevice #0: subdevice #0
#	检测录音功能
root@raspberrypi:~ # arecord -l
**** List of CAPTURE Hardware Devices ****
card 0: wm8960soundcard [wm8960-soundcard], device 0: bcm2835-i2s-wm8960-hifi wm8960-hifi-0 []
  Subdevices: 0/1
  Subdevice #0: subdevice #0
  
#录音并播放测试
sudo arecord -f cd -Dhw:0 | aplay -Dhw:0
</code></pre><ul><li>单录音测试</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo arecord -D hw:0,0 -f S32_LE -r <span style=color:#ae81ff>16000</span> -c <span style=color:#ae81ff>2</span> test.wav
</span></span></code></pre></div><p>test.wav是录制生成的文件名。</p><ul><li>播放录音（播放刚刚录制的音频）</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo aplay -Dhw:0 test.wav
</span></span></code></pre></div><ul><li>安装mpg123播放器</li></ul><pre tabindex=0><code>sudo apt-get install mpg123 
</code></pre><ul><li>播放MP3</li></ul><pre tabindex=0><code>sudo mpg123 ***.mp3
</code></pre><h3 id=27-插件开发>2.7. 插件开发</h3><blockquote><p>原理：自美系统采用多进程消息队列管理模式运行，各模块和插件均为独立进程运行互不干扰。进程间采用消息通知方式通信。</p></blockquote><blockquote><p><strong>系统结构说明：</strong> 每一个模块都可以独立运行和协作运行，插件也可以理解为一个特有功能的模块。除了一些特有功能模块，系统自带集合了几大内置功能，分别如下：
一、 语音唤醒模块；
二、语音录音模块；
三、语音识别模块；
四、语音合成模块；
五、屏幕显示模块；
六、微信小程序通信模块；
七、外设万能开关通信模块;</p></blockquote><h4 id=271-插件结构>2.7.1. 插件结构</h4><p>一、<strong>插件位置：</strong>
自美插件位于当前系统目录：<code>./python/plugin/</code>目录下，如果您采用<a href=http://docs.16302.com/1144905 target=_blank rel="external nofollow noopener noreferrer">镜像安装<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>方式安装的自美系统，那么插件目录就是：<code>/keyicx/python/plugin/</code>下，一个插件一个目录，如:</p><pre tabindex=0><code>/keyicx/python/plugin/Chat（聊天机器人插件）
/keyicx/python/plugin/Music（音乐插件）
</code></pre><p>二、<strong>插件组成：</strong>
自美系统是由*.py（插件入口文件） + config.json（插件配置文件）组成，如音乐插件是由：</p><pre tabindex=0><code>/keyicx/python/plugin/Music/config.json （配置文件）
/keyicx/python/plugin/Music/Music.py （入口文件）
</code></pre><p>三、<strong>插件命名约定</strong></p><blockquote><p>插件命名约定可简单说叫：四名一致</p></blockquote><p>1、插件文件夹名称；
2、config.json配置文件名中的<code>name</code>插件名称键值；
3、插件入口文件<code>.py</code>（也可以叫插件基本文件）名；
4、插件入口文件中的起始类名：<code>class 插件名称</code>
每一个插件必须保持以上四个位置处名称一致并且在插件文夹中唯一，否则都会导致插件不能正常启动和运行。</p><p>四、<strong>config.json 配置文件</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;插件名&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;triggerwords&#34;</span>: [],         <span style=color:#75715e>// 插件语音触发词数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;IsEnable&#34;</span>: <span style=color:#66d9ef>false</span>,          <span style=color:#75715e>// 是否启用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;IsSystem&#34;</span>: <span style=color:#66d9ef>false</span>,          <span style=color:#75715e>// 是否为系统插件，系统插件会保持后台运行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;AutoLoader&#34;</span>: <span style=color:#66d9ef>false</span>,        <span style=color:#75715e>// 是否随系统启动自动装载 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;displayName&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,          <span style=color:#75715e>// 插件名称（通常为中文简称）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,          <span style=color:#75715e>// 插件简介说明
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;icon&#34;</span>:<span style=color:#e6db74>&#34;0&#34;</span>,                 <span style=color:#75715e>// 插件默认图标(默认选0就行)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.0.1&#34;</span>,         <span style=color:#75715e>// 插件版本号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;updateTime&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,            <span style=color:#75715e>// 插件最近一次更新时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;control&#34;</span>:[],               <span style=color:#75715e>// 微信小程序控制端配置              
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;webAdminApi&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,           <span style=color:#75715e>// 插件管理配置文件接口
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;initControl&#34;</span>: <span style=color:#ae81ff>0</span>,           <span style=color:#75715e>// 插件被激活是否通知微信小程序控制端
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;repository&#34;</span>: {             <span style=color:#75715e>// 插件版本管理配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;git&#34;</span>,          <span style=color:#75715e>// 插件通讯协议，分为：git 和 http 两种，目前只支持git模式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>               <span style=color:#75715e>// 插件版本维护地址
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=272-前端开发>2.7.2. 前端开发</h4><p>前端文件目录： /keyicx/python/webroot/desktop/mojing/</p><p><strong>前端显示与Python通讯方式</strong></p><p>自美系统前端与后端Python通讯采用两种方式，一种是被动显示和主动请求：</p><ol><li>被动显示采用<code>websocket</code>技术，以达到实时性;</li><li>主动请求，采用直接调用python文件方式，得到显示结果（注：这种方式后期可能会废弃）</li></ol><p><strong>被动显示方式介绍</strong></p><p>被动显示即前端显示一直处于等待显示数据接收状态，我们采用的是NodeJS技术将前端设置为<code>websocket</code>服务器，Python通过socket技术向前端发送信息，具体代码可参考：<code>/keyicx/app/resources/app/control.js</code>文件中：</p><pre tabindex=0><code>start_websocket: function(){
...
}
</code></pre><p>project 1：https://www.youtube.com/watch?v=cVmDjJmcd2M</p><h4 id=自定义功能>自定义功能：</h4><ul><li>添加按键触摸打开监控摄像头</li><li>添加电子相册， 修改对应的js代码</li><li>添加Monitor监控模块</li></ul><p><img class=lazyload src=/liudongdong1.github.io/svg/loading.min.svg data-src=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200514192013919.png data-srcset="https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200514192013919.png, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200514192013919.png 1.5x, https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200514192013919.png 2x" data-sizes=auto alt=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200514192013919.png title=https://gitee.com/github-25970295/blogImage/raw/master/img/image-20200514192013919.png></p><h3 id=28-代码阅读>2.8. 代码阅读</h3><ul><li>python/WebServer.py: 启动web服务器</li><li>python/ControlCenter.py: 启动后端服务</li><li>app/moJing: 前端任务</li></ul><blockquote><p>self.send(MsgType=MsgType.Start, Receiver=module)</p></blockquote><h4 id=281--语言识别>2.8.1. 语言识别</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># -*- coding: utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># @Author: GuanghuiSun</span>
</span></span><span style=display:flex><span><span style=color:#75715e># @Date: 2020-02-22 10:37:52</span>
</span></span><span style=display:flex><span><span style=color:#75715e># @LastEditTime: 2020-03-04 19:23:01</span>
</span></span><span style=display:flex><span><span style=color:#75715e># @Description:  录音服务</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> webrtcvad
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> logging
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> threading <span style=color:#f92672>import</span> Thread
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> MsgProcess <span style=color:#f92672>import</span> MsgProcess, MsgType
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> package.VoiceRecognition <span style=color:#66d9ef>as</span> VoiceRecognition
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> socket
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> wave
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> bin.pyAlsa <span style=color:#f92672>import</span> pyAlsa
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 录音，并转化为文字，发送给 message[sender]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SocketRec</span>:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34; 直接通过在后台运行的awake唤醒程序发来的录音包来录音 &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, buffSize<span style=color:#f92672>=</span><span style=color:#ae81ff>3200</span>):        
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>BindFilePath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/tmp/Record.zimei&#39;</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>server <span style=color:#f92672>=</span> socket<span style=color:#f92672>.</span>socket(socket<span style=color:#f92672>.</span>AF_UNIX, socket<span style=color:#f92672>.</span>SOCK_DGRAM)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(self<span style=color:#f92672>.</span>BindFilePath):
</span></span><span style=display:flex><span>            os<span style=color:#f92672>.</span>unlink(self<span style=color:#f92672>.</span>BindFilePath)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>server<span style=color:#f92672>.</span>bind(self<span style=color:#f92672>.</span>BindFilePath)
</span></span><span style=display:flex><span>        <span style=color:#75715e># 根据后台awake录音参数调节 buffSize = frame*loop*2</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>buffSize <span style=color:#f92672>=</span> buffSize  <span style=color:#75715e># 取决于 awake.ini中的 frames</span>
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;BindFilePath=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> buffSize=</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span> (self<span style=color:#f92672>.</span>BindFilePath, buffSize))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read</span>(self):   
</span></span><span style=display:flex><span>        data, address <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span> server<span style=color:#f92672>.</span>recvfrom(self<span style=color:#f92672>.</span>buffSize)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> data
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>close</span>(self):
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>unlink(self<span style=color:#f92672>.</span>BindFilePath)       
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#进行录音</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Pyaudio</span>:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39; 调用Pyaudio录音 &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, buffSize<span style=color:#f92672>=</span><span style=color:#ae81ff>3200</span>):
</span></span><span style=display:flex><span>        <span style=color:#f92672>import</span> pyaudio
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>CHUNK <span style=color:#f92672>=</span> buffSize <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        FORMAT <span style=color:#f92672>=</span> pyaudio<span style=color:#f92672>.</span>paInt16
</span></span><span style=display:flex><span>        CHANNELS <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        RATE <span style=color:#f92672>=</span> <span style=color:#ae81ff>16000</span>  <span style=color:#75715e># 16k采样率      </span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>pa <span style=color:#f92672>=</span> pyaudio<span style=color:#f92672>.</span>PyAudio()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>stream <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>pa<span style=color:#f92672>.</span>open(rate<span style=color:#f92672>=</span>RATE, channels<span style=color:#f92672>=</span>CHANNELS, format<span style=color:#f92672>=</span>FORMAT, input<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, frames_per_buffer<span style=color:#f92672>=</span>self<span style=color:#f92672>.</span>CHUNK)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>stream<span style=color:#f92672>.</span>read(self<span style=color:#f92672>.</span>CHUNK)
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>close</span>(self):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>stream<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>pa<span style=color:#f92672>.</span>terminate()
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Record</span>(MsgProcess):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, msgQueue):
</span></span><span style=display:flex><span>        super()<span style=color:#f92672>.</span>__init__(msgQueue<span style=color:#f92672>=</span>msgQueue)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>vad <span style=color:#f92672>=</span> webrtcvad<span style=color:#f92672>.</span>Vad(<span style=color:#ae81ff>1</span>)  <span style=color:#75715e># 语音检测库</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>isReset <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>currentRecThread <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>  <span style=color:#75715e># 当前录音线程</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>VoiceRecognition <span style=color:#f92672>=</span> VoiceRecognition<span style=color:#f92672>.</span>VoiceRecognition()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>Start</span>(self, message):
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#39;[</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>] request Record&#39;</span> <span style=color:#f92672>%</span> message[<span style=color:#e6db74>&#39;Sender&#39;</span>])
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>currentRecThread <span style=color:#f92672>and</span> self<span style=color:#f92672>.</span>currentRecThread<span style=color:#f92672>.</span>is_alive():
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>isReset <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>send(MsgType<span style=color:#f92672>.</span>Text, Receiver<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Screen&#39;</span>, Data<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;请说，我正在聆听...&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>popen(<span style=color:#e6db74>&#39;aplay -q data/audio/ding.wav&#39;</span>)
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>0.4</span>) 
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>currentRecThread <span style=color:#f92672>=</span> Thread(target<span style=color:#f92672>=</span>self<span style=color:#f92672>.</span>RecordThread, args<span style=color:#f92672>=</span>(message,))
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>currentRecThread<span style=color:#f92672>.</span>start()         <span style=color:#75715e># 启动录音线程</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>is_speech</span>(self, buffer):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        检测长度为size字节的buffer是否是语音
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        webrtcvad 要求你的总CHUNK用时只能有三种 10ms 20ms 30ms
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        在16000hz采样下，一个frame用时为 0.0625ms 所以只能选160 320 480
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        对应字节数分别为:320,640,960
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>        size <span style=color:#f92672>=</span> len(buffer)
</span></span><span style=display:flex><span>        RATE <span style=color:#f92672>=</span> <span style=color:#ae81ff>16000</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>assert</span> size <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>320</span>  <span style=color:#75715e># 长度不能小于10ms</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># if size &lt; 640:</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#    return self.vad.is_speech(buffer[0:320], RATE)</span>
</span></span><span style=display:flex><span>        setp <span style=color:#f92672>=</span> <span style=color:#ae81ff>320</span>
</span></span><span style=display:flex><span>        score <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        blocks <span style=color:#f92672>=</span> size <span style=color:#f92672>//</span> setp  <span style=color:#75715e># 将音频分割</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(blocks):
</span></span><span style=display:flex><span>            score <span style=color:#f92672>+=</span> self<span style=color:#f92672>.</span>vad<span style=color:#f92672>.</span>is_speech(buffer[i<span style=color:#f92672>*</span>setp:(i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>*</span>setp], RATE)
</span></span><span style=display:flex><span>        <span style=color:#75715e># logging.debug(&#34;语音概率 {}/{} = {:.2f} buffer size = {}&#34;.format(score, blocks, score / blocks,size))</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> score <span style=color:#f92672>/</span> blocks
</span></span><span style=display:flex><span>    <span style=color:#75715e># 启动录音，并将录音转化为文字，发送给 message[sender]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>RecordThread</span>(self, message):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;RecSeclet&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;ScoketRec&#39;</span>:
</span></span><span style=display:flex><span>            stream <span style=color:#f92672>=</span> SocketRec(buffSize<span style=color:#f92672>=</span><span style=color:#ae81ff>4000</span>)                                                    <span style=color:#75715e># 使用unix socket录音</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;RecSeclet&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;pyAlsa&#39;</span>:            
</span></span><span style=display:flex><span>            stream <span style=color:#f92672>=</span> pyAlsa<span style=color:#f92672>.</span>pyAlsa()                                                             <span style=color:#75715e># 使用pyalsa.so录音       </span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;RecSeclet&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Pyaudio&#39;</span>:
</span></span><span style=display:flex><span>            stream <span style=color:#f92672>=</span> Pyaudio(buffSize<span style=color:#f92672>=</span><span style=color:#ae81ff>4000</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            logging<span style=color:#f92672>.</span>error(<span style=color:#e6db74>&#39;未知录音配置 config.yaml&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>        NoSpeechCheck <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>           <span style=color:#75715e># 常量,参考frames大小而定</span>
</span></span><span style=display:flex><span>        MinSpeechCHUNK <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>          <span style=color:#75715e># 常量,参考frames大小而定</span>
</span></span><span style=display:flex><span>        MAXRECLAN <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>               <span style=color:#75715e># 最长录音时间,秒</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> message[<span style=color:#e6db74>&#39;Data&#39;</span>]:
</span></span><span style=display:flex><span>            MAXRECLAN <span style=color:#f92672>=</span> message[<span style=color:#e6db74>&#39;Data&#39;</span>]
</span></span><span style=display:flex><span>        NoSpeechCHUNK <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        Speech_CHUNK_Counter <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        lastData <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>             <span style=color:#75715e># 前导音</span>
</span></span><span style=display:flex><span>        frames <span style=color:#f92672>=</span> list()
</span></span><span style=display:flex><span>        record_T <span style=color:#f92672>=</span> time<span style=color:#f92672>.</span>time()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># info = {&#39;type&#39;:&#39;mic&#39;,      类型：dev 设备</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>#        &#39;state&#39;: &#39;start&#39;}  状态：start / stop / 1 / 0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        info <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;type&#39;</span>: <span style=color:#e6db74>&#39;mic&#39;</span>, <span style=color:#e6db74>&#39;state&#39;</span>: <span style=color:#e6db74>&#39;start&#39;</span>} 
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>send(MsgType<span style=color:#f92672>=</span>MsgType<span style=color:#f92672>.</span>Text, Receiver<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Screen&#39;</span>, Data<span style=color:#f92672>=</span>info)       <span style=color:#75715e># 显示mic</span>
</span></span><span style=display:flex><span>        info <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;type&#39;</span>: <span style=color:#e6db74>&#39;mic&#39;</span>, <span style=color:#e6db74>&#39;state&#39;</span>: <span style=color:#ae81ff>1</span>}
</span></span><span style=display:flex><span>        <span style=color:#75715e># logging.info(&#39;开始录音...&#39;)</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> (time<span style=color:#f92672>.</span>time() <span style=color:#f92672>-</span> record_T <span style=color:#f92672>&lt;</span> MAXRECLAN):
</span></span><span style=display:flex><span>            info[<span style=color:#e6db74>&#39;state&#39;</span>] <span style=color:#f92672>=</span> (<span style=color:#e6db74>&#39;1&#39;</span> <span style=color:#66d9ef>if</span> info[<span style=color:#e6db74>&#39;state&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#39;0&#39;</span>)            
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>send(MsgType<span style=color:#f92672>=</span>MsgType<span style=color:#f92672>.</span>Text, Receiver<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Screen&#39;</span>, Data<span style=color:#f92672>=</span>info)   <span style=color:#75715e># 前端mic动画            </span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (self<span style=color:#f92672>.</span>isReset):
</span></span><span style=display:flex><span>                logging<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#39;录音重置&#39;</span>)
</span></span><span style=display:flex><span>                frames<span style=color:#f92672>.</span>clear()                
</span></span><span style=display:flex><span>                record_T <span style=color:#f92672>=</span> time<span style=color:#f92672>.</span>time()
</span></span><span style=display:flex><span>                Speech_CHUNK_Counter <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                NoSpeechCHUNK <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>isReset <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>                
</span></span><span style=display:flex><span>            data <span style=color:#f92672>=</span> stream<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>            frames<span style=color:#f92672>.</span>append(data)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>is_speech(data) <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0.6</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> NoSpeechCHUNK <span style=color:#f92672>&gt;=</span> NoSpeechCheck:
</span></span><span style=display:flex><span>                    frames<span style=color:#f92672>.</span>insert(<span style=color:#ae81ff>0</span>, lastData)
</span></span><span style=display:flex><span>                Speech_CHUNK_Counter <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>                NoSpeechCHUNK <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                NoSpeechCHUNK <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            lastData <span style=color:#f92672>=</span> data
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> NoSpeechCHUNK <span style=color:#f92672>&gt;=</span> NoSpeechCheck:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> Speech_CHUNK_Counter <span style=color:#f92672>&gt;</span> MinSpeechCHUNK:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                    Speech_CHUNK_Counter <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                    frames<span style=color:#f92672>.</span>clear()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        info <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;type&#39;</span>: <span style=color:#e6db74>&#39;mic&#39;</span>, <span style=color:#e6db74>&#39;state&#39;</span>: <span style=color:#e6db74>&#39;stop&#39;</span>} 
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>send(MsgType<span style=color:#f92672>=</span>MsgType<span style=color:#f92672>.</span>Text, Receiver<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Screen&#39;</span>, Data<span style=color:#f92672>=</span>info)  <span style=color:#75715e># 不显示mic</span>
</span></span><span style=display:flex><span>        stream<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#39;录音结束&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> Speech_CHUNK_Counter <span style=color:#f92672>&gt;</span> MinSpeechCHUNK:
</span></span><span style=display:flex><span>            os<span style=color:#f92672>.</span>popen(<span style=color:#e6db74>&#39;aplay -q data/audio/dong.wav&#39;</span>)
</span></span><span style=display:flex><span>            frames <span style=color:#f92672>=</span> frames[<span style=color:#ae81ff>0</span>: <span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> NoSpeechCheck]
</span></span><span style=display:flex><span>            frames <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>.</span>join(frames)
</span></span><span style=display:flex><span>            text <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>VoiceRecognition<span style=color:#f92672>.</span>Start(frames)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> text:
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>send(MsgType<span style=color:#f92672>.</span>Text, Receiver<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Screen&#39;</span>, Data<span style=color:#f92672>=</span>text)
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>send(MsgType<span style=color:#f92672>=</span>MsgType<span style=color:#f92672>.</span>Text, Receiver<span style=color:#f92672>=</span>message[<span style=color:#e6db74>&#39;Sender&#39;</span>], Data<span style=color:#f92672>=</span>text)
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>saveRec(frames, text)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#39;无语音数据&#39;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>send(MsgType<span style=color:#f92672>=</span>MsgType<span style=color:#f92672>.</span>JobFailed, Receiver<span style=color:#f92672>=</span>message[<span style=color:#e6db74>&#39;Sender&#39;</span>])
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>send(MsgType<span style=color:#f92672>.</span>Text, Receiver<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Screen&#39;</span>, Data<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;无语音数据&#39;</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>send(MsgType<span style=color:#f92672>.</span>QuitGeekTalk, Receiver<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ControlCenter&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>saveRec</span>(self, frames, text):
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#39;&#39;&#39; 录音分析 日志为DEBUG或INFO时启用 &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;Logging&#39;</span>][<span style=color:#e6db74>&#39;Level&#39;</span>] <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> [<span style=color:#e6db74>&#39;DEBUG&#39;</span>, <span style=color:#e6db74>&#39;INFO&#39;</span>]:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>        recpath <span style=color:#f92672>=</span> <span style=color:#e6db74>r</span><span style=color:#e6db74>&#34;./runtime/record/&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(recpath):
</span></span><span style=display:flex><span>            os<span style=color:#f92672>.</span>makedirs(recpath)
</span></span><span style=display:flex><span>        file <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(recpath, text <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;.wav&#39;</span>)
</span></span><span style=display:flex><span>        w <span style=color:#f92672>=</span> wave<span style=color:#f92672>.</span>open(file, <span style=color:#e6db74>&#39;w&#39;</span>)
</span></span><span style=display:flex><span>        w<span style=color:#f92672>.</span>setnchannels(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        w<span style=color:#f92672>.</span>setsampwidth(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>        w<span style=color:#f92672>.</span>setframerate(<span style=color:#ae81ff>16000</span>)
</span></span><span style=display:flex><span>        w<span style=color:#f92672>.</span>writeframes(frames)
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------百度语音合成类---------</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> package.BDaip.speech <span style=color:#f92672>import</span> AipSpeech
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> logging
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> uuid
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> package.mylib <span style=color:#f92672>import</span> mylib
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39; 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>调用百度语音识别，需要联网
</span></span></span><span style=display:flex><span><span style=color:#e6db74>上传data， 返回对应识别文字，或者异常信息
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>VoiceRecognition</span>:
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39; 语音识别 &#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    CUID <span style=color:#f92672>=</span> hex(uuid<span style=color:#f92672>.</span>getnode())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>Start</span>(self, data):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> self<span style=color:#f92672>.</span>BDVoicerecognition(data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>BDVoicerecognition</span>(self, data):
</span></span><span style=display:flex><span>        BDAip <span style=color:#f92672>=</span> mylib<span style=color:#f92672>.</span>getConfig()[<span style=color:#e6db74>&#39;BDAip&#39;</span>]
</span></span><span style=display:flex><span>        APP_ID <span style=color:#f92672>=</span> BDAip[<span style=color:#e6db74>&#39;APP_ID&#39;</span>]
</span></span><span style=display:flex><span>        API_KEY <span style=color:#f92672>=</span> BDAip[<span style=color:#e6db74>&#39;API_KEY&#39;</span>]
</span></span><span style=display:flex><span>        SECRET_KEY <span style=color:#f92672>=</span> BDAip[<span style=color:#e6db74>&#39;SECRET_KEY&#39;</span>]
</span></span><span style=display:flex><span>        client <span style=color:#f92672>=</span> AipSpeech(APP_ID, API_KEY, SECRET_KEY)
</span></span><span style=display:flex><span>        <span style=color:#75715e># client.setConnectionTimeoutInMillis = 5000  # 建立连接的超时毫秒</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># client.setSocketTimeoutInMillis = 5000  # 传输数据超时毫秒</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>info(<span style=color:#e6db74>&#39;语音识别...&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:       
</span></span><span style=display:flex><span>            bdResult <span style=color:#f92672>=</span> client<span style=color:#f92672>.</span>asr(speech<span style=color:#f92672>=</span>data, options<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;dev_pid&#39;</span>: <span style=color:#ae81ff>1536</span>, <span style=color:#e6db74>&#39;cuid&#39;</span>: VoiceRecognition<span style=color:#f92672>.</span>CUID})
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>            logging<span style=color:#f92672>.</span>error(<span style=color:#e6db74>&#39;网络故障! </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> e)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#39;语音识别已返回&#39;</span>)
</span></span><span style=display:flex><span>        text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> bdResult[<span style=color:#e6db74>&#39;err_msg&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;success.&#39;</span>:  <span style=color:#75715e># 成功识别</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> bdResult[<span style=color:#e6db74>&#39;result&#39;</span>]:
</span></span><span style=display:flex><span>                text <span style=color:#f92672>+=</span> t
</span></span><span style=display:flex><span>            logging<span style=color:#f92672>.</span>info(text)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> bdResult[<span style=color:#e6db74>&#39;err_no&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>3301</span>:  <span style=color:#75715e># 音频质量过差</span>
</span></span><span style=display:flex><span>            text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;我没有听清楚您说的话&#39;</span>
</span></span><span style=display:flex><span>            logging<span style=color:#f92672>.</span>info(text)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> bdResult[<span style=color:#e6db74>&#39;err_no&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>3302</span>:  <span style=color:#75715e># 鉴权失败</span>
</span></span><span style=display:flex><span>            text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;鉴权失败，请与开发人员联系。&#39;</span>
</span></span><span style=display:flex><span>            logging<span style=color:#f92672>.</span>warning(text)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> bdResult[<span style=color:#e6db74>&#39;err_no&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>3304</span> <span style=color:#f92672>or</span> bdResult[<span style=color:#e6db74>&#39;err_no&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>3305</span>:  <span style=color:#75715e># 请求超限</span>
</span></span><span style=display:flex><span>            text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;请求超限，请与开发人员联系。&#39;</span>
</span></span><span style=display:flex><span>            logging<span style=color:#f92672>.</span>warning(text)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;语音识别错误,代码</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>format(bdResult[<span style=color:#e6db74>&#39;err_no&#39;</span>])
</span></span><span style=display:flex><span>        logging<span style=color:#f92672>.</span>error(text)
</span></span></code></pre></div><h2 id=3-home-assistant-系统>3. Home Assistant 系统</h2><blockquote><p>HomeAssistant是构建智慧空间的神器。是一个成熟完整的基于 Python 的智能家居系统，设备支持度高，支持自动化（Automation)、群组化（Group）、UI 客制化（Theme) 等等高度定制化设置。同样实现设备的 Siri 控制。基于HomeAssistant，可以方便地连接各种外部设备（智能设备、摄像头、邮件、短消息、云服务等，成熟的可连接组件有近千种），手动或按照自己的需求自动化地联动这些外部设备，构建随心所欲的智慧空间。HomeAssistant是开源的，它不属于任何商业公司，用户可以无偿使用。</p></blockquote><h3 id=31-home-assistant系统>3.1. Home Assistant系统</h3><ol><li>Home Control，收集组件的信息并对组件进行控制，同样也接收来自用户的控制并返回信息。</li><li>Home Automation，根据用户的配置，自动发送控制指令（通过用户指导来替代用户层的操作）。</li><li>Smart Home，根据各种之前的控制行为与结果，自学习到下一次发送的控制指令（无需用户指导而替代用户层的操作）。</li></ol><h3 id=32-installation>3.2. Installation</h3><h4 id=321-hassio>3.2.1 Hass.io</h4><blockquote><p><a href=https://www.home-assistant.io/hassio/ target=_blank rel="external nofollow noopener noreferrer">Hass.io<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>是一个完整的UI管理的家庭自动化生态系统，它运行Home Assistant，Hass.io Supervisor和附加组件。它预先安装在HassOS上，但可以安装在任何Linux系统上。它利用了由Hass.io Supervisor管理的Docker。</p><ul><li><strong>Hass.io Supervisor</strong>：Hass.io Supervisor是管理Hass.io安装的程序，负责安装和更新Home Assistant，附加组件本身以及更新（如果使用的话）HassOS操作系统。</li><li><strong>HassOS</strong>：HassOS，家庭助理操作系统，是一种嵌入式，简约的操作系统，旨在在单板计算机（如Raspberry Pi）或虚拟机上运行Hass.io生态系统。Hass.io Supervisor可以使其保持最新状态，从而无需管理操作系统</li></ul></blockquote><p>Installing using a Docker managed environment (recommended method).</p><ul><li>Download and extract the Home Assistant image for <a href=https://www.home-assistant.io/hassio/installation/ target=_blank rel="external nofollow noopener noreferrer">your device<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li><li>Download <a href=https://www.balena.io/etcher target=_blank rel="external nofollow noopener noreferrer">balenaEtcher<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> to write the image to an SD card</li><li>http://X.X.X.X:8123 to see the home page</li></ul><p>Docker - Installing on Docker.</p><h4 id=322-manually>3.2.2 Manually</h4><p>Manual installation using a Python virtual environment.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>pip3 install homeassistant
</span></span><span style=display:flex><span>hass 
</span></span><span style=display:flex><span><span style=color:#75715e># open  localhost:8123, 注册账号进入主界面</span>
</span></span></code></pre></div><h4 id=323-docker-install>3.2.3 docker install</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo nano /etc/apt/sources.list.d/raspi.list
</span></span><span style=display:flex><span>sudo apt-get update
</span></span><span style=display:flex><span><span style=color:#75715e>#docker 安装</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#1. docker apt 源</span>
</span></span><span style=display:flex><span>sudo apt-get install <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     apt-transport-https <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     ca-certificates <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     curl <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     gnupg2 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     software-properties-common
</span></span><span style=display:flex><span><span style=color:#75715e># GPG密钥</span>
</span></span><span style=display:flex><span>curl -fsSL https://download.docker.com/linux/<span style=color:#66d9ef>$(</span>. /etc/os-release; echo <span style=color:#e6db74>&#34;</span>$ID<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span>/gpg | sudo apt-key add -
</span></span><span style=display:flex><span><span style=color:#75715e>#2. 添加docker ce</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;deb [arch=armhf] https://download.docker.com/linux/debian \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      </span><span style=color:#66d9ef>$(</span>lsb_release -cs<span style=color:#66d9ef>)</span><span style=color:#e6db74> stable&#34;</span> | <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>     sudo tee /etc/apt/sources.list.d/docker.list
</span></span><span style=display:flex><span><span style=color:#75715e>#3. 安装docker ce</span>
</span></span><span style=display:flex><span>sudo apt-get update
</span></span><span style=display:flex><span>sudo apt-get install docker-ce
</span></span><span style=display:flex><span><span style=color:#75715e>#4. 创建docker 仓库镜像</span>
</span></span><span style=display:flex><span>sudo nano /etc/docker/daemon.json
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;registry-mirrors&#34;</span>: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;https://registry.docker-cn.com&#34;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>sudo systemctl daemon-reload
</span></span><span style=display:flex><span>sudo systemctl restart docker
</span></span><span style=display:flex><span>docker pull hello-world
</span></span><span style=display:flex><span>docker run hello-world
</span></span><span style=display:flex><span><span style=color:#75715e># 安装图形化界面工具</span>
</span></span><span style=display:flex><span>docker pull portainer/portainer:latest
</span></span><span style=display:flex><span>docker run -d -p 9000:9000 --name portainer --restart<span style=color:#f92672>=</span>always -e TZ<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Asia/Shanghai&#34;</span> -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer
</span></span></code></pre></div><h2 id=4-系统镜像>4. 系统镜像</h2><ul><li><a href=https://www.raspberrypi.org/downloads/raspbian/ target=_blank rel="external nofollow noopener noreferrer">Raspbian<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 来自树莓派官方的操作系统，基于Debian，同时官方也提供了一个Raspbian的精简版。</li><li><a href=https://www.offensive-security.com/kali-linux-arm-images/ target=_blank rel="external nofollow noopener noreferrer">Kali Linux<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 为渗透测试和正义黑客准备的Linux发行版，运行在ARM设备上</li><li><a href=https://github.com/futurice/chilipie-kiosk target=_blank rel="external nofollow noopener noreferrer">chilipie-kiosk<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 可直接引导到全屏Chrome的镜像，非常适合用于仪表板和构建监视器。</li><li><a href=https://github.com/Fourdee/DietPi target=_blank rel="external nofollow noopener noreferrer">DietPi<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 为2G SD卡准备的最小镜像， 带有许多可配置项和脚本.</li><li><a href=https://minibianpi.wordpress.com/ target=_blank rel="external nofollow noopener noreferrer">Minibian<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 最小的 Raspbian (比 Jessie Lite还要轻量).</li><li><a href=https://fedoraproject.org/wiki/Raspberry_Pi#Preparing_the_SD_card target=_blank rel="external nofollow noopener noreferrer">Fedora<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li><li><a href=https://github.com/ccrisan/motioneyeos/wiki target=_blank rel="external nofollow noopener noreferrer">motionEyeOS<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 将微型计算机打造为视频监控系统的Linux发行版。</li></ul><h2 id=5-工具>5. 工具</h2><ul><li><a href=https://www.etcher.io/ target=_blank rel="external nofollow noopener noreferrer">Etcher<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 跨平台的SD卡烧录程序，使用简单，易于扩展.</li><li><a href=https://github.com/StarshipEngineer/OpenVPN-Setup target=_blank rel="external nofollow noopener noreferrer">OpenVPN-Setup<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 用于将树莓派设置为OpenVPN服务器的Shell脚本.</li><li><a href=https://github.com/initialstate/pi-sensor-free-presence-detector/wiki target=_blank rel="external nofollow noopener noreferrer">Network Presence Detector<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 配置Pi0，使其可以在wifi网络里扫描，发现谁是"home"</li><li><a href=https://github.com/spoonysonny/pi-dashboard target=_blank rel="external nofollow noopener noreferrer">Pi Dashboard来监控树莓派状态<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li></ul><h2 id=6-项目>6. 项目</h2><ul><li><a href=https://cdn-learn.adafruit.com/downloads/pdf/mini-oontz-3d-printed-midi-controller.pdf target=_blank rel="external nofollow noopener noreferrer">Mini OONTZ<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 3D打印的迷你MIDI控制器</li><li><a href=https://gnurds.com/index.php/2012/10/02/raspberry-pi-power-strip/ target=_blank rel="external nofollow noopener noreferrer">Power Sniffing Strip<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 藏在电源插座里的树莓派, 用于嗅探网络数据.</li><li><a href=https://medium.com/@pieterjan_m/erlang-pi2-arm-cluster-vs-xeon-vm-40871d35d356#.bpao66cm8 target=_blank rel="external nofollow noopener noreferrer">Raspberry Pi Erlang Cluster<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 跑在树莓派2代上的Erlang集群</li><li><a href=http://www.mjoldfield.com/atelier/2012/08/ntp-nixie.html target=_blank rel="external nofollow noopener noreferrer">NTP driven Nixie Clock<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 由树莓派驱动的数码管时钟</li><li><a href=http://hackaday.com/2014/02/17/40-node-raspi-cluster/ target=_blank rel="external nofollow noopener noreferrer">40-node Raspberry Pi Cluster<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 40个节点构成的树莓派集群</li><li><a href=http://www.widriksson.com/raspberry-pi-hadoop-cluster/ target=_blank rel="external nofollow noopener noreferrer">Raspberry PI Hadoop Cluster<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 跑在树莓派上的大数据集群.</li><li><a href=http://www.datastax.com/dev/blog/32-node-raspberry-pi-cassandra-cluster target=_blank rel="external nofollow noopener noreferrer">Multi-Datacenter Cassandra on 32 Raspberry Pi’s<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 32个节点的树莓派cassandra数据库集群.</li><li><a href=http://bryanapperson.com/blog/the-definitive-guide-ceph-cluster-on-raspberry-pi/ target=_blank rel="external nofollow noopener noreferrer">Building a Ceph Cluster on Raspberry Pi<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 基于分布式对象存储系统RADOS的高度冗、低功耗家庭存储解决方案。</li><li><a href=https://github.com/evancohen/smart-mirror target=_blank rel="external nofollow noopener noreferrer">Smart Mirror<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 带语音控制智能镜子，集成物联网.</li><li><a href=http://magicmirror.builders/ target=_blank rel="external nofollow noopener noreferrer">Magic Mirror<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 开源模块化智能镜子平台.</li><li><a href=https://blog.haschek.at/post/f31aa target=_blank rel="external nofollow noopener noreferrer">Door bot<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 门卫机器人，感知到门被打开时将给你发送信息.</li><li><a href=https://github.com/SecPi/SecPi target=_blank rel="external nofollow noopener noreferrer">SecPi<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 基于Raspberry Pi的家庭报警系统.</li><li><a href=https://github.com/n0bel/PiClock target=_blank rel="external nofollow noopener noreferrer">PiClock<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 别致的时钟</li><li><a href=https://github.com/stevelacy/movel target=_blank rel="external nofollow noopener noreferrer">Movel<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 树莓派车载电脑</li><li><a href=https://github.com/winkidney/PIFanTuner target=_blank rel="external nofollow noopener noreferrer">PiFanTuner<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - CPU风扇控制程序</li><li><a href=https://github.com/evancohen/sonus target=_blank rel="external nofollow noopener noreferrer">Sonus<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 开源、跨平台的语音识别框架（Google Cloud Speech）</li><li><a href=https://github.com/alexa/alexa-avs-sample-app/wiki/Raspberry-Pi target=_blank rel="external nofollow noopener noreferrer">Alexa AVS<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 基于Java客户端和Node.js服务端的 Alexa Voice Service 示例程序</li><li><a href=https://www.raspberrypi.org/blog/harry-potter-and-the-real-life-daily-prophet/ target=_blank rel="external nofollow noopener noreferrer">Harry Potter and the real life Daily Prophet<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 通过RPi的7英寸显示模拟哈利波特中的魔法报纸（动态头条）</li><li><a href=https://blog.thibmaekelbergh.be/2015/05/07/raspberry-pi-login-with-ssh-keys.html target=_blank rel="external nofollow noopener noreferrer">Raspberry Pi login with SSH keys<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - ssh免密码登录树莓派（使用SSH key）</li><li><a href=https://www.mikestreety.co.uk/blog/use-a-raspberry-pi-with-multiple-wifi-networks target=_blank rel="external nofollow noopener noreferrer">Use a Raspberry Pi with multiple WiFi networks<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 将树莓派接入多个无线网络的教程.</li><li><a href=http://www.htpcguides.com/category/raspberry-pi/ target=_blank rel="external nofollow noopener noreferrer">Raspberry Pi Media Server Guides<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> - 用树莓派搭建媒体服务器的教程（HTPC：Home Theater Personal Computer，即家庭影院电脑）</li><li><a href=https://osmc.tv/wiki/development/getting-involved-with-osmc-development/ target=_blank rel="external nofollow noopener noreferrer">OSMC<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>: 家庭影院系统</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2023-09-29 00:16:36">更新于 2023-09-29&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=liudongdong1.github.io/rpi-camera-monitor/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span><span><a href=https://liudongdong1.github.io/edit/master/content/posts%5cLinux%5cRpi%5cRPI-Camera-Monitor.md title=编辑此页 target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>编辑此页</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=liudongdong1.github.io/rpi-camera-monitor/ data-title="RPI Camera Monitor" data-hashtags=Software,AIOT><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=liudongdong1.github.io/rpi-camera-monitor/ data-hashtag=Software><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=liudongdong1.github.io/rpi-camera-monitor/ data-title="RPI Camera Monitor" data-image=https://gitee.com/github-25970295/blogImage/raw/master/img/1.png><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=liudongdong1.github.io/tags/software/>Software</a>,&nbsp;<a href=liudongdong1.github.io/tags/aiot/>AIOT</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=liudongdong1.github.io/>主页</a></span></section></div><div class=post-nav><a href=liudongdong1.github.io/css-learning-record/ class=prev rel=prev title="CSS Learning Record"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>CSS Learning Record</a>
<a href=liudongdong1.github.io/raspberrypi4-installation/ class=next rel=next title="RaspberryPi4 Installation">RaspberryPi4 Installation<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line powered">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.118.2">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.17-RC"><img class=fixit-icon src=/liudongdong1.github.io/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2020 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=https://liudongdong1.github.io/ target=_blank rel="external nofollow noopener noreferrer">LiuDongdong</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"><span class=site-time title='网站运行中 ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i>&nbsp;<span class=run-times>网站运行中 ...</span></span></div><div class="footer-line ibruce"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden=true></i></span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><a href=https://liudongdong1.github.io/ title="在 GitHub 上查看源代码" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#0076ff;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/liudongdong1.github.io/lib/katex/katex.min.css><link rel=stylesheet href=/liudongdong1.github.io/lib/cookieconsent/cookieconsent.min.css><script src=/liudongdong1.github.io/lib/autocomplete/autocomplete.min.js defer></script><script src=/liudongdong1.github.io/lib/algoliasearch/algoliasearch-lite.umd.min.js defer></script><script src=/liudongdong1.github.io/lib/lazysizes/lazysizes.min.js async defer></script><script src=/liudongdong1.github.io/lib/sharer/sharer.min.js async defer></script><script src=/liudongdong1.github.io/lib/typeit/index.umd.js defer></script><script src=/liudongdong1.github.io/lib/katex/katex.min.js defer></script><script src=/liudongdong1.github.io/lib/katex/auto-render.min.js defer></script><script src=/liudongdong1.github.io/lib/katex/copy-tex.min.js defer></script><script src=/liudongdong1.github.io/lib/katex/mhchem.min.js defer></script><script src=/liudongdong1.github.io/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/liudongdong1.github.io/lib/pangu/pangu.min.js defer></script><script src=/liudongdong1.github.io/lib/cell-watermark/watermark.min.js defer></script><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},data:{"typeit-header-subtitle-desktop":`<span style='font-family: MMT,"沐目体";'>吾日三省吾身</span>`,"typeit-header-subtitle-mobile":`<span style='font-family: MMT,"沐目体";'>吾日三省吾身</span>`},enablePWA:!0,enablePangu:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"2R1K9SKLQZ",algoliaIndex:"index.zh-cn",algoliaSearchKey:"4a226aa1c5c98d6859e4d1386adb2bc7",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"algolia"},siteTime:"2020-12-18T16:15:22+08:00",typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"typeit-header-subtitle-desktop":["typeit-header-subtitle-desktop"],"typeit-header-subtitle-mobile":["typeit-header-subtitle-mobile"]},duration:-1,speed:100},watermark:{appendto:".wrapper>main",colspacing:30,content:'<img class="fixit-icon" src="/fixit.min.svg" alt="FixIt logo" /> FixIt 主题',enable:!0,fontfamily:"inherit",fontsize:.85,height:21,opacity:.0125,rotate:15,rowspacing:60,width:150}}</script><script src=/liudongdong1.github.io/js/theme.min.js defer></script><script src=/liudongdong1.github.io/js/custom.min.js defer></script></body></html>