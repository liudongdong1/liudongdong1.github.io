<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="C编程规范, AIOT,Space&amp;Temporal Sequence Analysis,SpringBoot,liudongdong1,cloud">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>C编程规范 | DaybyDay</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="DaybyDay" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">DaybyDay</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">

      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/about">
          
          <i class="fas fa-user-circle" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>about</span>
        </a>
      </li>
      
      <li>
        <a href="/resume">
          
          <i class="fa fa-user-secret" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>resume</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/gallery" class="waves-effect waves-light">
      
      <i class="fas fa-camera" style="zoom: 0.6;"></i>
      
      <span>Galleries</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">DaybyDay</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-user-circle"></i>
			
			About
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/about " style="margin-left:75px">
				  
				   <i class="fa fas fa-user-circle" style="position: absolute;left:50px" ></i>
			      
		          <span>about</span>
                  </a>
                </li>
              
                <li>

                  <a href="/resume " style="margin-left:75px">
				  
				   <i class="fa fa fa-user-secret" style="position: absolute;left:50px" ></i>
			      
		          <span>resume</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/gallery" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-camera"></i>
			
			Galleries
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/liudongdong1" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/liudongdong1" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.pixabay.com/photo/2021/07/25/05/39/daylily-6490922__340.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">C编程规范</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    .toc-fixed .toc-link::before{
        position: fixed!important;/*当toc的位置改为fixed时，.toc-link::before也要改为fixed*/
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/C/">
                                <span class="chip bg-color">C</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" class="post-category">
                                编程语言
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2022-04-01
                </div>
                

                <!-- 
                    <i class="fa fa-pencil"></i> Author: liudongdong1
                  -->

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2022-04-15
                </div>
                

                <!-- 
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    6.2k
                </div>
                 -->

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>Read Times:&nbsp;&nbsp;
                    24 Min
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <blockquote>
<p>开发人员对正确性、健壮性、可靠性、效率、易用性、可读性（可理解性）、可扩展性、 可复用性、兼容性、可移植性等质量属性了如指掌.</p>
</blockquote>
<h3 id="1-文件结构"><a href="#1-文件结构" class="headerlink" title="1. 文件结构"></a>1. 文件结构</h3><h4 id="1-版本及声明"><a href="#1-版本及声明" class="headerlink" title=".1. 版本及声明"></a>.1. 版本及声明</h4><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/* 
* Copyright (c) 2001,上海贝尔有限公司网络应用事业部 
* All rights reserved. 
* 
* 文件名称：filename.h 
* 文件标识：见配置管理计划书 
* 摘 要：简要描述本文件的内容 
* 
* 当前版本：1.1 
* 作 者：输入作者（或修改者）名字 
* 完成日期：2001年7月20日 
* 
* 取代版本：1.0 
* 原作者 ：输入原作者（或修改者）名字 
* 完成日期：2001年5月10日 
*/</span> </code></pre>
<h4 id="2-头文件结构"><a href="#2-头文件结构" class="headerlink" title=".2. 头文件结构"></a>.2. 头文件结构</h4><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">ifndef</span> GRAPHICS_H  </span><span class="token comment" spellcheck="true">// 防止 graphics.h 被重复引用 </span>
<span class="token macro property">#<span class="token directive keyword">define</span> GRAPHICS_H </span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span> </span><span class="token comment" spellcheck="true">// 引用标准库的头文件 </span>

<span class="token macro property">#<span class="token directive keyword">include</span> “myheader.h” </span><span class="token comment" spellcheck="true">// 引用非标准库的头文件 </span>

<span class="token keyword">void</span> <span class="token function">Function1</span><span class="token punctuation">(</span>…<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 全局函数声明 </span>

class Box <span class="token comment" spellcheck="true">// 类结构声明 </span>
<span class="token punctuation">{</span> 

<span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token macro property">#<span class="token directive keyword">endif</span></span></code></pre>
<h4 id="3-定义文件结构"><a href="#3-定义文件结构" class="headerlink" title=".3. 定义文件结构"></a>.3. 定义文件结构</h4><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> “graphics.h” </span><span class="token comment" spellcheck="true">// 引用头文件 </span>

<span class="token comment" spellcheck="true">// 全局函数的实现体 </span>
<span class="token keyword">void</span> <span class="token function">Function1</span><span class="token punctuation">(</span>…<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
<span class="token punctuation">}</span> 

<span class="token comment" spellcheck="true">// 类成员函数的实现体 </span>
<span class="token keyword">void</span> Box<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Draw</span><span class="token punctuation">(</span>…<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
<span class="token punctuation">}</span> </code></pre>
<h3 id="2-程序版式"><a href="#2-程序版式" class="headerlink" title="2. 程序版式"></a>2. 程序版式</h3><h4 id="1-空行"><a href="#1-空行" class="headerlink" title=".1. 空行"></a>.1. 空行</h4><ul>
<li>在一个函数体内，<code>逻揖上密切相关的语句之间不加空行</code>，其它地方应 加空行分隔。</li>
<li>在每个<code>类声明之后、每个函数定义结束之后</code>都要加空行。</li>
</ul>
<h4 id="2-代码行"><a href="#2-代码行" class="headerlink" title=".2. 代码行"></a>.2. 代码行</h4><ul>
<li>一行代码只做一件事情，如只定义一个变量，或只写一条语句。</li>
<li><code>尽可能在定义变量的同时初始化该变量</code>。</li>
<li>if、for、while、do 等语句自占一行，执行语句不得紧跟其后。</li>
</ul>
<p><img src="https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220407211517087.png" alt=""></p>
<h4 id="3-代码行内空格"><a href="#3-代码行内空格" class="headerlink" title=".3. 代码行内空格"></a>.3. 代码行内空格</h4><ul>
<li><code>关键字之后要留空格</code>。 const、virtual、inline、case 等关键字之 后至少要留一个空格，否则无法辨析关键字。像 if、for、while 等关键字之后应留 一个空格再跟左括号‘（’，以突出关键字。</li>
<li><code>函数名之后不要留空格</code>，紧跟左括号‘（’，以与关键字区别。</li>
<li>‘（’向后紧跟，‘）’、‘，’、‘;’向前紧跟，紧跟处不留空格。</li>
<li>‘，’之后要留空格，如 Function(x, y, z)。如果‘;’不是一行的结束 符号，其后要留空格，如 for (initialization; condition; update)。</li>
<li>赋值操作符、比较操作符、算术操作符、逻辑操作符、位域操作符， 如“=”、“+=” “&gt;=”、“&lt;=”、“+”、“*”、“%”、“&amp;&amp;”、“||”、“&lt;&lt;”,“^”等二 元操作符的前后应当加空格。 z 【规则 2-3-6</li>
<li>一元操作符如“!”、“~”、“++”、“–”、“&amp;”（地址运算符）等前后不加空格。</li>
<li>象“［］”、“.”、“-&gt;”这类操作符前后不加空格</li>
<li>对于表达式比较长的 for 语句和 if 语句，为了紧凑起见可以适当地去 掉一些空格，如 for (i=0; i&lt;10; i++)和 if ((a&lt;=b) &amp;&amp; (c&lt;=d))</li>
</ul>
<p><img src="https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220407211830306.png" alt=""></p>
<h3 id="3-命令规则"><a href="#3-命令规则" class="headerlink" title="3. 命令规则"></a>3. 命令规则</h3><ul>
<li>根据具体团队要求来</li>
</ul>
<h3 id="4-表达式-amp-基本语句"><a href="#4-表达式-amp-基本语句" class="headerlink" title="4. 表达式&amp;基本语句"></a>4. 表达式&amp;基本语句</h3><h4 id="1-表达式优先级"><a href="#1-表达式优先级" class="headerlink" title=".1. 表达式优先级"></a>.1. 表达式优先级</h4><p><img src="https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220407212747965.png" alt=""></p>
<h4 id="2-if语句"><a href="#2-if语句" class="headerlink" title=".2. if语句"></a>.2. if语句</h4><ul>
<li>布尔变量与零值比较</li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span></code></pre>
<ul>
<li>整数类型与零值比较； 浮点值不能与0比较</li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">>=</span><span class="token operator">-</span>EPSINON<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>x<span class="token operator">&lt;</span>EPSINON<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<ul>
<li>指针与NULL比较，而不是与0比较</li>
</ul>
<h4 id="3-循环语句效率"><a href="#3-循环语句效率" class="headerlink" title=".3. 循环语句效率"></a>.3. 循环语句效率</h4><ul>
<li>在多重循环中，如果有可能，应当将最长的循环放在最内层，最短的 循环放在最外层，以减少 CPU 跨切循环层的次数。</li>
</ul>
<p><img src="https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220407213922493.png" alt=""></p>
<p><img src="https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220407213939003.png" alt=""></p>
<h3 id="5-常量"><a href="#5-常量" class="headerlink" title="5. 常量"></a>5. 常量</h3><h4 id="1-const-amp-define-区别"><a href="#1-const-amp-define-区别" class="headerlink" title=".1. const &amp; #define 区别"></a>.1. const &amp; #define 区别</h4><ul>
<li>const 常量有数据类型，而宏常量没有数据类型。编译器可以对前者进行类型安 全检查。而对后者只进行字符替换，没有类型安全检查，并且在字符替换可能会 产生意料不到的错误（边际效应）。  </li>
<li>有些集成化的调试工具可以对 const 常量进行调试，但是不能对宏常量进行调试。 </li>
</ul>
<blockquote>
<p><code>需要对外公开的常量放在头文件中</code>，<code>不需要对外公开的常量放在定义 文件的头部</code>。为便于管理，可以把不同模块的常量集中存放在一个公共的头文件中。</p>
</blockquote>
<h4 id="2-类中常量"><a href="#2-类中常量" class="headerlink" title=".2. 类中常量"></a>.2. 类中常量</h4><ul>
<li>不能在类声明中初始化 const 数据成员。以下用法是错误的，因为<code>类的对象未被创 建时，编译器不知道 SIZE 的值是什么</code>。</li>
<li><code>const 数据成员的初始化只能在类构造函数的初始化表中进行</code></li>
<li><code>枚举常量不会占用对象的存储空间，它们在编译时被全部求值。</code>枚举常量的缺点是： 它的隐含数据类型是整数，其最大值有限，且不能表示浮点数（如 PI=3.14159）。 </li>
</ul>
<pre class=" language-c"><code class="language-c">class A 
<span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> SIZE <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 错误，企图在类声明中初始化 const 数据成员 </span>
    <span class="token keyword">int</span> array<span class="token punctuation">[</span>SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 错误，未知的 SIZE </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> </code></pre>
<h3 id="6-函数设计"><a href="#6-函数设计" class="headerlink" title="6. 函数设计"></a>6. 函数设计</h3><h4 id="1-参数命名规则"><a href="#1-参数命名规则" class="headerlink" title=".1. 参数命名规则"></a>.1. 参数命名规则</h4><pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token keyword">int</span> width<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 良好的风格 </span>
<span class="token keyword">void</span> <span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 不良的风格 </span>
<span class="token keyword">float</span> <span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 良好的风格    注意</span>
<span class="token keyword">float</span> <span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 不良的风格</span></code></pre>
<ul>
<li>参数命名要恰当，顺序要合理。一般地，应将目的参数放在前面，源参数放在后面。</li>
<li>如果<code>参数是指针，且仅作输入用，则应在类型前加 const</code>，以防止该 指针在函数体内被意外修改。</li>
<li>如果输入<code>参数以值传递的方式传递对象，则宜改用“const &amp;”方式 来传递，这样可以省去临时对象的构造和析构过程</code>，从而提高效率。</li>
<li>尽量不要使用类型和数目不确定的参数。</li>
</ul>
<h4 id="2-函数内部实现"><a href="#2-函数内部实现" class="headerlink" title=".2. 函数内部实现"></a>.2. 函数内部实现</h4><ul>
<li>在函数体的“入口处”，对参数的有效性进行检查。</li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token operator">*</span><span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>pvTo<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>pvFrom<span class="token punctuation">,</span> size_t size<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pvTo <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pvFrom <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 使用断言 </span>
    byte <span class="token operator">*</span>pbTo <span class="token operator">=</span> <span class="token punctuation">(</span>byte <span class="token operator">*</span><span class="token punctuation">)</span> pvTo<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 防止改变 pvTo 的地址 </span>
    byte <span class="token operator">*</span>pbFrom <span class="token operator">=</span> <span class="token punctuation">(</span>byte <span class="token operator">*</span><span class="token punctuation">)</span> pvFrom<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 防止改变 pvFrom 的地址 </span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>size <span class="token operator">--</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span> 
        <span class="token operator">*</span>pbTo <span class="token operator">++</span> <span class="token operator">=</span> <span class="token operator">*</span>pbFrom <span class="token operator">++</span> <span class="token punctuation">;</span> 
    <span class="token keyword">return</span> pvTo<span class="token punctuation">;</span> 
<span class="token punctuation">}</span></code></pre>
<ul>
<li>在函数体的“出口处”，对 return 语句的正确性和效率进行检查。</li>
<li>return 语句不可返回指向“栈内存”的“指针”或者“引用”，因为该内存在函数 体结束时被自动销毁。</li>
<li>要搞清楚返回的究竟是“值”、“指针”还是“引用”。</li>
<li>函数体的规模要小，尽量控制在 50 行代码之内。</li>
<li>不仅要检查输入参数的有效性，还要检查通过其它途径进入函数体内 的变量的有效性，例如全局变量、文件句柄等。</li>
</ul>
<h3 id="7-内存管理"><a href="#7-内存管理" class="headerlink" title="7. 内存管理"></a>7. 内存管理</h3><h4 id="1-内存分配方式"><a href="#1-内存分配方式" class="headerlink" title=".1. 内存分配方式"></a>.1. 内存分配方式</h4><ul>
<li>从<code>静态存储区域</code>分配。内存在程序编译的时候就已经分配好，这块内存在程序的 整个运行期间都存在。例如<code>全局变量，static 变量</code>。</li>
<li>在<code>栈</code>上创建。在执行函数时，函数内<code>局部变量</code>的存储单元都可以在栈上创建，函 数执行结束时这些存储单元自动被释放。栈内存分配运算内置于处理器的指令集 中，效率很高，但是分配的内存容量有限。</li>
<li>从<code>堆</code>上分配，亦称动态内存分配。程序在运行的时候用 <code>malloc 或 new 申请任意 多少的内存</code>，程序员自己负责在何时用 <code>free 或 delete 释放内存</code>。动态内存的生存 期由我们决定，使用非常灵活，但问题也最多。</li>
</ul>
<h4 id="2-常见内存错误"><a href="#2-常见内存错误" class="headerlink" title=".2. 常见内存错误"></a>.2. 常见内存错误</h4><ul>
<li><strong>内存分配未成功，却使用了它：</strong> 在<code>使用内存之前检查指针是否为 NULL</code>。如果指针 p 是函数的参数，那么在函数的入口 处用 assert(p!=NULL)进行检查。如果是用 malloc 或 new 来申请内存，应该用 if(p==NULL)  或 if(p!=NULL)进行防错处理。 </li>
<li><strong>内存分配虽然成功，但是尚未初始化就引用它：</strong> 没有初始化概念，误以为内存的缺省初值全为零，导致初值错误</li>
<li><strong>内存分配成功，但操作内存越界</strong></li>
<li><strong>忘记释放内存，造成内存泄漏</strong>：<code>用 free 或 delete 释放了内存之后，立即将指针设置为 NULL，防止 产生“野指针”。</code></li>
</ul>
<h4 id="3-指针与数组"><a href="#3-指针与数组" class="headerlink" title=".3. 指针与数组"></a>.3. 指针与数组</h4><ul>
<li>数组要么在<code>静态存储区被创建（如全局数组）</code>，<code>要么在栈上被创建</code>。数组名对应着 （而不是指向）一块内存，其地址与容量在生命期内保持不变，只有数组的内容可以改 变。</li>
<li>常量字符串的内容是不可以被修改的。</li>
</ul>
<blockquote>
<p>指针指向常量字符串 (位于常量存储区), 常量字符串的内容是不可以被修改的，企图修改常量字符串的内容而导致运行错误。所以这个问题出现的原因是 char*str=”abcdefg”, 赋值的是字符串常量，存储在常量存储区，而<code>常量存储区的内容是无法修改的</code>。</p>
<p>如果使用数组来代替的话，数据就存储在堆栈空间，堆栈空间的内容是可以修改的，就不会出现运行时错误。</p>
</blockquote>
<pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> “hello”<span class="token punctuation">;</span> 
a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> ‘X’<span class="token punctuation">;</span> 
cout <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> 
<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> “world”<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 注意 p 指向常量字符串 </span>
p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> ‘X’<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 编译器不能发现该错误 </span>
cout <span class="token operator">&lt;&lt;</span> p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span></code></pre>
<ul>
<li>数组复制与比较</li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// 数组… </span>
<span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span> 
<span class="token keyword">char</span> b<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token function">strcpy</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 不能用 b = a; </span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 不能用 if (b == a) </span>

    <span class="token comment" spellcheck="true">// 指针… </span>
<span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">strcpy</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 不要用 p = a; </span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 不要用 if (p == a)</span></code></pre>
<ul>
<li>C++/C 语言<code>没有办法知道指针所指的内存容量，除非在申请内存时记住它。</code></li>
<li><code>当数组作为函数的参数进行传递时，该数组自动退化为同类型的指针。</code></li>
</ul>
<h4 id="4-指针参数如何传递内存的"><a href="#4-指针参数如何传递内存的" class="headerlink" title=".4. 指针参数如何传递内存的"></a>.4. 指针参数如何传递内存的</h4><ul>
<li>如果函数的参数是一个指针，不要指望用该指针去申请动态内存。</li>
</ul>
<blockquote>
<p><code>编译器总是要为函数的每个参数制作临时副本</code>，指针 参数 p 的副本是 _p，编译器使 _p = p。如<code>果函数体内的程序修改了_p 的内容，就导致 参数 p 的内容作相应的修改</code>。这就是指针可以用作输出参数的原因。</p>
<p>在本例中，<code>_p 申请 了新的内存，只是把_p 所指的内存地址改变了，但是 p 丝毫未变</code>。所以函数 GetMemory 并不能输出任何东西。事实上，<code>每执行一次 GetMemory 就会泄露一块内存，因为没有用 free 释放内存。</code></p>
</blockquote>
<pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">GetMemory</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//只是把_p 所指的内存地址改变了，但是 p 丝毫未变</span>
<span class="token punctuation">}</span> 
<span class="token keyword">void</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> 
    <span class="token function">GetMemory</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// str 仍然为 NULL </span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 运行错误 </span>
<span class="token punctuation">}</span> </code></pre>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//替代方案一</span>
<span class="token keyword">void</span> <span class="token function">GetMemory2</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Test2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> 
    <span class="token function">GetMemory2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>str<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 注意参数是 &amp;str，而不是 str </span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    cout<span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> 
    <span class="token function">free</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span></code></pre>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//替代方案二</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">GetMemory3</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">return</span> p<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">Test3</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> 
    str <span class="token operator">=</span> <span class="token function">GetMemory3</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">strcpy</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    cout<span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> 
    <span class="token function">free</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span> </code></pre>
<ul>
<li><code>不要用 return 语句返回指向“栈内存”的指针，因为该内存在函数结束时 自动消亡</code></li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">char</span> p<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello world"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//p存储在堆区  char *p = "hello world";//常量，存储在静态区</span>
    <span class="token keyword">return</span> p<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 编译器将提出警告 </span>
<span class="token punctuation">}</span> 
<span class="token keyword">void</span> <span class="token function">Test4</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> 
    str <span class="token operator">=</span> <span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// str 的内容是垃圾 </span>
    cout<span class="token operator">&lt;&lt;</span> str <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> 
<span class="token punctuation">}</span></code></pre>
<h4 id="5-free-和-delete-把指针怎么啦"><a href="#5-free-和-delete-把指针怎么啦" class="headerlink" title=".5. free 和 delete 把指针怎么啦"></a>.5. free 和 delete 把指针怎么啦</h4><ul>
<li><code>只是把指针所指的内存给 释放掉，但并没有把指针本身干掉。</code></li>
<li>指针消亡了，并不表示它所指的内存会被自动释放。 （堆区）</li>
<li>内存被释放了，并不表示指针会消亡或者成了 NULL 指针。</li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">strcpy</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> “hello”<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// p 所指的内存被释放，但是 p 所指的地址仍然不变 </span>

<span class="token keyword">if</span><span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 没有起到防错作用   p此刻是野指针</span>
<span class="token punctuation">{</span> 
    <span class="token function">strcpy</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> “world”<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 出错 </span>
<span class="token punctuation">}</span></code></pre>
<h4 id="6-杜绝野指针"><a href="#6-杜绝野指针" class="headerlink" title=".6. 杜绝野指针"></a>.6. 杜绝野指针</h4><ul>
<li>“野指针”不是 NULL 指针，是指向“垃圾”内存的指针。</li>
<li><code>指针变量没有被初始化</code>。任何指针变量刚被创建时不会自动成为 NULL 指针，它 的缺省值是随机的，<code>指针变量在创建的同时应当被初始化，要么 将指针设置为 NULL，要么让它指向合法的内存</code>。</li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>p<span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<ul>
<li>指针 p 被 free 或者 delete 之后，没有置为 NULL，让人误以为 p 是个合法的指针。</li>
<li>指针操作超越了变量的作用范围。</li>
</ul>
<h4 id="7-malloc-amp-free-amp-new-amp-delete"><a href="#7-malloc-amp-free-amp-new-amp-delete" class="headerlink" title=".7. malloc &amp; free &amp; new &amp; delete"></a>.7. malloc &amp; free &amp; new &amp; delete</h4><ul>
<li>由于 malloc/free 不能执行构造函数与析构函数，必须调用 成员函数 Initialize 和 Destroy 来完成初始化与清除工作。</li>
<li>不要企图用 malloc/free 来完成动态对象的内存管理，应该用 new/delete。</li>
<li>由于内部数据类型的“对象”没有构造与析构的过程，对它们而言 malloc/free 和 new/delete 是等价的</li>
</ul>
<pre class=" language-c"><code class="language-c">class Obj 
<span class="token punctuation">{</span> 
    public <span class="token punctuation">:</span> 
    <span class="token function">Obj</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> “Initialization” <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
    <span class="token operator">~</span><span class="token function">Obj</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> “Destroy” <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
    <span class="token keyword">void</span> <span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> “Initialization” <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
    <span class="token keyword">void</span> <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> “Destroy” <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">UseMallocFree</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    Obj <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token punctuation">(</span>obj <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 申请动态内存 </span>
    a<span class="token operator">-></span><span class="token function">Initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 初始化 </span>
    <span class="token comment" spellcheck="true">//… </span>
    a<span class="token operator">-></span><span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 清除工作 </span>
    <span class="token function">free</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 释放内存 </span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">UseNewDelete</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    Obj <span class="token operator">*</span>a <span class="token operator">=</span> new Obj<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 申请动态内存并且初始化 </span>
    <span class="token comment" spellcheck="true">//… </span>
    delete a<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 清除并且释放内存 </span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>注意类型转还 和 sizeof</li>
<li>malloc 返回值的类型是 void *，所以在调用 malloc 时要显式地进行类型转换，将 void * 转换成所需要的指针类型。</li>
<li>new 内置了 sizeof、类型转换和类型安全检查功能。对于非内部数据类型 的对象而言，new 在创建动态对象的同时完成了初始化工作。如果对象有多个构造函数， 那么 new 的语句也可以有多种形式。</li>
<li>如果用 new 创建对象数组，那么只能使用对象的无参数构造函数。</li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">int</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> new <span class="token keyword">int</span><span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span> 

Obj <span class="token operator">*</span>objects <span class="token operator">=</span> new Obj<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 创建 100 个动态对象</span>
delete <span class="token punctuation">[</span><span class="token punctuation">]</span>objects<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 正确的用法</span></code></pre>
<ul>
<li>语句 free(p)能正确地释放内存。<code>如果 p 是 NULL 指针</code>， 那么 free 对 p 无论操作多少次都不会出问题。<code>如果 p 不是 NULL 指针</code>，那么 free 对 p 连续操作两次就会导致程序运行错误。</li>
</ul>
<h3 id="8-C-高级特性"><a href="#8-C-高级特性" class="headerlink" title="8. C++ 高级特性"></a>8. C++ 高级特性</h3><h4 id="1-成员函数的重载、覆盖和隐藏"><a href="#1-成员函数的重载、覆盖和隐藏" class="headerlink" title=".1. 成员函数的重载、覆盖和隐藏"></a>.1. 成员函数的重载、覆盖和隐藏</h4><ul>
<li>重载： （1）相同的范围（在同一个类中）；  （2）函数名字相同；  （3）参数不同；  （4）virtual 关键字可有可无。</li>
<li>覆盖：（1）不同的范围（分别位于派生类与基类）；  （2）函数名字相同；  （3）参数相同；  （4）基类函数必须有 virtual 关键字。</li>
<li>隐藏：（1）如果<code>派生类的函数与基类的函数同名，但是参数不同。</code>此时，不论有无 virtual 关键字，基类的函数将被隐藏（注意别与重载混淆）。  （2）如果<code>派生类的函数与基类的函数同名，并且参数也相同，</code>但是基类函数没有 virtual 关键字。此时，基类的函数被隐藏（注意别与覆盖混淆）。 <code>behavior depends on type of the pointer</code></li>
</ul>
<blockquote>
<p>（1）函数 Derived::f(float)覆盖了 Base::f(float)。  </p>
<p>（2）函数 Derived::g(int)<code>隐藏</code>了 Base::g(float)，而不是重载。  </p>
<p>（3）函数 Derived::h(float)<code>隐藏</code>了 Base::h(float)，而不是覆盖。 </p>
</blockquote>
<pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream.h></span> </span>
class Base 
<span class="token punctuation">{</span> 
public<span class="token punctuation">:</span> 
    virtual <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base::f(float) "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
    <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base::g(float) "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
    <span class="token keyword">void</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base::h(float) "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
class Derived <span class="token punctuation">:</span> public Base 
<span class="token punctuation">{</span> 
public<span class="token punctuation">:</span> 
    virtual <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Derived::f(float) "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
    <span class="token keyword">void</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Derived::g(int) "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
    <span class="token keyword">void</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Derived::h(float) "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    Derived d<span class="token punctuation">;</span> 
    Base <span class="token operator">*</span>pb <span class="token operator">=</span> <span class="token operator">&amp;</span>d<span class="token punctuation">;</span> 
    Derived <span class="token operator">*</span>pd <span class="token operator">=</span> <span class="token operator">&amp;</span>d<span class="token punctuation">;</span> 
    <span class="token comment" spellcheck="true">// Good : behavior depends solely on type of the object </span>
    pb<span class="token operator">-></span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">3.14f</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Derived::f(float) 3.14 </span>
    pd<span class="token operator">-></span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">3.14f</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Derived::f(float) 3.14 </span>

    <span class="token comment" spellcheck="true">// Bad : behavior depends on type of the pointer </span>
    pb<span class="token operator">-></span><span class="token function">g</span><span class="token punctuation">(</span><span class="token number">3.14f</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Base::g(float) 3.14 </span>
    pd<span class="token operator">-></span><span class="token function">g</span><span class="token punctuation">(</span><span class="token number">3.14f</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Derived::g(int) 3 (surprise!) </span>

    <span class="token comment" spellcheck="true">// Bad : behavior depends on type of the pointer </span>
    pb<span class="token operator">-></span><span class="token function">h</span><span class="token punctuation">(</span><span class="token number">3.14f</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Base::h(float) 3.14 (surprise!) </span>
    pd<span class="token operator">-></span><span class="token function">h</span><span class="token punctuation">(</span><span class="token number">3.14f</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Derived::h(float) 3.14 </span>
<span class="token punctuation">}</span> </code></pre>
<pre class=" language-c"><code class="language-c">class Base 
<span class="token punctuation">{</span> 
    public<span class="token punctuation">:</span> 
    <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
class Derived <span class="token punctuation">:</span> public Base 
<span class="token punctuation">{</span> 
    public<span class="token punctuation">:</span> 
    <span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token keyword">void</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    Derived <span class="token operator">*</span>pd <span class="token operator">=</span> new Derived<span class="token punctuation">;</span> 
    pd<span class="token operator">-></span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// error   由于隐藏带来的错误</span>
<span class="token punctuation">}</span> </code></pre>
<h4 id="2-参数的缺省值"><a href="#2-参数的缺省值" class="headerlink" title=".2. 参数的缺省值"></a>.2. 参数的缺省值</h4><ul>
<li><code>参数缺省值只能出现在函数的声明中，而不能出现在定义体中。</code></li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 正确，缺省值出现在函数的声明中 </span>

<span class="token keyword">void</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// 错误，缺省值出现在函数的定义体中 </span>
<span class="token punctuation">{</span> 

<span class="token punctuation">}</span></code></pre>
<h4 id="3-内联函数"><a href="#3-内联函数" class="headerlink" title=".3. 内联函数"></a>.3. 内联函数</h4><ul>
<li><code>定义在类声明之中的成员函数将自动地成为内联函数</code></li>
<li>如果函数体内的代码比较长，使用内联将导致内存消耗代价较高。</li>
<li>如果函数体内出现循环，那么执行函数体内代码的时间要比函数调用的开销大。 </li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// inline 与函数定义体放在一起 </span>
<span class="token punctuation">{</span> 
<span class="token punctuation">}</span> </code></pre>
<h3 id="9-类的构造函数，析构函数，赋值函数"><a href="#9-类的构造函数，析构函数，赋值函数" class="headerlink" title="9. 类的构造函数，析构函数，赋值函数"></a>9. 类的构造函数，析构函数，赋值函数</h3><h4 id="1-构造函数初始化表"><a href="#1-构造函数初始化表" class="headerlink" title=".1. 构造函数初始化表"></a>.1. 构造函数初始化表</h4><ul>
<li>构造函数有个特殊的初始化方式叫“初始化表达式表”（简称初始化表）。<code>初始化表 位于函数参数表之后，却在函数体 {} 之前</code>。这说明<code>该表里的初始化工作发生在函数体 内的任何代码被执行之前</code>。</li>
</ul>
<pre class=" language-c"><code class="language-c">class A 
<span class="token punctuation">{</span>
    <span class="token function">A</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// A 的构造函数 </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
class B <span class="token punctuation">:</span> public A 
<span class="token punctuation">{</span>
    <span class="token function">B</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// B 的构造函数 </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
B<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">B</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> 
    <span class="token punctuation">:</span> <span class="token function">A</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 在初始化表里调用 A 的构造函数 </span>
    <span class="token punctuation">{</span> 

    <span class="token punctuation">}</span> </code></pre>
<ul>
<li><code>类的 const 常量只能在初始化表里被初始化，因为它不能在函数体内用赋值的方式 来初始化</code></li>
<li>类的数据成员的初始化可以采用初始化表或函数体内赋值两种方式</li>
</ul>
<p><img src="https://gitee.com/github-25970295/blogimgv2022/raw/master/image-20220407234950032.png" alt=""></p>
<h4 id="2-拷贝构造函数-amp-赋值函数"><a href="#2-拷贝构造函数-amp-赋值函数" class="headerlink" title=".2. 拷贝构造函数&amp;赋值函数"></a>.2. 拷贝构造函数&amp;赋值函数</h4><ul>
<li>如果<code>不主动编写拷贝构造函数和赋值函数，编译器将以“位拷贝” 的方式自动生成缺省的函数</code>。<code>倘若类中含有指针变量，那么这两个缺省的函数就隐 含了错误</code>。</li>
</ul>
<blockquote>
<p>以类 String 的两个对象 a,b 为例，假设 a.m_data 的内容为“hello”， b.m_data 的内容为“world”。  现将 a 赋给 b，缺省赋值函数的“位拷贝”意味着执行 b.m_data = a.m_data。 这将造成三个错误：</p>
<p>一是 <code>b.m_data 原有的内存没被释放，造成内存泄露；</code></p>
<p>二是<code>b.m_data 和 a.m_data 指向同一块内存，a 或 b 任何一方变动都会影响另一方；</code></p>
<p>三 是<code>在对象被析构时，m_data 被释放了两次。</code></p>
</blockquote>
<ul>
<li>拷贝构造函数和赋值函数非常容易混淆，常导致错写、错用。<code>拷贝构造函数是在对 象被创建时调用的</code>，而<code>赋值函数只能被已经存在了的对象调用</code>。</li>
</ul>
<pre class=" language-c"><code class="language-c">String <span class="token function">a</span><span class="token punctuation">(</span>“hello”<span class="token punctuation">)</span><span class="token punctuation">;</span> 
String <span class="token function">b</span><span class="token punctuation">(</span>“world”<span class="token punctuation">)</span><span class="token punctuation">;</span> 
String c <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 调用了拷贝构造函数，最好写成 c(a); </span>
c <span class="token operator">=</span> b<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 调用了赋值函数</span></code></pre>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// 拷贝构造函数 </span>
String<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token comment" spellcheck="true">// 允许操作 other 的私有成员 m_data </span>
    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>m_data<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    m_data <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token function">strcpy</span><span class="token punctuation">(</span>m_data<span class="token punctuation">,</span> other<span class="token punctuation">.</span>m_data<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 

<span class="token comment" spellcheck="true">// 赋值函数 </span>
String <span class="token operator">&amp;</span> String<span class="token punctuation">:</span><span class="token punctuation">:</span>operate <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> String <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 需要重写</span>
<span class="token punctuation">{</span> 
    <span class="token comment" spellcheck="true">// (1) 检查自赋值 </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>this <span class="token operator">==</span> <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> 
        <span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span> 

    <span class="token comment" spellcheck="true">// (2) 释放原有的内存资源 </span>
    delete <span class="token punctuation">[</span><span class="token punctuation">]</span> m_data<span class="token punctuation">;</span> 

    <span class="token comment" spellcheck="true">// （3）分配新的内存资源，并复制内容 </span>
    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>m_data<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    m_data <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token function">strcpy</span><span class="token punctuation">(</span>m_data<span class="token punctuation">,</span> other<span class="token punctuation">.</span>m_data<span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token comment" spellcheck="true">// （4）返回本对象的引用 </span>
    <span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span> 
<span class="token punctuation">}</span></code></pre>
<ul>
<li><code>不想编写拷贝构造函数和赋值函数，又不允许别人使用编译器生成的 缺省函数，只需将拷贝构造函数和赋值函数声明为私有函数，不用编写代码。</code></li>
</ul>
<pre class=" language-c"><code class="language-c">class A 
<span class="token punctuation">{</span> … 
    private<span class="token punctuation">:</span> 
 <span class="token function">A</span><span class="token punctuation">(</span><span class="token keyword">const</span> A <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 私有的拷贝构造函数 </span>
 A <span class="token operator">&amp;</span> operate <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> A <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 私有的赋值函数 </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
如果有人试图编写如下程序：
    A <span class="token function">b</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 调用了私有的拷贝构造函数 </span>
b <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 调用了私有的赋值函数</span></code></pre>
<h4 id="3-如何在派生类中实现类的基本函数"><a href="#3-如何在派生类中实现类的基本函数" class="headerlink" title=".3. 如何在派生类中实现类的基本函数"></a>.3. 如何在派生类中实现类的基本函数</h4><ul>
<li><code>派生类的构造函数应在其初始化表里调用基类的构造函数。</code></li>
<li><code>基类与派生类的析构函数应该为虚（即加 virtual 关键字）。</code></li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream.h></span> </span>
class Base 
<span class="token punctuation">{</span> 
    public<span class="token punctuation">:</span> 
    virtual <span class="token operator">~</span><span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout<span class="token operator">&lt;&lt;</span> <span class="token string">"~Base"</span> <span class="token operator">&lt;&lt;</span> endl <span class="token punctuation">;</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 

class Derived <span class="token punctuation">:</span> public Base 
<span class="token punctuation">{</span> 
    public<span class="token punctuation">:</span> 
    virtual <span class="token operator">~</span><span class="token function">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> cout<span class="token operator">&lt;&lt;</span> <span class="token string">"~Derived"</span> <span class="token operator">&lt;&lt;</span> endl <span class="token punctuation">;</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    Base <span class="token operator">*</span> pB <span class="token operator">=</span> new Derived<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// upcast </span>
    delete pB<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 
输出结果为：
    <span class="token operator">~</span>Derived 
    <span class="token operator">~</span>Base 
    如果析构函数不为虚，那么输出结果为
    <span class="token operator">~</span>Base</code></pre>
<ul>
<li><code>在编写派生类的赋值函数时，注意不要忘记对基类的数据成员重新赋值。</code></li>
</ul>
<pre class=" language-c"><code class="language-c">class Base 
<span class="token punctuation">{</span> 
    public<span class="token punctuation">:</span> 
    … 
        Base <span class="token operator">&amp;</span> operate <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Base <span class="token operator">&amp;</span>other<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 类 Base 的赋值函数 </span>
    private<span class="token punctuation">:</span> 
    <span class="token keyword">int</span> m_i<span class="token punctuation">,</span> m_j<span class="token punctuation">,</span> m_k<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 

class Derived <span class="token punctuation">:</span> public Base 
<span class="token punctuation">{</span> 
    public<span class="token punctuation">:</span> 
    … 
        Derived <span class="token operator">&amp;</span> operate <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Derived <span class="token operator">&amp;</span>other<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 类 Derived 的赋值函数 </span>
    private<span class="token punctuation">:</span> 
    <span class="token keyword">int</span> m_x<span class="token punctuation">,</span> m_y<span class="token punctuation">,</span> m_z<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 

Derived <span class="token operator">&amp;</span> Derived<span class="token punctuation">:</span><span class="token punctuation">:</span>operate <span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Derived <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token comment" spellcheck="true">//（1）检查自赋值 </span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>this <span class="token operator">==</span> <span class="token operator">&amp;</span>other<span class="token punctuation">)</span> 
        <span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span> 

    <span class="token comment" spellcheck="true">//（2）对基类的数据成员重新赋值 </span>
    Base<span class="token punctuation">:</span><span class="token punctuation">:</span>operate <span class="token operator">=</span><span class="token punctuation">(</span>other<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 因为不能直接操作私有数据成员 </span>

    <span class="token comment" spellcheck="true">//（3）对派生类的数据成员赋值 </span>
    m_x <span class="token operator">=</span> other<span class="token punctuation">.</span>m_x<span class="token punctuation">;</span> 
    m_y <span class="token operator">=</span> other<span class="token punctuation">.</span>m_y<span class="token punctuation">;</span> 
    m_z <span class="token operator">=</span> other<span class="token punctuation">.</span>m_z<span class="token punctuation">;</span> 

    <span class="token comment" spellcheck="true">//（4）返回本对象的引用 </span>
    <span class="token keyword">return</span> <span class="token operator">*</span>this<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> </code></pre>
<h3 id="10-const用法"><a href="#10-const用法" class="headerlink" title="10. const用法"></a>10. const用法</h3><h4 id="1-修饰函数参数"><a href="#1-修饰函数参数" class="headerlink" title=".1. 修饰函数参数"></a>.1. 修饰函数参数</h4><ul>
<li>如果输入参数采用<code>“指针传递”</code>，那么加 const 修饰可以<code>防止意外地改动该指针， 起到保护作用</code>。 </li>
<li>如果输入参数采用<code>“值传递”</code>，由于函数将自动产生临时变量用于复制该参数，该 <code>输入参数本来就无需保护，所以不要加 const 修饰</code>。 </li>
<li>对于<code>非内部数据类型的参数而言</code>，象 void Func(A a) 这样声明的函数注定效率比 较底。因为函数体内<code>将产生 A 类型的临时对象用于复制参数 a，而临时对象的构造、 复制、析构过程都将消耗时间</code>。可以将函数声明改为 void Func(const A &amp;a)，因为“引用传递”仅借用 一下参数的别名而已，不需要产生临时对象。</li>
</ul>
<h4 id="2-修饰返回值"><a href="#2-修饰返回值" class="headerlink" title=".2. 修饰返回值"></a>.2. 修饰返回值</h4><ul>
<li>如果给以<code>“指针传递”</code>方式的函数返回值加 const 修饰，那么函数<code>返回值（即指针） 的内容不能被修改，该返回值只能被赋给加 const 修饰的同类型指针</code>。 </li>
</ul>
<pre class=" language-c"><code class="language-c"><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> <span class="token function">GetString</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token function">GetString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<ul>
<li>如果函数返回值采用<code>“值传递方式”</code>，由于函数会<code>把返回值复制到外部临时的存储 单元中</code>，加 const 修饰没有任何价值。</li>
<li>函数返回值采用<code>“引用传递”</code>的场合并不多，这种方式一般只出现在<code>类的赋值函数</code> 中，目的是为了实现链式表达。 </li>
</ul>
<h4 id="3-修饰成员函数"><a href="#3-修饰成员函数" class="headerlink" title=".3. 修饰成员函数"></a>.3. 修饰成员函数</h4><ul>
<li>任何<code>不会修改数据成员的函数</code>都应该声明为 const 类型。如果在编写 const 成员函 数时，不慎修改了数据成员，或者调用了其它非 const 成员函数，编译器将指出错误</li>
</ul>
<pre class=" language-c++"><code class="language-c++">class Stack 
{ 
public: 
    void Push(int elem); 
    int Pop(void); 
    int GetCount(void) const; // const 成员函数 
private: 
    int m_num; 
    int m_data[100]; 
}; 

int Stack::GetCount(void) const 
{ 
    ++ m_num; // 编译错误，企图修改数据成员 m_num 
    Pop(); // 编译错误，企图调用非 const 函数 
    return m_num; 
} </code></pre>
<h4 id="4-意见"><a href="#4-意见" class="headerlink" title=".4. 意见"></a>.4. 意见</h4><ul>
<li>当心那些视觉上不易分辨的操作符发生书写错误。 我们经常会把“＝＝”误写成“＝”，象“||”、“&amp;&amp;”、“&lt;=”、“&gt;=”这类符号也很 容易发生“丢 1”失误。然而编译器却不一定能自动指出这类错误。</li>
<li><code>变量（指针、数组）被创建之后应当及时把它们初始化</code>，以防止把 未被初始化的变量当成右值使用。</li>
<li>当心变量的<code>初值、缺省值错误，或者精度不够</code>。</li>
<li>当心<code>数据类型转换发生错误</code>。尽量使用显式的数据类型转换（让人 们知道发生了什么事），避免让编译器轻悄悄地进行隐式的数据类型转换。</li>
<li><code>当心变量发生上溢或下溢，数组的下标越界。</code></li>
<li><code>当心忘记编写错误处理程序，当心错误处理程序本身有误</code>。</li>
<li><code>当心文件 I/O 有错误</code>。</li>
<li>避免编写技巧性很高代码。</li>
<li>不要设计面面俱到、非常灵活的数据结构。</li>
<li>尽量使用<code>标准库函数，不要“发明”已经存在的库函数</code>。</li>
<li>尽量不要使用与具体硬件或软件环境关系密切的变量</li>
<li>把编译器的选择项设置为最严格状态。</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://liudongdong1.github.io" rel="external nofollow noreferrer">liudongdong1</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://liudongdong1.github.io/2022/04/01/bian-cheng-yu-yan/c-yu-yan/c-bian-cheng-gui-fan/">https://liudongdong1.github.io/2022/04/01/bian-cheng-yu-yan/c-yu-yan/c-bian-cheng-gui-fan/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint polocy. If reproduced, please indicate source
                    <a href="https://liudongdong1.github.io" target="_blank">liudongdong1</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/C/">
                                    <span class="chip bg-color">C</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo,douban" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2022/04/01/ainetworkprediction/">
                    <div class="card-image">
                        
                        <img src="https://gitee.com/github-25970295/blogImage/raw/master/img/79.jpeg" class="responsive-img" alt="读书计划">
                        
                        <span class="card-title">读书计划</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            0. Java知识整理
 Jvm 调优阅读笔记回顾
 effective java 阅读笔记回顾

1.  C学习路线
 C Primer Plus
 C 和指针
 C 专家编程
 C 陷阱与缺陷
 C语言深度解剖
 高质量C++&amp;
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-04-01
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AF%BB%E4%B9%A6/" class="post-category">
                                    读书
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%AF%BB%E4%B9%A6/">
                        <span class="chip bg-color">读书</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/03/30/bian-cheng-yu-yan/mian-jing/mian-jing-shu-ju-ku/">
                    <div class="card-image">
                        
                        <img src="https://cdn.pixabay.com/photo/2022/01/25/12/53/tree-6966126__480.jpg" class="responsive-img" alt="面经_数据库">
                        
                        <span class="card-title">面经_数据库</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            

内存中，虽然 说存取速度快，但是会导致数据不能永久的保存
文件中，可以解决数据永久保存的问题, 速度比内存操作慢，频繁的 IO 操作，而且查询数据不方便
数据库中,  数据可以永久保存，通过使用 SQL 语句，使得查询方便效率高，并且管
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-03-30
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Database/" class="post-category">
                                    Database
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Mysql/">
                        <span class="chip bg-color">Mysql</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <!-- <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="463294659"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="https://liudongdong1.github.io" target="_blank">liudongdong</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">1413.5k</span>&nbsp;字
            
            
            
            
            
            
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/liudongdong1/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:3463264078@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>














    <a href="https://blog.csdn.net/liudongdong19/" class="tooltipped" target="_blank" data-tooltip="关注我的CSDN: https://blog.csdn.net/liudongdong19/" data-position="top" data-delay="50">
        <i class="fab fa-csdn">C</i>
    </a>





</div>
    </div>
</footer>

<div class="progress-bar"></div>
 -->

    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script type="text/javascript" src="/js/CFS.Snow.min.js"></script>
    <!-- 点击爆灯效果 -->
    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
    <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
    <script type="text/javascript" src="/js/fireworks.js"></script>
    <!--动态线条背景-->
    <script type="text/javascript"
        color="122 103 238" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
    </script>
    <!-- 天气 -->
    <!-- weather -->
    <!-- weather -->
    <script type="text/javascript">
         WIDGET = {FID: 'knAMQaFanP'}
    </script>
    <script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"></script>
    <script type="text/javascript" src="https://apip.weatherdt.com/float/static/js/r.js?v=1111"></script>
    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    
    
    <script type="text/javascript" size="150" alpha='0.6'
        zIndex="-1" src="/libs/background/ribbon-refresh.min.js" async="async"></script>
    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    
    <!-- {% include '_custom/custom.swig' %} -->

</body>

</html>
